<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>User guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>User guide</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a>
<ul class="sectlevel2">
<li><a href="#_real_time_playbook_output_and_exploration">1.1. Real-time Playbook Output and Exploration</a></li>
<li><a href="#_push_button_automation">1.2. "Push Button" Automation</a></li>
<li><a href="#_enhanced_and_simplified_role_based_access_control_and_auditing">1.3. Enhanced and Simplified Role-Based Access Control and Auditing</a></li>
<li><a href="#_cloud_autoscaling_flexibility">1.4. Cloud &amp; Autoscaling Flexibility</a></li>
<li><a href="#_the_ideal_restful_api">1.5. The Ideal RESTful API</a></li>
<li><a href="#_backup_and_restore">1.6. Backup and Restore</a></li>
<li><a href="#_ansible_galaxy_integration">1.7. Ansible Galaxy Integration</a></li>
<li><a href="#_inventory_support_for_openstack">1.8. Inventory Support for OpenStack</a></li>
<li><a href="#_remote_command_execution">1.9. Remote Command Execution</a></li>
<li><a href="#_system_tracking">1.10. System Tracking</a></li>
<li><a href="#_integrated_notifications">1.11. Integrated Notifications</a></li>
<li><a href="#_satellite_integration">1.12. Satellite Integration</a></li>
<li><a href="#_run_time_job_customization">1.13. Run-time Job Customization</a></li>
<li><a href="#_red_hat_insights_integration">1.14. Red Hat Insights Integration</a></li>
<li><a href="#_enhanced_user_interface">1.15. Enhanced User Interface</a></li>
<li><a href="#_custom_virtual_environments">1.16. Custom Virtual Environments</a></li>
<li><a href="#_authentication_enhancements">1.17. Authentication Enhancements</a></li>
<li><a href="#_cluster_management">1.18. Cluster Management</a></li>
<li><a href="#_container_platform_support">1.19. Container Platform Support</a></li>
<li><a href="#_workflow_enhancements">1.20. Workflow Enhancements</a></li>
<li><a href="#_job_distribution">1.21. Job Distribution</a></li>
<li><a href="#_support_for_deployment_in_a_fips_enabled_environment">1.22. Support for deployment in a FIPS-enabled environment</a></li>
<li><a href="#_limit_the_number_of_hosts_per_organization">1.23. Limit the number of hosts per organization</a></li>
<li><a href="#_inventory_plugins">1.24. Inventory Plugins</a></li>
<li><a href="#_secret_management_system">1.25. Secret Management System</a></li>
<li><a href="#_automation_hub_integration">1.26. Automation Hub Integration</a></li>
</ul>
</li>
<li><a href="#_red_hat_ansible_automation_platform_controller_licensing_updates_and_support">2. Red Hat Ansible Automation Platform Controller Licensing, Updates, and Support</a>
<ul class="sectlevel2">
<li><a href="#_support">2.1. Support</a></li>
<li><a href="#trial-licenses">2.2. Trial / Evaluation</a></li>
<li><a href="#_subscription_types">2.3. Subscription Types</a></li>
<li><a href="#_node_counting_in_licenses">2.4. Node Counting in Licenses</a></li>
<li><a href="#attach_subscriptions">2.5. Attaching Subscriptions</a></li>
<li><a href="#_component_licenses">2.6. Component Licenses</a></li>
</ul>
</li>
<li><a href="#_logging_in">3. Logging In</a></li>
<li><a href="#_the_user_interface">4. The User Interface</a>
<ul class="sectlevel2">
<li><a href="#ug_activitystreams">4.1. Activity Streams</a></li>
<li><a href="#_views">4.2. Views</a>
<ul class="sectlevel3">
<li><a href="#_dashboard_view">4.2.1. Dashboard view</a></li>
<li><a href="#_jobs_view">4.2.2. Jobs view</a></li>
<li><a href="#_schedules_view">4.2.3. Schedules view</a></li>
</ul>
</li>
<li><a href="#_resources_and_access">4.3. Resources and Access</a></li>
<li><a href="#_administration_menu">4.4. Administration Menu</a></li>
<li><a href="#_the_settings_menu">4.5. The Settings Menu</a></li>
</ul>
</li>
<li><a href="#ug_search">5. Search</a></li>
<li><a href="#_searching_tips">6. Searching Tips</a>
<ul class="sectlevel2">
<li><a href="#_values_for_search_fields">6.1. Values for search fields</a></li>
<li><a href="#_searching_using_values_from_related_fields">6.2. Searching using values from Related Fields</a></li>
<li><a href="#_other_search_considerations">6.3. Other search considerations</a></li>
</ul>
</li>
<li><a href="#_sort">7. Sort</a></li>
<li><a href="#ug_organizations">8. Organizations</a>
<ul class="sectlevel2">
<li><a href="#ug_organizations_create">8.1. Creating a New Organization</a></li>
<li><a href="#_work_with_access">8.2. Work with Access</a>
<ul class="sectlevel3">
<li><a href="#_add_a_user_or_team">8.2.1. Add a User or Team</a></li>
</ul>
</li>
<li><a href="#_work_with_notifications">8.3. Work with Notifications</a></li>
</ul>
</li>
<li><a href="#_users">9. Users</a>
<ul class="sectlevel2">
<li><a href="#ug_users_create">9.1. Create a User</a></li>
<li><a href="#ug_users_delete">9.2. Delete a User</a></li>
<li><a href="#_users_organizations">9.3. Users - Organizations</a></li>
<li><a href="#_users_teams">9.4. Users - Teams</a></li>
<li><a href="#ug_users_permissions">9.5. Users - Permissions</a>
<ul class="sectlevel3">
<li><a href="#_add_permissions">9.5.1. Add Permissions</a></li>
</ul>
</li>
<li><a href="#ug_users_tokens">9.6. Users - Tokens</a></li>
</ul>
</li>
<li><a href="#ug_teams">10. Teams</a>
<ul class="sectlevel2">
<li><a href="#ug_team_create">10.1. Create a Team</a>
<ul class="sectlevel3">
<li><a href="#_team_access">10.1.1. Team Access</a></li>
<li><a href="#_team_roles">10.1.2. Team Roles</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ug_credentials">11. Credentials</a>
<ul class="sectlevel2">
<li><a href="#how_credentials_work">11.1. Understanding How Credentials Work</a></li>
<li><a href="#_getting_started_with_credentials">11.2. Getting Started with Credentials</a></li>
<li><a href="#ug_credentials_add">11.3. Add a New Credential</a></li>
<li><a href="#ug_credentials_cred_types">11.4. Credential Types</a>
<ul class="sectlevel3">
<li><a href="#ug_credentials_aws">11.4.1. Amazon Web Services</a></li>
<li><a href="#_ansible_galaxyautomation_hub_api_token">11.4.2. Ansible Galaxy/Automation Hub API Token</a></li>
<li><a href="#_centrify_vault_credential_provider_lookup">11.4.3. Centrify Vault Credential Provider Lookup</a></li>
<li><a href="#_container_registry">11.4.4. Container Registry</a></li>
<li><a href="#_cyberark_aim_credential_provider_lookup">11.4.5. CyberArk AIM Credential Provider Lookup</a></li>
<li><a href="#_cyberark_conjur_secret_lookup">11.4.6. CyberArk Conjur Secret Lookup</a></li>
<li><a href="#ug_credentials_github">11.4.7. GitHub Personal Access Token</a></li>
<li><a href="#ug_credentials_gitlab">11.4.8. GitLab Personal Access Token</a></li>
<li><a href="#_google_compute_engine">11.4.9. Google Compute Engine</a></li>
<li><a href="#_hashicorp_vault_secret_lookup">11.4.10. HashiCorp Vault Secret Lookup</a></li>
<li><a href="#_hashicorp_vault_signed_ssh">11.4.11. HashiCorp Vault Signed SSH</a></li>
<li><a href="#_insights">11.4.12. Insights</a></li>
<li><a href="#_machine">11.4.13. Machine</a></li>
<li><a href="#_microsoft_azure_key_vault">11.4.14. Microsoft Azure Key Vault</a></li>
<li><a href="#_microsoft_azure_resource_manager">11.4.15. Microsoft Azure Resource Manager</a></li>
<li><a href="#_network">11.4.16. Network</a></li>
<li><a href="#ug_credentials_ocp_k8s">11.4.17. OpenShift or Kubernetes API Bearer Token</a></li>
<li><a href="#_openstack">11.4.18. OpenStack</a></li>
<li><a href="#_red_hat_ansible_automation_platform">11.4.19. Red Hat Ansible Automation Platform</a></li>
<li><a href="#_red_hat_satellite_6">11.4.20. Red Hat Satellite 6</a></li>
<li><a href="#_red_hat_virtualization">11.4.21. Red Hat Virtualization</a></li>
<li><a href="#_source_control">11.4.22. Source Control</a></li>
<li><a href="#_thycotic_devops_secrets_vault">11.4.23. Thycotic DevOps Secrets Vault</a></li>
<li><a href="#_thycotic_secret_server">11.4.24. Thycotic Secret Server</a></li>
<li><a href="#_vault">11.4.25. Vault</a></li>
<li><a href="#_vmware_vcenter">11.4.26. VMware vCenter</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ug_credential_types">12. Custom Credential Types</a>
<ul class="sectlevel2">
<li><a href="#_content_sourcing_from_collections">12.1. Content sourcing from collections</a></li>
<li><a href="#_backwards_compatible_api_considerations">12.2. Backwards-Compatible API Considerations</a></li>
<li><a href="#_getting_started_with_credential_types">12.3. Getting Started with Credential Types</a></li>
<li><a href="#_create_a_new_credential_type">12.4. Create a New Credential Type</a></li>
</ul>
</li>
<li><a href="#ug_credential_plugins">13. Secret Management System</a>
<ul class="sectlevel2">
<li><a href="#_configure_and_link_secret_lookups">13.1. Configure and link secret lookups</a>
<ul class="sectlevel3">
<li><a href="#_metadata_for_credential_input_sources">13.1.1. Metadata for credential input sources</a></li>
<li><a href="#ug_credentials_centrify">13.1.2. Centrify Vault Credential Provider Lookup</a></li>
<li><a href="#ug_credentials_cyberarkaim">13.1.3. CyberArk AIM Credential Provider Lookup</a></li>
<li><a href="#ug_credentials_cyberarkconjur">13.1.4. CyberArk Conjur Secret Lookup</a></li>
<li><a href="#ug_credentials_hashivault">13.1.5. HashiCorp Vault Secret Lookup</a></li>
<li><a href="#ug_credentials_hashivaultssh">13.1.6. HashiCorp Vault Signed SSH</a></li>
<li><a href="#ug_credentials_azurekeyvault">13.1.7. Microsoft Azure Key Vault</a></li>
<li><a href="#ug_credentials_thycoticvault">13.1.8. Thycotic DevOps Secrets Vault</a></li>
<li><a href="#ug_credentials_thycoticserver">13.1.9. Thycotic Secret Server</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ug_applications_auth">14. Applications</a>
<ul class="sectlevel2">
<li><a href="#_getting_started_with_applications">14.1. Getting Started with Applications</a></li>
<li><a href="#ug_applications_auth_create">14.2. Create a new application</a>
<ul class="sectlevel3">
<li><a href="#_applications_tokens">14.2.1. Applications - Tokens</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_install_ansible_builder">15. Install ansible-builder</a></li>
<li><a href="#_run_the_builder">16. Run the builder</a></li>
<li><a href="#_execution_environment_setup_reference">17. Execution Environment Setup Reference</a>
<ul class="sectlevel2">
<li><a href="#_build_arguments_and_base_image">17.1. Build arguments and base image</a></li>
<li><a href="#_ansible_config_file_path">17.2. Ansible config file path</a></li>
<li><a href="#_ansible_galaxy_dependencies">17.3. Ansible Galaxy dependencies</a></li>
<li><a href="#_python_dependencies">17.4. Python dependencies</a></li>
<li><a href="#_system_level_dependencies">17.5. System-level dependencies</a></li>
<li><a href="#_additional_custom_build_steps">17.6. Additional custom build steps</a>
<ul class="sectlevel3">
<li><a href="#_ansible_builder_build_options">17.6.1. ansible-builder build options</a></li>
</ul>
</li>
<li><a href="#_examples">17.7. Examples</a>
<ul class="sectlevel3">
<li><a href="#ref_collections_metadata">17.7.1. Collection-level metadataÂ¶</a></li>
</ul>
</li>
<li><a href="#_python_dependencies_2">17.8. Python Dependencies</a></li>
<li><a href="#_system_level_dependencies_2">17.9. System-level Dependencies</a></li>
</ul>
</li>
<li><a href="#ug_projects">18. Projects</a>
<ul class="sectlevel2">
<li><a href="#_add_a_new_project">18.1. Add a new project</a>
<ul class="sectlevel3">
<li><a href="#ug_manual">18.1.1. Manage playbooks manually</a></li>
<li><a href="#ug_projects_scm_types">18.1.2. Manage playbooks using source control</a></li>
</ul>
</li>
<li><a href="#_updating_projects_from_source_control">18.2. Updating projects from source control</a></li>
<li><a href="#_work_with_permissions">18.3. Work with Permissions</a>
<ul class="sectlevel3">
<li><a href="#_add_permissions_2">18.3.1. Add Permissions</a></li>
</ul>
</li>
<li><a href="#_work_with_notifications_2">18.4. Work with Notifications</a></li>
<li><a href="#_work_with_job_templates">18.5. Work with Job Templates</a></li>
<li><a href="#_work_with_schedules">18.6. Work with Schedules</a>
<ul class="sectlevel3">
<li><a href="#_schedule_a_project">18.6.1. Schedule a Project</a></li>
</ul>
</li>
<li><a href="#ug_galaxy">18.7. Ansible Galaxy Support</a></li>
<li><a href="#ug_collections">18.8. Collections Support</a>
<ul class="sectlevel3">
<li><a href="#ug_collections_usage">18.8.1. Using Collections via Hub</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_inventories">19. Inventories</a>
<ul class="sectlevel2">
<li><a href="#ug_inventories_smart">19.1. Smart Inventories</a>
<ul class="sectlevel3">
<li><a href="#ug_host_filters">19.1.1. Smart Host Filter</a></li>
<li><a href="#ug_host_filter_facts">19.1.2. Define host filter with ansible_facts</a></li>
</ul>
</li>
<li><a href="#ug_inventories_plugins">19.2. Inventory Plugins</a></li>
<li><a href="#ug_inventories_add">19.3. Add a new inventory</a>
<ul class="sectlevel3">
<li><a href="#ug_inventories_add_permissions">19.3.1. Add permissions</a></li>
<li><a href="#ug_inventories_add_groups">19.3.2. Add groups</a></li>
<li><a href="#ug_inventories_add_host">19.3.3. Add hosts</a></li>
<li><a href="#ug_inventories_add_source">19.3.4. Add source</a></li>
<li><a href="#ug_inventories_view_completed_jobs">19.3.5. View completed jobs</a></li>
</ul>
</li>
<li><a href="#ug_inventories_run_ad_hoc">19.4. Running Ad Hoc Commands</a></li>
</ul>
</li>
<li><a href="#ir_inv_plugin_templates_reference">20. Supported Inventory Plugin Templates</a>
<ul class="sectlevel2">
<li><a href="#_amazon_web_services_ec2">20.1. Amazon Web Services EC2</a></li>
<li><a href="#_google_compute_engine_2">20.2. Google Compute Engine</a></li>
<li><a href="#_microsoft_azure_resource_manager_2">20.3. Microsoft Azure Resource Manager</a></li>
<li><a href="#_vmware_vcenter_2">20.4. VMware vCenter</a></li>
<li><a href="#ir_plugin_satellite">20.5. Red Hat Satellite 6</a></li>
<li><a href="#_openstack_2">20.6. OpenStack</a></li>
<li><a href="#_red_hat_virtualization_2">20.7. Red Hat Virtualization</a></li>
<li><a href="#_red_hat_ansible_automation_platform_2">20.8. Red Hat Ansible Automation Platform</a></li>
</ul>
</li>
<li><a href="#ug_JobTemplates">21. Job Templates</a>
<ul class="sectlevel2">
<li><a href="#_create_a_job_template">21.1. Create a Job Template</a></li>
<li><a href="#_add_permissions_3">21.2. Add Permissions</a></li>
<li><a href="#_work_with_notifications_3">21.3. Work with Notifications</a></li>
<li><a href="#_view_completed_jobs">21.4. View Completed Jobs</a></li>
<li><a href="#_scheduling">21.5. Scheduling</a>
<ul class="sectlevel3">
<li><a href="#_schedule_a_job_template">21.5.1. Schedule a Job Template</a></li>
</ul>
</li>
<li><a href="#ug_surveys">21.6. Surveys</a>
<ul class="sectlevel3">
<li><a href="#ug_surveys_create">21.6.1. Create a Survey</a></li>
<li><a href="#_optional_survey_questions">21.6.2. Optional Survey Questions</a></li>
</ul>
</li>
<li><a href="#_launch_a_job_template">21.7. Launch a Job Template</a></li>
<li><a href="#_copy_a_job_template">21.8. Copy a Job Template</a></li>
<li><a href="#ug_jobtemplates_scanjobs">21.9. Scan Job Templates</a>
<ul class="sectlevel3">
<li><a href="#_fact_scan_playbooks">21.9.1. Fact Scan Playbooks</a></li>
<li><a href="#_supported_oses_for_scan_facts_yml">21.9.2. Supported OSes for <code>scan_facts.yml</code></a></li>
<li><a href="#_pre_scan_setup">21.9.3. Pre-scan Setup</a></li>
<li><a href="#_custom_fact_scans">21.9.4. Custom Fact Scans</a></li>
</ul>
</li>
<li><a href="#ug_fact_caching">21.10. Fact Caching</a>
<ul class="sectlevel3">
<li><a href="#_benefits_of_fact_caching">21.10.1. Benefits of Fact Caching</a></li>
</ul>
</li>
<li><a href="#ug_CloudCredentials">21.11. Utilizing Cloud Credentials</a>
<ul class="sectlevel3">
<li><a href="#_openstack_3">21.11.1. OpenStack</a></li>
<li><a href="#_amazon_web_services">21.11.2. Amazon Web Services</a></li>
<li><a href="#_google">21.11.3. Google</a></li>
<li><a href="#_azure">21.11.4. Azure</a></li>
<li><a href="#_vmware">21.11.5. VMware</a></li>
</ul>
</li>
<li><a href="#ug_provisioning_callbacks">21.12. Provisioning Callbacks</a>
<ul class="sectlevel3">
<li><a href="#_passing_extra_variables_to_provisioning_callbacks">21.12.1. Passing Extra Variables to Provisioning Callbacks</a></li>
</ul>
</li>
<li><a href="#ug_jobtemplates_extravars">21.13. Extra Variables</a>
<ul class="sectlevel3">
<li><a href="#_relaunching_job_templates">21.13.1. Relaunching Job Templates</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ug_job_slice">22. Job Slicing</a>
<ul class="sectlevel2">
<li><a href="#_job_slice_considerations">22.1. Job slice considerations</a></li>
<li><a href="#ug_job_slice_execution">22.2. Job slice execution behavior</a></li>
<li><a href="#ug_job_slice_search">22.3. Search job slices</a></li>
</ul>
</li>
<li><a href="#ug_workflows">23. Workflows</a>
<ul class="sectlevel2">
<li><a href="#_workflow_scenarios_and_considerations">23.1. Workflow scenarios and considerations</a></li>
<li><a href="#_extra_variables">23.2. Extra Variables</a></li>
<li><a href="#_workflow_states">23.3. Workflow States</a></li>
<li><a href="#_role_based_access_controls">23.4. Role-Based Access Controls</a></li>
</ul>
</li>
<li><a href="#ug_wf_templates">24. Workflow Job Templates</a>
<ul class="sectlevel2">
<li><a href="#_create_a_workflow_template">24.1. Create a Workflow Template</a></li>
<li><a href="#_work_with_permissions_2">24.2. Work with Permissions</a></li>
<li><a href="#_work_with_notifications_4">24.3. Work with Notifications</a></li>
<li><a href="#_view_completed_jobs_2">24.4. View Completed Jobs</a></li>
<li><a href="#_work_with_schedules_2">24.5. Work with Schedules</a>
<ul class="sectlevel3">
<li><a href="#_schedule_a_workflow_template">24.5.1. Schedule a Workflow Template</a></li>
</ul>
</li>
<li><a href="#ug_wf_surveys">24.6. Surveys</a>
<ul class="sectlevel3">
<li><a href="#ug_wf_surveys_create">24.6.1. Create a Survey</a></li>
<li><a href="#_optional_survey_questions_2">24.6.2. Optional Survey Questions</a></li>
</ul>
</li>
<li><a href="#ug_wf_editor">24.7. Workflow Visualizer</a>
<ul class="sectlevel3">
<li><a href="#_build_a_workflow">24.7.1. Build a Workflow</a></li>
</ul>
</li>
<li><a href="#_launch_a_workflow_template">24.8. Launch a Workflow Template</a></li>
<li><a href="#_copy_a_workflow_template">24.9. Copy a Workflow Template</a></li>
<li><a href="#ug_wf_templates_extravars">24.10. Extra Variables</a></li>
</ul>
</li>
<li><a href="#ug_instance_groups">25. Instance Groups</a>
<ul class="sectlevel2">
<li><a href="#_create_an_instance_group">25.1. Create an instance group</a>
<ul class="sectlevel3">
<li><a href="#_associate_instances_to_an_instance_group">25.1.1. Associate instances to an instance group</a></li>
<li><a href="#_view_jobs_associated_with_an_instance_group">25.1.2. View jobs associated with an instance group</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ug_jobs">26. Jobs</a>
<ul class="sectlevel2">
<li><a href="#_inventory_sync_jobs">26.1. Inventory Sync Jobs</a>
<ul class="sectlevel3">
<li><a href="#_inventory_sync_details">26.1.1. Inventory sync details</a></li>
</ul>
</li>
<li><a href="#_scm_inventory_jobs">26.2. SCM Inventory Jobs</a>
<ul class="sectlevel3">
<li><a href="#_scm_inventory_details">26.2.1. SCM inventory details</a></li>
</ul>
</li>
<li><a href="#_playbook_run_jobs">26.3. Playbook Run Jobs</a>
<ul class="sectlevel3">
<li><a href="#_search">26.3.1. Search</a></li>
<li><a href="#_host_details">26.3.2. Host Details</a></li>
<li><a href="#_playbook_run_details">26.3.3. Playbook run details</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Instructions for using Ansible Automation Platform Controller.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thank you for your interest in Red Hat Ansible Automation Platform.
Ansible Automation Platform makes it possible for users across an
organization to share, vet, and manage automation content by means of a
simple, powerful, and agentless technical implementation. IT managers
can provide guidelines on how automation is applied to individual teams.
Meanwhile, automation developers retain the freedom to write tasks that
use existing knowledge, without the operational overhead of conforming
to complex tools and frameworks. It is a more secure and stable
foundation for deploying end-to-end automation solutions, from hybrid
cloud to the edge.</p>
</div>
<div class="paragraph">
<p>Ansible Automation Platform includes automation controller, which allows
users to define, operate, scale, and delegate automation across their
enterprise.</p>
</div>
<div class="sect2">
<h3 id="_real_time_playbook_output_and_exploration"><a class="anchor" href="#_real_time_playbook_output_and_exploration"></a>1.1. Real-time Playbook Output and Exploration</h3>
<div class="paragraph">
<p>Watch playbooks run in real time, seeing each host as they check in.
Easily go back and explore the results for specific tasks and hosts in
great detail. Search for specific plays or hosts and see just those
results, or quickly zero in on errors that need to be corrected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_push_button_automation"><a class="anchor" href="#_push_button_automation"></a>1.2. "Push Button" Automation</h3>
<div class="paragraph">
<p>Access your favorite projects and re-trigger execution from the web
interface with a minimum of clicking. automation controller will ask for
input variables, prompt for your credentials, kick off and monitor the
job, and display results and host history over time.</p>
</div>
</div>
<div class="sect2">
<h3 id="_enhanced_and_simplified_role_based_access_control_and_auditing"><a class="anchor" href="#_enhanced_and_simplified_role_based_access_control_and_auditing"></a>1.3. Enhanced and Simplified Role-Based Access Control and Auditing</h3>
<div class="paragraph">
<p>Automation controller allows for the granting of permissions to perform
a specific task (such as to view, create, or modify a file) to different
teams or explicit users through role-based access control (RBAC).</p>
</div>
<div class="paragraph">
<p>Keep some projects private, while allowing some users to edit inventory
and others to run playbooks against only certain systems&#8212;&#8203;either in
check (dry run) or live mode. You can also allow certain users to use
credentials without exposing the credentials to them. Regardless of what
you do, automation controller records the history of operations and who
made them&#8212;&#8203;including objects edited and jobs launched.</p>
</div>
<div class="paragraph">
<p>Based on user feedback, automation controller both expands and
simplifies its role-based access control. No longer is job template
visibility configured via a combination of permissions on inventory,
projects, and credentials. If you want to give any user or team
permissions to use a job template, just assign permissions directly on
the job template. Similarly, credentials are now full objects in
automation controller&#8217;s RBAC system, and can be assigned to multiple
users and/or teams for use.</p>
</div>
<div class="paragraph">
<p>Automation controller includes an âAuditorâ type, who can see all
aspects of the systems automation, but has no permission to run or
change automation, for those that need a system-level auditor. (This may
also be useful for a service account that scrapes automation information
from the REST API.) Refer to <code>rbac-ug</code> for more information.</p>
</div>
<div class="paragraph">
<p>Subsequent releases of automation controller provides more granular
permissions, making it easier to delegate inside your organizations and
remove automation bottlenecks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cloud_autoscaling_flexibility"><a class="anchor" href="#_cloud_autoscaling_flexibility"></a>1.4. Cloud &amp; Autoscaling Flexibility</h3>
<div class="paragraph">
<p>Automation controller features a powerful provisioning callback feature
that allows nodes to request configuration on demand. While optional,
this is an ideal solution for a cloud auto-scaling scenario, integrating
with provisioning servers like Cobbler, or when dealing with managed
systems with unpredictable uptimes. Requiring no management software to
be installed on remote nodes, the callback solution can be triggered via
a simple call to 'curl' or 'wget', and is easily embeddable in init
scripts, kickstarts, or preseeds. Access is controlled such that only
machines in inventory can request configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_ideal_restful_api"><a class="anchor" href="#_the_ideal_restful_api"></a>1.5. The Ideal RESTful API</h3>
<div class="paragraph">
<p>The automation controller REST API is the ideal RESTful API for a
systems management application, with all resources fully discoverable,
paginated, searchable, and well modeled. A styled API browser allows API
exploration from the API root at <code><a href="http://&lt;server" class="bare">http://&lt;server</a> name&gt;/api/</code>, showing
off every resource and relation. Everything that can be done in the user
interface can be done in the API - and more.</p>
</div>
</div>
<div class="sect2">
<h3 id="_backup_and_restore"><a class="anchor" href="#_backup_and_restore"></a>1.6. Backup and Restore</h3>
<div class="paragraph">
<p>The ability to backup and restore your system(s) has been integrated
into the Ansible Automation Platform setup playbook, making it easy for
you to backup and replicate your instance as needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ansible_galaxy_integration"><a class="anchor" href="#_ansible_galaxy_integration"></a>1.7. Ansible Galaxy Integration</h3>
<div class="paragraph">
<p>When it comes to describing your automation, everyone repeats the DRY
mantra--"Donât Repeat Yourself." Using centralized copies of Ansible
roles, such as in Ansible Galaxy, allows you to bring that philosophy to
your playbooks. By including an Ansible Galaxy requirements.yml file in
your project directory, automation controller automatically fetches the
roles your playbook needs from Galaxy, GitHub, or your local source
control. Refer to <a href="#ug_galaxy">Ansible Galaxy Support</a> for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_inventory_support_for_openstack"><a class="anchor" href="#_inventory_support_for_openstack"></a>1.8. Inventory Support for OpenStack</h3>
<div class="paragraph">
<p>Ansible is committed to making OpenStack simple for everyone to use. As
part of that, dynamic inventory support has been added for OpenStack.
This allows you to easily target any of the virtual machines or images
that youâre running in your OpenStack cloud.</p>
</div>
</div>
<div class="sect2">
<h3 id="_remote_command_execution"><a class="anchor" href="#_remote_command_execution"></a>1.9. Remote Command Execution</h3>
<div class="paragraph">
<p>Often times, you just need to do a simple task on a few hosts, whether
itâs add a single user, update a single security vulnerability, or
restart a misbehaving service. Automation controller includes remote
command execution&#8212;&#8203;any task that you can describe as a single Ansible
play can be run on a host or group of hosts in your inventory, allowing
you to get managing your systems quickly and easily. Plus, it is all
backed by an RBAC engine and detailed audit logging, removing any
questions regarding who has done what to what machines.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_tracking"><a class="anchor" href="#_system_tracking"></a>1.10. System Tracking</h3>
<div class="paragraph">
<p>You can collect facts by using the fact caching feature. Refer to
<a href="#ug_fact_caching">Fact Caching</a> for more detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="_integrated_notifications"><a class="anchor" href="#_integrated_notifications"></a>1.11. Integrated Notifications</h3>
<div class="paragraph">
<p>automation controller allows you to easily keep track of the status of
your automation. You can configure stackable notifications for job
templates, projects, or entire organizations, and configure different
notifications for job start, job success, job failure, and job approval
(for workflow nodes). The following notification sources are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Email</p>
</li>
<li>
<p>Grafana</p>
</li>
<li>
<p>IRC</p>
</li>
<li>
<p>Mattermost</p>
</li>
<li>
<p>PagerDuty</p>
</li>
<li>
<p>Rocket.Chat</p>
</li>
<li>
<p>Slack</p>
</li>
<li>
<p>Twilio</p>
</li>
<li>
<p>Webhook (post to an arbitrary webhook, for integration into other
tools)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, you can
<code>customize notification messages &lt;ug_custom_notifications&gt;</code> for each of
the above notification types.</p>
</div>
</div>
<div class="sect2">
<h3 id="_satellite_integration"><a class="anchor" href="#_satellite_integration"></a>1.12. Satellite Integration</h3>
<div class="paragraph">
<p>Dynamic inventory sources for Red Hat Satellite 6 are supported.</p>
</div>
</div>
<div class="sect2">
<h3 id="_run_time_job_customization"><a class="anchor" href="#_run_time_job_customization"></a>1.13. Run-time Job Customization</h3>
<div class="paragraph">
<p>Bringing the flexibility of the Ansible command line, you can now prompt
for any of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>inventory</p>
</li>
<li>
<p>credential</p>
</li>
<li>
<p>job tags</p>
</li>
<li>
<p>limits</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_red_hat_insights_integration"><a class="anchor" href="#_red_hat_insights_integration"></a>1.14. Red Hat Insights Integration</h3>
<div class="paragraph">
<p>Automation controller supports integration with Red Hat Insights, which
allows Insights playbooks to be used as a Ansible Automation Platform
Project.</p>
</div>
</div>
<div class="sect2">
<h3 id="_enhanced_user_interface"><a class="anchor" href="#_enhanced_user_interface"></a>1.15. Enhanced User Interface</h3>
<div class="paragraph">
<p>The layout of the user interface is organized with intuitive
navigational elements. With information displayed at-a-glance, it is
intuitive to find and use the automation you need. Compact and expanded
viewing modes show and hide information as needed, and various built-in
attributes make it easy to sort.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_virtual_environments"><a class="anchor" href="#_custom_virtual_environments"></a>1.16. Custom Virtual Environments</h3>
<div class="paragraph">
<p>Custom Ansible environment support allows you to have different Ansible
environments and specify custom paths for different teams and jobs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_authentication_enhancements"><a class="anchor" href="#_authentication_enhancements"></a>1.17. Authentication Enhancements</h3>
<div class="paragraph">
<p>Automation controller supports LDAP, SAML, token-based authentication.
Enhanced LDAP and SAML support allows you to integrate your enterprise
account information in a more flexible manner. Token-based
Authentication allows for easily authentication of third-party tools and
services with automation controller via integrated OAuth 2 token
support.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cluster_management"><a class="anchor" href="#_cluster_management"></a>1.18. Cluster Management</h3>
<div class="paragraph">
<p>Run-time management of cluster groups allows for easily configurable
scaling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_container_platform_support"><a class="anchor" href="#_container_platform_support"></a>1.19. Container Platform Support</h3>
<div class="paragraph">
<p>Ansible Automation Platform is available as a containerized pod service
for Red Hat OpenShift Container Platform that can be scaled up and down
easily as needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workflow_enhancements"><a class="anchor" href="#_workflow_enhancements"></a>1.20. Workflow Enhancements</h3>
<div class="paragraph">
<p>In order to better model your complex provisioning, deployment, and
orchestration workflows, automation controller expanded workflows in a
number of ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Inventory overrides for Workflows</strong>. You can now override an inventory
across a workflow at workflow definition time, or even at launch time.
Define your application deployment workflow, and then easily re-use them
in multiple environments.</p>
</li>
<li>
<p><strong>Convergence nodes for Workflows</strong>. When modeling complex processes,
you sometimes need to wait for multiple steps to finish before
proceeding. Now automation controller workflows can easily replicate
this; workflow steps can now wait for any number of prior workflow steps
to complete properly before proceeding.</p>
</li>
<li>
<p><strong>Workflow Nesting</strong>. Re-use individual workflows as components of a
larger workflow. Examples include combining provisioning and application
deployment workflows into a single master workflow.</p>
</li>
<li>
<p><strong>Workflow Pause and Approval</strong>. You can build workflows containing
approval nodes that require user intervention. This makes it possible to
pause workflows in between playbooks so that a user can give approval
(or denial) for continuing on to the next step in the workflow.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_job_distribution"><a class="anchor" href="#_job_distribution"></a>1.21. Job Distribution</h3>
<div class="paragraph">
<p>As automation moves enterprise-wide, the need to automate at scale
grows. Automation controller offer the ability to take a fact gathering
or configuration job running across thousands of machines and slice it
into individual job slices that can be distributed across your
automation controller cluster for increased reliability, faster job
completion, and better cluster utilization. If you need to change a
parameter across 15,000 switches at scale, or gather information across
your multi-thousand-node RHEL estate, you can now do so easily.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_for_deployment_in_a_fips_enabled_environment"><a class="anchor" href="#_support_for_deployment_in_a_fips_enabled_environment"></a>1.22. Support for deployment in a FIPS-enabled environment</h3>
<div class="paragraph">
<p>If you require running your environment in restricted modes such as
FIPS, automation controller deploys and runs in such environments.</p>
</div>
</div>
<div class="sect2">
<h3 id="_limit_the_number_of_hosts_per_organization"><a class="anchor" href="#_limit_the_number_of_hosts_per_organization"></a>1.23. Limit the number of hosts per organization</h3>
<div class="paragraph">
<p>Lots of large organizations have instances shared among many
organizations. They do not want any one organization to be able to use
all the licensed hosts, this feature allows superusers to set a
specified upper limit on how many licensed hosts may be allocated to
each organization. The automation controller algorithm factors changes
in the limit for an organization and the number of total hosts across
all organizations. Any inventory updates will fail if an inventory sync
brings an organization out of compliance with the policy. Additionally,
superusers are able to 'over-allocate' their licenses, with a warning.</p>
</div>
</div>
<div class="sect2">
<h3 id="_inventory_plugins"><a class="anchor" href="#_inventory_plugins"></a>1.24. Inventory Plugins</h3>
<div class="paragraph">
<p>Updated automation controller to use the following inventory plugins
from upstream collections if inventory updates are run with Ansible 2.9:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>amazon.aws.aws_ec2</p>
</li>
<li>
<p>community.vmware.vmware_vm_inventory</p>
</li>
<li>
<p>azure.azcollection.azure_rm</p>
</li>
<li>
<p>google.cloud.gcp_compute</p>
</li>
<li>
<p>theforeman.foreman.foreman</p>
</li>
<li>
<p>openstack.cloud.openstack</p>
</li>
<li>
<p>ovirt.ovirt.ovirt</p>
</li>
<li>
<p>awx.awx.tower</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_secret_management_system"><a class="anchor" href="#_secret_management_system"></a>1.25. Secret Management System</h3>
<div class="paragraph">
<p>With a secret management system, external credentials are stored and
supplied for use in automation controller so you don&#8217;t have to provide
them directly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_automation_hub_integration"><a class="anchor" href="#_automation_hub_integration"></a>1.26. Automation Hub Integration</h3>
<div class="paragraph">
<p>Automation Hub will act as a content provider for automation controller,
which requires both an automation controller deployment and an
Automation Hub deployment running alongside each other.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_red_hat_ansible_automation_platform_controller_licensing_updates_and_support"><a class="anchor" href="#_red_hat_ansible_automation_platform_controller_licensing_updates_and_support"></a>2. Red Hat Ansible Automation Platform Controller Licensing, Updates, and Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat Ansible Automation Platform controller ("<strong>Automation
Controller</strong>") is a software product provided as part of an annual Red
Hat Ansible Automation Platform subscription entered into between you
and Red Hat, Inc. ("<strong>Red Hat</strong>").</p>
</div>
<div class="paragraph">
<p>Ansible is an open source software project and is licensed under the GNU
General Public License version 3, as detailed in the Ansible source
code: <a href="https://github.com/ansible/ansible/blob/devel/COPYING" class="bare">https://github.com/ansible/ansible/blob/devel/COPYING</a></p>
</div>
<div class="paragraph">
<p>You <strong>must</strong> have valid subscriptions attached before installing the
Ansible Automation Platform. See <code>attach_subscriptions</code> for detail.</p>
</div>
<div class="sect2">
<h3 id="_support"><a class="anchor" href="#_support"></a>2.1. Support</h3>
<div class="paragraph">
<p>Red Hat offers support to paid Red Hat Ansible Automation Platform
customers.</p>
</div>
<div class="paragraph">
<p>If you or your company has purchased a subscription for Ansible
Automation Platform, you can contact the support team at
<a href="https://access.redhat.com" class="bare">https://access.redhat.com</a>. To better understand the levels of support
which match your Ansible Automation Platform subscription, refer to
<code>subscription-types</code>. For details of what is covered under an Ansible
Automation Platform subscription, please see the Scopes of Support at:
<a href="https://access.redhat.com/support/policy/updates/ansible-tower#scope-of-coverage-4" class="bare">https://access.redhat.com/support/policy/updates/ansible-tower#scope-of-coverage-4</a>
and <a href="https://access.redhat.com/support/policy/updates/ansible-engine" class="bare">https://access.redhat.com/support/policy/updates/ansible-engine</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="trial-licenses"><a class="anchor" href="#trial-licenses"></a>2.2. Trial / Evaluation</h3>
<div class="paragraph">
<p>While a license is required for automation controller to run, there is
no fee for a trial license.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Trial licenses for Red Hat Ansible Automation are available at:
<a href="http://ansible.com/license" class="bare">http://ansible.com/license</a></p>
</li>
<li>
<p>Support is not included in a trial license or during an evaluation of
the automation controller software.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_subscription_types"><a class="anchor" href="#_subscription_types"></a>2.3. Subscription Types</h3>
<div class="paragraph">
<p>Red Hat Ansible Automation Platform is provided at various levels of
support and number of machines as an annual Subscription.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standard::</p>
<div class="ulist">
<ul>
<li>
<p>Manage any size environment</p>
</li>
<li>
<p>Enterprise 8x5 support and SLA</p>
</li>
<li>
<p>Maintenance and upgrades included</p>
</li>
<li>
<p>Review the SLA at:
<a href="https://access.redhat.com/support/offerings/production/sla" class="bare">https://access.redhat.com/support/offerings/production/sla</a></p>
</li>
<li>
<p>Review the Red Hat Support Severity Level Definitions at:
<a href="https://access.redhat.com/support/policy/severity" class="bare">https://access.redhat.com/support/policy/severity</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Premium::</p>
<div class="ulist">
<ul>
<li>
<p>Manage any size environment, including mission-critical
environments</p>
</li>
<li>
<p>Premium 24x7 support and SLA</p>
</li>
<li>
<p>Maintenance and upgrades included</p>
</li>
<li>
<p>Review the SLA at:
<a href="https://access.redhat.com/support/offerings/production/sla" class="bare">https://access.redhat.com/support/offerings/production/sla</a></p>
</li>
<li>
<p>Review the Red Hat Support Severity Level Definitions at:
<a href="https://access.redhat.com/support/policy/severity" class="bare">https://access.redhat.com/support/policy/severity</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>All Subscription levels include regular updates and releases of
automation controller, Ansible, and any other components of the
Platform.</p>
</div>
<div class="paragraph">
<p>For more information, contact Ansible via the Red Hat Customer portal at
<a href="https://access.redhat.com/" class="bare">https://access.redhat.com/</a> or at <a href="http://www.ansible.com/contact-us/" class="bare">http://www.ansible.com/contact-us/</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_node_counting_in_licenses"><a class="anchor" href="#_node_counting_in_licenses"></a>2.4. Node Counting in Licenses</h3>
<div class="paragraph">
<p>The Red Hat Ansible Automation Platform controller license defines the
number of Managed Nodes that can be managed as part of a Red Hat Ansible
Automation Platform subscription. A typical license will say âLicense
Count: 500â, which sets the maximum number of Managed Nodes at 500.</p>
</div>
<div class="paragraph">
<p>For more information on managed node requirements for licensing, please
see <a href="https://access.redhat.com/articles/3331481" class="bare">https://access.redhat.com/articles/3331481</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="attach_subscriptions"><a class="anchor" href="#attach_subscriptions"></a>2.5. Attaching Subscriptions</h3>
<div class="paragraph">
<p>You <strong>must</strong> have valid subscriptions attached before installing the
Ansible Automation Platform. Attaching an Ansible Automation Platform
subscription enables Automation Hub repositories. A valid subscription
needs to be attached to the Automation Hub node only. Other nodes do
notÂ needÂ to have a valid subscription/pool attached, even if the
<strong>[automationhub]</strong> group is blank, given this is done at the <code>repos_el</code>
role level and that this role is run on both <strong>[default]</strong> and
<strong>[automationhub]</strong> hosts.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Attaching subscriptions is unnecessary if your Red Hat account enabled
<a href="https://access.redhat.com/articles/simple-content-access">Simple Content
Access Mode</a>. But you still need to register to RHSM or Satellite before
installing the Ansible Automation Platform.</p>
</div>
<div class="paragraph">
<p>To find out the <code>pool_id</code> of your Ansible Automation Platform
subscription:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#subscription-manager list --available --all | grep "Ansible Automation Platform" -B 3 -A 6</pre>
</div>
</div>
<div class="paragraph">
<p>The command returns the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Subscription Name: Red Hat Ansible Automation Platform, Premium (5000 Managed Nodes)
Provides: Red Hat Ansible Engine
Red Hat Single Sign-On
Red Hat Ansible Automation Platform
SKU: MCT3695
Contract: ********
Pool ID: ********************
Provides Management: No
Available: 4999
Suggested: 1</pre>
</div>
</div>
<div class="paragraph">
<p>To attach this subscription:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#subscription-manager attach --pool=&lt;pool_id&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If this is properly done, and all nodes have Red Hat Ansible Automation
Platform attached, then it will find the Automation Hub repositories
correctly.</p>
</div>
<div class="paragraph">
<p>To check whether the subscription was successfully attached:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#subscription-manager list --consumed</pre>
</div>
</div>
<div class="paragraph">
<p>To remove this subscription:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#subscription-manager remove --pool=&lt;pool_id&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_component_licenses"><a class="anchor" href="#_component_licenses"></a>2.6. Component Licenses</h3>
<div class="paragraph">
<p>To view the license information for the components included within
automation controller, refer to
<code>/usr/share/doc/automation-controller-&lt;version&gt;/README</code> where
<code>&lt;version&gt;</code> refers to the version of automation controller you have
installed.</p>
</div>
<div class="paragraph">
<p>To view a specific license, refer to
<code>/usr/share/doc/automation-controller-&lt;version&gt;/*.txt</code>, where <code>*</code> is
replaced by the license file name to which you are referring.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging_in"><a class="anchor" href="#_logging_in"></a>3. Logging In</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To log in, browse to the user interface at: <code><a href="http://&lt;server" class="bare">http://&lt;server</a> name&gt;/</code></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/login-form.png" alt="Login form"></span></p>
</div>
<div class="paragraph">
<p>Log in using a valid username and password.</p>
</div>
<div class="paragraph">
<p>The default username is ''admin'', and the default password is set
during installation. To configure users and passwords, you can do so by
accessing <strong>Users</strong> from the left navigation bar.</p>
</div>
<div class="paragraph">
<p>Available subscriptions or a subscription manifest authorize the use of
the automation controller. To obtain your automation controller
subscription, you can either:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Provide your Red Hat or Satellite username and password on the license
page.</p>
</li>
<li>
<p>Obtain a subscriptions manifest from your Subscription Allocations
page on the customer portal. See <code>obtain_sub_manifest</code> in the Automation
Controller User Guide for more detail.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you <strong>have</strong> a Red Hat Ansible Automation Platform subscription, use
your Red Hat customer credentials when you launch the controller to
access your subscription information (see instructions below).</p>
</div>
<div class="paragraph">
<p>If you <strong>do not</strong> have a Red Hat Ansible Automation Platform subscription,
you can request a trial subscription
<a href="https://www.redhat.com/en/technologies/management/ansible/try-it">here</a>
or click <strong>Request Subscription</strong> and follow the instructions to request
one.</p>
</div>
<div class="paragraph">
<p><strong>Disconnected environments with Satellite</strong> will be able to use the login
flow on vm-based installations if they have configured subscription
manager on the controller instance to connect to their Satellite
instance. Recommended workarounds for disconnected environments <strong>without
Satellite</strong> include [1] downloading a manifest from access.redhat.com in
a connected environment, then uploading it to the disconnected
controller instance, or [2] connecting to the Internet through a proxy
server.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>In order to use a disconnected environment, it is necessary to have a
valid automation controller entitlement attached to your Satellite
organization&#8217;s manifest. This can be confirmed by using
<code>hammer subscription list \--organization &lt;org_name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>If you have issues with the subscription you have received, please
contact your Sales Account Manager or Red Hat Customer Service at
<a href="https://access.redhat.com/support/contact/customerService/" class="bare">https://access.redhat.com/support/contact/customerService/</a>.</p>
</div>
<div class="paragraph">
<p>When the controller launches for the first time, the Subscription screen
automatically displays.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/no-license.png" alt="no license"></span></p>
</div>
<div id="upload_manifest" class="olist arabic">
<ol class="arabic">
<li>
<p>By default, the option to retrieve and import your subscription is to
upload a subscription manifest you generate from
<a href="https://access.redhat.com/management/subscription_allocations" class="bare">https://access.redhat.com/management/subscription_allocations</a>. See
<code>obtain_sub_manifest</code> for more detail. Once you have a subscription
manifest, you can upload it by browsing to the location where the file
is saved (the subscription manifest is the complete .zip file, not its
component parts).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If the <strong>Browse</strong> button in the subscription manifest option is
grayed-out, clear the username and password fields to enable the
<strong>Browse</strong> button.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can choose the option to enter your Red Hat customer
credentials using your username and password. Use your Satellite
username/password if your controller cluster nodes are registered to
Satellite via Subscription Manager. Once you entered your credentials,
click <strong>Get Subscriptions</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>The subscription metadata is then retrieved from the RHSM/Satellite
API, or from the manifest provided.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p>If it is a subscription manifest, and multiple subscription counts
were applied in a single installation, the controller will combine the
counts but use the earliest expiration date as the expiry (at which
point you will need to refresh your subscription).</p>
</li>
<li>
<p>If you entered your credential information (username/password), the
controller retrieves your configured subscription service. Then it
prompts you to choose the subscription you want to run (the example
below shows multiple subscriptions) and entitles the controller with
that metadata. You can log in over time and retrieve new subscriptions
if you have renewed.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>When your subscription expires (you can check this in the Subscription
details of the Subscription settings window), you will need to renew it
in the controller by one of these two methods.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/license-password-entered.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>If you encounter the following error message, you will need the proper
permissions required for the Satellite user with which the controller
admin uses to apply a subscription.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/tower-license-error-satellite-user.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The Satellite username/password is used to query the Satellite API for
existing subscriptions. From the Satellite API, the automation
controller gets back some metadata about those subscriptions, then
filter through to find valid subscriptions that you could apply, which
are then displayed as valid subscription options in the UI.</p>
</div>
<div class="paragraph">
<p>The following Satellite roles grant proper access:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom with <code>view_subscriptions</code> and <code>view_organizations</code> filter</p>
</li>
<li>
<p>Viewer</p>
</li>
<li>
<p>Administrator</p>
</li>
<li>
<p>Organization Admin</p>
</li>
<li>
<p>Manager</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As the <em>Custom</em> role is the most restrictive of these, this is the
recommend role to use for your controller integration. Refer to the
<a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.8/html/administering_red_hat_satellite/chap-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Users_and_Roles#sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Users_and_Roles-Creating_and_Managing_Roles">Satellite
documentation</a> on managing users and roles for more detail.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The System Administrator role is not equivalent to the Administrator
user checkbox, and will not provide sufficient permissions to access the
subscriptions API page.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Next</strong> to proceed to <strong>Tracking and Insights</strong>. Tracking and
insights collect data to help Red Hat improve the product by delivering
you a much better user experience. For more information about data
collection, refer to <code>usability_data_collection</code>. This option is checked
by default, but you may opt out of any of the following:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>User analytics</strong> collects data from the controller User Interface.</p>
</li>
<li>
<p><strong>Insights Analytics</strong> provides a high level analysis of your automation
with automation controller, which is used to help you identify trends
and anomalous use of the controller. For opt-in of Automation Analytics
to have any effect, your instance of automation controller <strong>must</strong> be
running on Red Hat Enterprise Linux. See instructions described in the
<code>user_data_insights</code> section. If you select to opt-in for this option,
the screen expands and prompts for a username and password to enable
Insights, if applicable.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>You may change your analytics data collection preferences at any time,
as described in the <code>usability_data_collection</code> section.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>After you have specified your tracking and insights preferences, click
<strong>Next</strong> to proceed to the End User Agreement.</p>
</li>
<li>
<p>Review and check the <strong>I agree to the End User License Agreement</strong>
checkbox and click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once your subscription has been accepted, the controller briefly
displays the subscription details and navigates you to the Dashboard of
the automation controller interface. For later reference, you can return
to this screen by clicking <strong>Settings</strong> from the left navigation bar and
select <strong>Subscription settings</strong> from the Subscription option.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/qs-licenseaccepted.png" alt="license accepted"></span></p>
</div>
<div class="paragraph">
<p>A status of <em>Compliant</em> indicates your subscription is in compliance
with the number of hosts you have automated within your subscription
count. Otherwise, your status will show an <em>Out of Compliance</em> status,
indicating you have exceeded the number of hosts in your subscription.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/qs-license-non-compliant.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_user_interface"><a class="anchor" href="#_the_user_interface"></a>4. The User Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The User Interface offers a friendly graphical framework for your IT
orchestration needs. The left navigation bar provides quick access to
resources, such as <strong>Projects</strong>, <strong>Inventories</strong>, <strong>Job Templates</strong>, and
<strong>Jobs</strong>.</p>
</div>
<div class="paragraph">
<p>Across the top-right side of the interface, you can access your user
profile, the About page, view related documentation, and log out. Right
below these options, you can view the activity stream for that user by
clicking on the Activity Stream
<span class="image"><img src="images/activitystream.png" alt="activitystream"></span>
button.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-dashboard-top-nav.png" alt="image"></span></p>
</div>
<div class="sect2">
<h3 id="ug_activitystreams"><a class="anchor" href="#ug_activitystreams"></a>4.1. Activity Streams</h3>
<div class="paragraph">
<p>Most screens have an Activity Stream
(<span class="image"><img src="images/activitystream.png" alt="activitystream"></span>)
button. Clicking this brings up the <strong>Activity Stream</strong> for this object.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-activity-stream.png" alt="Users - Activity Stream"></span></p>
</div>
<div class="paragraph">
<p>An Activity Stream shows all changes for a particular object. For each
change, the Activity Stream shows the time of the event, the user that
initiated the event, and the action. The information displayed varies
depending on the type of event. Clicking on the Examine
(<span class="image"><img src="images/examine-button.png" alt="examine"></span>) button
shows the event log for the change.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/activity-stream-event-log.png" alt="event log"></span></p>
</div>
<div class="paragraph">
<p>The Activity Stream can be filtered by the initiating user (or the
system, if it was system initiated), and by any related object, such as
a particular credential, job template, or schedule.</p>
</div>
<div class="paragraph">
<p>The Activity Stream on the main Dashboard shows the Activity Stream for
the entire instance. Most pages allow viewing an activity stream
filtered for that specific object.</p>
</div>
</div>
<div class="sect2">
<h3 id="_views"><a class="anchor" href="#_views"></a>4.2. Views</h3>
<div class="paragraph">
<p>The User Interface provides several options for viewing information.</p>
</div>
<div class="sect3">
<h4 id="_dashboard_view"><a class="anchor" href="#_dashboard_view"></a>4.2.1. Dashboard view</h4>
<div class="paragraph">
<p>The <strong>Dashboard</strong> view begins with a summary of your hosts, inventories,
and projects. Each of these is linked to the corresponding objects for
easy access.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-dashboard-topsummary.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>On the main Dashboard screen, a summary appears listing your current
<strong>Job Status</strong>. The <strong>Job Status</strong> graph displays the number of successful
and failed jobs over a specified time period. You can choose to limit
the job types that are viewed, and to change the time horizon of the
graph.</p>
</div>
<div class="paragraph">
<p>Also available for view are summaries of <strong>Recent Jobs</strong> and <strong>Recent
Templates</strong> on their respective tabs.</p>
</div>
<div class="paragraph">
<p>The <strong>Recent Jobs</strong> section displays which jobs were most recently run,
their status, and time when they were run as well.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-dashboard-recent-jobs.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The <strong>Recent Templates</strong> section of this display shows a summary of the
most recently used templates. You can also access this summary by
clicking <strong>Templates</strong> from the left navigation bar.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-dashboard-recent-templates.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Clicking on <strong>Dashboard</strong> from the left navigation bar or the Ansible
Automation Platform logo at any time returns you to the Dashboard.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jobs_view"><a class="anchor" href="#_jobs_view"></a>4.2.2. Jobs view</h4>
<div class="paragraph">
<p>Access the <strong>Jobs</strong> view by clicking <strong>Jobs</strong> from the left navigation bar.
This view shows all the jobs that have ran, including projects,
templates, management jobs, SCM updates, playbook runs, etc.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-dashboard-jobs-view.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_schedules_view"><a class="anchor" href="#_schedules_view"></a>4.2.3. Schedules view</h4>
<div class="paragraph">
<p>Access the Schedules view by clicking <strong>Schedules</strong> from the left
navigation bar. This view shows all the scheduled jobs that are
configured.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-dashboard-schedule-view.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resources_and_access"><a class="anchor" href="#_resources_and_access"></a>4.3. Resources and Access</h3>
<div class="paragraph">
<p>The <strong>Resources</strong> and <strong>Access</strong> menus provide you access to the various
components of automation controller and allow you to configure who has
permissions for which of those resources.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/left-nav-resources-access.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_administration_menu"><a class="anchor" href="#_administration_menu"></a>4.4. Administration Menu</h3>
<div class="paragraph">
<p>The <strong>Administration</strong> menu provides access to the various administrative
options:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/left-nav-administration.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>From here, you can create, view, and edit
<code>custom credential types &lt;ug_credential_types&gt;</code>,
<code>notifications &lt;ug_notifications&gt;</code>, management jobs,
<code>tokens and applications &lt;ug_applications_auth&gt;</code>, and configure
<a href="#ug_execution_environments">[ug_execution_environments]</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_settings_menu"><a class="anchor" href="#_the_settings_menu"></a>4.5. The Settings Menu</h3>
<div class="paragraph">
<p>Configuring global and system-level settings is accomplished through the
<strong>Settings</strong> menu, which is described in further detail in the proceeding
section. The <strong>Settings</strong> menu offers access to administrative
configuration options.</p>
</div>
<div class="paragraph">
<p>To enter the Settings window for automation controller, click <strong>Settings</strong>
from the left navigation bar. This page allows you to modify your
controller&#8217;s configuration, such as settings associated with
authentication, jobs, system, user interface, and view or retrieve your
subscription information.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ug-settings-menu-screen.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>For more information on configuring these settings, refer to
<a href="#ag_configure_tower">[ag_configure_tower]</a> section of the Automation Controller Administration
Guide.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_search"><a class="anchor" href="#ug_search"></a>5. Search</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The automation controller has a powerful search tool that provides both
search and filter capabilities that span across multiple functions.
Acceptable search criteria are provided in an expandable "cheat-sheet"
accessible from the <strong>Advanced</strong> option from the <strong>Name</strong> drop-down menu in
the search field. From there, use the combination of <strong>Set Type</strong>, <strong>Key</strong>,
<strong>Lookup type</strong> to filter.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/search-bar-key.png" alt="key sheet"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_searching_tips"><a class="anchor" href="#_searching_tips"></a>6. Searching Tips</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These searching tips assume that you are not searching hosts. Most of
this section still applies to hosts but with some subtle differences. A
typical syntax of a search consists a field (left-hand side) and a value
(right-hand side). A colon is used to separate the field that you want
to search from the value. If a search doesn&#8217;t have a colon (see example
3) it is treated as a simple string search where <code>?search=foobar</code> is
sent. Here are the examples of syntax used for searching:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>name:localhost</code> In this example, the string before the colon
represents the field that you want to search on. If that string does not
match something from <strong>Fields</strong> or <strong>Related Fields</strong> then it&#8217;s treated the
same way Example 3 is (string search). The string after the colon is the
string that you want to search for within the name attribute.</p>
</li>
<li>
<p><code>organization.name:Default</code> This example shows a Related Field Search.
The period in the left-hand portion separates the model from the field
in this case. Depending on how deep/complex the search is, you could
have multiple periods in that left-hand portion.</p>
</li>
<li>
<p><code>foobar</code> Simple string (key term) search that will find all instances
of that term using an <code>icontains</code> search against the name and
description fields. If a space is used between terms (e.g. foo bar),
then any results that contain both terms will be returned. If the terms
are wrapped in quotes (e.g. "foo bar"), the controller will search for
the entire string with the terms appearing together. Specific name
searches will search against the API name. For example, <code>Management job</code>
in the user interface is <code>system_job</code> in the API.</p>
</li>
<li>
<p><code>organization:Default</code> This example shows a Related Field search but
without specifying a field to go along with the organization. This is
supported by the API and is analogous to a simple string search but done
against the organization (will do an <code>icontains</code> search against both the
name and description).</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_values_for_search_fields"><a class="anchor" href="#_values_for_search_fields"></a>6.1. Values for search fields</h3>
<div class="paragraph">
<p>To find values for certain fields, refer to the API endpoint for
extensive options and their valid values. For example, if you want to
search against <code>/api/v2/jobs</code> &#8594; <code>type</code> field, you can find the values
by performing an <strong>OPTIONS</strong> request to <code>/api/v2/jobs</code> and look for
entries in the API for <code>"type"</code>. Additionally, you can view the related
searches by scrolling to the bottom of each screen. In the example for
<code>/api/v2/jobs</code>, the related search shows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"related_search_fields": [
       "modified_by__search",
       "project__search",
       "project_update__search",
       "credentials__search",
       "unified_job_template__search",
       "created_by__search",
       "inventory__search",
       "labels__search",
       "schedule__search",
       "webhook_credential__search",
       "job_template__search",
       "job_events__search",
       "dependent_jobs__search",
       "launch_config__search",
       "unifiedjob_ptr__search",
       "notifications__search",
       "unified_job_node__search",
       "instance_group__search",
       "hosts__search",
       "job_host_summaries__search"</pre>
</div>
</div>
<div class="paragraph">
<p>The values for Fields come from the keys in a <strong>GET</strong> request. <code>url</code>,
<code>related</code>, and <code>summary_fields</code> are not used. The values for Related
Fields also come from the <strong>OPTIONS</strong> response, but from a different
attribute. Related Fields is populated by taking all the values from
<code>related_search_fields</code> and stripping off the <code>__search</code> from the end.</p>
</div>
<div class="paragraph">
<p>Any search that does not start with a value from Fields or a value from
the Related Fields, will be treated as a generic string search.
Searching for something like <code>localhost</code> will result in the UI sending
<code>?search=localhost</code> as a query parameter to the API endpoint. This is a
shortcut for an <code>icontains</code> search on the name and description fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="_searching_using_values_from_related_fields"><a class="anchor" href="#_searching_using_values_from_related_fields"></a>6.2. Searching using values from Related Fields</h3>
<div class="paragraph">
<p>Searching a Related Field requires you to start the search string with
the Related Field. This example describes how to search using values
from the Related Field, <span class="title-ref">organization</span>.</p>
</div>
<div class="paragraph">
<p>The left-hand side of the search string must start with
<span class="title-ref">organization</span> (ex: <code>organization:Default</code>). Depending on
the related field, you might want to provide more specific direction for
the search by providing secondary/tertiary fields. An example of this
would be to specify that you want to search for all job templates that
use a project matching a certain name. The syntax on this would look
like: <code>job_template.project.name:"A Project"</code>.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>This query would execute against the <code>unified_job_templates</code> endpoint
which is why it starts with <code>job_template</code>. If we were searching against
the <code>job_templates</code> endpoint, then you wouldn&#8217;t need the <code>job_template</code>
portion of that query.</p>
</div>
</div>
<div class="sect2">
<h3 id="_other_search_considerations"><a class="anchor" href="#_other_search_considerations"></a>6.3. Other search considerations</h3>
<div class="paragraph">
<p>The following are a few things about searching in the controller that
you should be aware of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There&#8217;s currently no supported syntax for <strong>OR</strong> queries. All search
terms get <strong>AND</strong>'d in the query parameters.</p>
</li>
<li>
<p>The left-hand portion of a search parameter can be wrapped in quotes
to support searching for strings with spaces.</p>
</li>
<li>
<p>Currently, the values in the Fields are direct attributes expected to
be returned in a <strong>GET</strong> request. Whenever you search against one of the
values, the controller essentially does an <code>__icontains</code> search. So, for
example, <code>name:localhost</code> would send back <code>?name__icontains=localhost</code>.
The controller currently performs this search for every Field value,
even <code>id</code>, which is not ideal.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sort"><a class="anchor" href="#_sort"></a>7. Sort</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Where applicable, use the arrows in each column to sort by ascending or
descending order (following is an example from the schedules list).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sort-order-example.png" alt="sort arrow"></span></p>
</div>
<div class="paragraph">
<p>The direction of the arrow indicates the sort order of the column.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_organizations"><a class="anchor" href="#ug_organizations"></a>8. Organizations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <code>Organization</code> is a logical collection of <strong>Users</strong>, <strong>Teams</strong>,
<strong>Projects</strong>, and <strong>Inventories</strong>, and is the highest level in the
automation controller object hierarchy.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/TowerHierarchy.png" alt="tower hierarchy"></span></p>
</div>
<div class="paragraph">
<p>Access the Organizations page by clicking <strong>Organizations</strong> from the left
navigation bar. The Organizations page displays all of the existing
organizations for your installation. Organizations can be searched by
<strong>Name</strong> or <strong>Description</strong>. Modify and remove organizations using the
<strong>Edit</strong> and <strong>Delete</strong> buttons.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>A default organization is automatically created.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-home-showing-example-organization.png" alt="Organizations - home showing example organization"></span></p>
</div>
<div class="paragraph">
<p>From this list view, you can edit the details of an organization
(<span class="image"><img src="images/edit-button.png" alt="edit button"></span>) from the
<strong>Actions</strong> menu.</p>
</div>
<div class="sect2">
<h3 id="ug_organizations_create"><a class="anchor" href="#ug_organizations_create"></a>8.1. Creating a New Organization</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You can create a new organization by clicking the <strong>Add</strong> button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-new-organization-form.png" alt="Organizations - new organization form"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>An organization has several attributes that may be configured:</p>
<div class="ulist">
<ul>
<li>
<p>Enter the <strong>Name</strong> for your organization (required).</p>
</li>
<li>
<p>Enter a <strong>Description</strong> for the organization.</p>
</li>
<li>
<p>The <strong>Max Hosts</strong> is only editable by a superuser to set an upper limit
on the number of license hosts that an organization can have. Setting
this value to <strong>0</strong> signifies no limit. If you try to add a host to an
organization that has reached or exceeded its cap on hosts, an error
message displays:</p>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-max-hosts-error.png" alt="image"></span></p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The inventory sync output view also shows the host limit error. Click
<strong>Details</strong> for additional detail about the error.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-max-hosts-error-output-view.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>Enter <strong>Instance Groups</strong> on which to run this organization.</p>
</li>
<li>
<p>Enter the name of the execution environment or search for an existing
<strong>Default Execution Environment</strong> on which to run this organization. See
<code>upgrade_venv</code> in the Ansible Automation Platform Upgrade and Migration
Guide for more information.</p>
</li>
<li>
<p>If used, enter the <strong>Galaxy Credentials</strong> or search from a list of
existing ones.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> to finish creating the organization.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once created, automation controller displays the Organization details,
and allows for the managing access and execution environments for the
organization.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-show-record-for-example-organization.png" alt="Organizations - show record for example organization"></span></p>
</div>
<div class="paragraph">
<p>From the <strong>Details</strong> tab, you can edit or delete the organization.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If deleting items that are used by other work items, a message opens
listing the items are affected by the deletion and prompts you to
confirm the deletion. Some screens will contain items that are invalid
or previously deleted, so they will fail to run. Below is an example of
such a message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/warning-deletion-dependencies.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_access"><a class="anchor" href="#_work_with_access"></a>8.2. Work with Access</h3>
<div class="paragraph">
<p>pair; organizations; teams</p>
</div>
<div class="paragraph">
<p>Clicking on <strong>Access</strong> (beside <strong>Details</strong> when viewing your organization),
displays all the Users associated with this Organization and their
roles.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-show-users-permissions-organization.png" alt="Organizations - show users for example organization"></span></p>
</div>
<div class="paragraph">
<p>As you can manage the user membership for this Organization here, you
can manage user membership on a per-user basis from the Users page by
clicking <strong>Users</strong> from the left navigation bar. Organizations have a
unique set of roles not described here. You can assign specific users
certain levels of permissions within your organization, or allow them to
act as an admin for a particular resource. Refer to <code>rbac-ug</code> for more
information.</p>
</div>
<div class="paragraph">
<p>Clicking on a user brings up that user&#8217;s details, allowing you to
review, grant, edit, and remove associated permissions for that user.
For more information, refer to <a href="#ug_users">[ug_users]</a>.</p>
</div>
<div class="sect3">
<h4 id="_add_a_user_or_team"><a class="anchor" href="#_add_a_user_or_team"></a>8.2.1. Add a User or Team</h4>
<div class="paragraph">
<p>In order to add a user or team to an organization, the user or team must
already be created. See <a href="#ug_users_create` and xref:ug_team_create">[ug_users_create` and xref:ug_team_create]</a> for
additional detail. To add existing users or team to the Organization:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Select a user or team to add and click <strong>Next</strong></p>
</li>
<li>
<p>Select one or more users or teams from the list by clicking the check
box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-for-example-organization.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>In this example, two users have been selected to be added.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Select the role(s) you want the selected user(s) or team(s) to have.
Be sure to scroll down for a complete list of roles. Different resources
have different options available.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-roles.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or
team(s) and to add them as members.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Add Users/Teams window closes to display the updated roles assigned
for each user and team.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-tab-roles-assigned.png" alt="Permissions tab with Role Assignments"></span></p>
</div>
<div class="paragraph">
<p>To remove roles for a particular user, click the disassociate (x) button
next to its resource.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>This launches a confirmation dialog, asking you to confirm the
disassociation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate-confirm.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>A user or team with roles associated will retain them even after they
have been reassigned to another organization.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_notifications"><a class="anchor" href="#_work_with_notifications"></a>8.3. Work with Notifications</h3>
<div class="paragraph">
<p>Clicking the <strong>Notifications</strong> tab allows you to review any notification
integrations you have setup.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-notifications-samples-list.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Use the toggles to enable or disable the notifications to use with your
particular organization. For more detail, see <a href="#ug_notifications_on_off">[ug_notifications_on_off]</a>.</p>
</div>
<div class="paragraph">
<p>If no notifications have been set up, you must create them from the
<strong>Notifications</strong> option on the left navigation bar.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organization-notifications-empty.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Refer to <a href="#ug_notifications_types">[ug_notifications_types]</a> for additional details on configuring
various notification types.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_users"><a class="anchor" href="#_users"></a>9. Users</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>User</code> is someone who has access to automation controller with
associated permissions and credentials. Access the Users page by
clicking <strong>Users</strong> from the left navigation bar. The User list may be
sorted and searched by <strong>Username</strong>, <strong>First Name</strong>, or <strong>Last Name</strong> and
click the headers to toggle your sorting preference.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-home-with-example-users.png" alt="Users - home with example users"></span></p>
</div>
<div class="paragraph">
<p>You can easily view permissions and user type information by looking
beside their user name in the User overview screen.</p>
</div>
<div class="sect2">
<h3 id="ug_users_create"><a class="anchor" href="#ug_users_create"></a>9.1. Create a User</h3>
<div class="paragraph">
<p>To create a new user:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button, which opens the Create User dialog.</p>
</li>
<li>
<p>Enter the appropriate details about your new user. Fields marked with
an asterisk (*) are required.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>When modifying your own password, log out and log back in again in order
for it to take effect.</p>
</div>
<div class="paragraph">
<p>Three types of Users can be assigned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Normal User</strong>: Normal Users have read and write access limited to the
resources (such as inventory, projects, and job templates) for which
that user has been granted the appropriate roles and privileges.</p>
</li>
<li>
<p><strong>System Auditor</strong>: Auditors implicitly inherit the read-only capability
for all objects within the environment.</p>
</li>
<li>
<p><strong>System Administrator</strong>: A System Administrator (also known as
Superuser) has full system administration privileges&#8201;&#8212;&#8201;with full read
and write privileges over the entire installation. A System
Administrator is typically responsible for managing all aspects of
automation controller and delegating responsibilities for day-to-day
work to various Users. Assign with caution!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-create-user-form-types.png" alt="User Types"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The initial user (usually "admin") created by the installation process
is a Superuser. One Superuser must always exist. To delete the "admin"
user account, you must first create another Superuser account.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Select <strong>Save</strong> when finished.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the user is successfully created, the <strong>User</strong> dialog opens for that
newly created User.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-edit-user-form.png" alt="Edit User Form"></span></p>
</div>
<div class="paragraph">
<p>You may delete the user from its Details screen by clicking <strong>Delete</strong>, or
once you exit the details screen, you can delete users from a list of
current users. See <a href="#ug_users_delete">Delete a User</a> for more detail.</p>
</div>
<div class="paragraph">
<p>The count for the number of users has also been updated, and a new entry
for the new user is added to the list of users below the edit form. The
same window opens whether you click on the user&#8217;s name, or the Edit
(<span class="image"><img src="images/edit-button.png" alt="edit-button"></span>) button
beside the user. Here, the User&#8217;s <strong>Organizations</strong>, <strong>Teams</strong>, and
<strong>Permissions</strong>, as well as other user membership details, may be reviewed
and modified.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If the user is not a newly-created user, the user&#8217;s details screen
displays the last login activity of that user.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-last-login-info.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>When you log in as yourself, and view the details of your own user
profile, you can manage tokens from your user profile. See
<a href="#ug_users_tokens">Users - Tokens</a> for more detail.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/user-with-token-button.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="ug_users_delete"><a class="anchor" href="#ug_users_delete"></a>9.2. Delete a User</h3>
<div class="paragraph">
<p>Before you can delete a user, you must haveÂ userÂ permissions. When you
delete a user account, the name and email of the user are permanently
removed from automation controller.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand theÂ <strong><em>Access</em></strong>Â menu from the left navigation bar, and
clickÂ <strong><em>Users</em></strong>Â to display a list of the current users.</p>
</li>
<li>
<p>Select the check box(es) for the user(s) that you want to remove and
clickÂ <strong><em>Delete</em></strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-home-users-checked-delete.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>ClickÂ <strong><em>Delete</em></strong>Â in the confirmation warning message to permanently
delete the user.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_users_organizations"><a class="anchor" href="#_users_organizations"></a>9.3. Users - Organizations</h3>
<div class="paragraph">
<p>This displays the list of organizations of which that user is a member.
This list may be searched by Organization Name or Description.
Organization membership cannot be modified from this display panel.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-organizations-list-for-example-user.png" alt="Users - Organizations list for example user"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_users_teams"><a class="anchor" href="#_users_teams"></a>9.4. Users - Teams</h3>
<div class="paragraph">
<p>This displays the list of teams of which that user is a member. This
list may be searched by <strong>Team Name</strong> or <strong>Description</strong>. Team membership
cannot be modified from this display panel. For more information, refer
to <a href="#ug_teams">Teams</a>.</p>
</div>
<div class="paragraph">
<p>Until a Team has been created and the user has been assigned to that
team, the assigned Teams Details for the User appears blank.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-teams-list-for-example-user.png" alt="Users - teams list for example user"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="ug_users_permissions"><a class="anchor" href="#ug_users_permissions"></a>9.5. Users - Permissions</h3>
<div class="paragraph">
<p>The set of Permissions assigned to this user (role-based access
controls) that provide the ability to read, modify, and administer
projects, inventories, job templates, and other automation controller
elements are Privileges.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>It is important to note that the job template administrator may not have
access to any inventory, project, or credentials associated with the
template. Without access to these, certain fields in the job template
aren&#8217;t editable.</p>
</div>
<div class="paragraph">
<p>This screen displays a list of the roles that are currently assigned to
the selected User and can be sorted and searched by <strong>Name</strong>, <strong>Type</strong>, or
<strong>Role</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-permissions-list-for-example-user.png" alt="Users - permissions list for example user"></span></p>
</div>
<div class="sect3">
<h4 id="_add_permissions"><a class="anchor" href="#_add_permissions"></a>9.5.1. Add Permissions</h4>
<div class="paragraph">
<p>To add permissions to a particular user:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button, which opens the Add Permissions Wizard.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-add-permissions-form.png" alt="Add Permissions Form"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click to select the object for which the user will have access and
click <strong>Next</strong>.</p>
</li>
<li>
<p>Click to select the resource to assign team roles and click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-permissions-inventory-select.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click the checkbox beside the role to assign that role to your chosen
type of resource. Different resources have different options available.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-permissions-inventory-roles.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click <strong>Save</strong> when done, and the Add Permissions Wizard closes to
display the updated profile for the user with the roles assigned for
each selected resource.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-permissions-sample-roles.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To remove Permissions for a particular resource, click the disassociate
(x) button next to its resource. This launches a confirmation dialog,
asking you to confirm the disassociation.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>You can also add teams, individual, or multiple users and assign them
permissions at the object level (projects, inventories, job templates,
and workflow templates) as well. This feature reduces the time for an
organization to onboard many users at one time.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_users_tokens"><a class="anchor" href="#ug_users_tokens"></a>9.6. Users - Tokens</h3>
<div class="paragraph">
<p>The <strong>Tokens</strong> tab will only be present for your user (yourself). Before
you add a token for your user, you may want to
<code>create an application &lt;ug_applications_auth_create&gt;</code> if you want to
associate your token to it. You may also create a personal access token
(PAT) without associating it with any application. To create a token for
your user:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If not already selected, click on your user from the Users list view
to configure your OAuth 2 tokens.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the <strong>Tokens</strong> tab from your user&#8217;s profile.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When no tokens are present, the Tokens screen prompts you to add them:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-tokens-empty.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click the <strong>Add</strong> button, which opens the Create Token window.</p>
</li>
<li>
<p>Enter the following details in Create Token window:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Application</strong>: enter the name of the application with which you want
to associate your token. Alternatively, you can search for it by
clicking the <span class="image"><img src="images/search-button.png" alt="search"></span>
button. This opens a separate window that allows you to choose from the
available options. Use the Search bar to filter by name if the list is
extensive. Leave this field blank if you want to create a Personal
Access Token (PAT) that is not linked to any application.</p>
</li>
<li>
<p><strong>Description</strong>: optionally provide a short description for your token.</p>
</li>
<li>
<p><strong>Scope</strong> (required): specify the level of access you want this token to
have.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>When done, click <strong>Save</strong> or <strong>Cancel</strong> to abandon your changes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After the token is saved, the newly created token for the user displays
with the token information and when it expires.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-token-information-example.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>This is the only time the token value and associated refresh token value
will ever be shown.</p>
</div>
<div class="paragraph">
<p>In the user&#8217;s profile, the application for which it is assigned to and
its expiration displays in the token list view.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-token-assignment-example.png" alt="image"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_teams"><a class="anchor" href="#ug_teams"></a>10. Teams</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>Team</code> is a subdivision of an organization with associated users,
projects, credentials, and permissions. Teams provide a means to
implement role-based access control schemes and delegate
responsibilities across organizations. For instance, permissions may be
granted to a whole Team rather than each user on the Team.</p>
</div>
<div class="paragraph">
<p>You can create as many Teams of users as make sense for your
Organization. Each Team can be assigned permissions, just as with Users.
Teams can also scalably assign ownership for Credentials, preventing
multiple interface click-throughs to assign the same Credentials to the
same user.</p>
</div>
<div class="paragraph">
<p>Access the Teams page by clicking <strong>Teams</strong> from the left navigation bar.
The team list may be sorted and searched by <strong>Name</strong> or <strong>Organization</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-teams-list.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Clicking the Edit
(<span class="image"><img src="images/edit-button.png" alt="edit-button"></span>) button
next to the list of <strong>Teams</strong> allows you to edit details about the team.
You can also review <strong>Users</strong> and <strong>Permissions</strong> associated with this Team.</p>
</div>
<div class="sect2">
<h3 id="ug_team_create"><a class="anchor" href="#ug_team_create"></a>10.1. Create a Team</h3>
<div class="paragraph">
<p>To create a new Team:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-create-new-team.png" alt="Teams - create new team"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details into the following fields:</p>
<div class="ulist">
<ul>
<li>
<p>Name</p>
</li>
<li>
<p>Description (optional)</p>
</li>
<li>
<p>Organization (Choose from an existing organization)</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the Team is successfully created, automation controller opens the
<strong>Details</strong> dialog, which also allows you to review and edit your Team
information.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-example-team-successfully-created.png" alt="Teams - example team successfully created"></span></p>
</div>
<div class="sect3">
<h4 id="_team_access"><a class="anchor" href="#_team_access"></a>10.1.1. Team Access</h4>
<div class="paragraph">
<p>This tab displays the list of Users that are members of this Team. This
list may be searched by <strong>Username</strong>, <strong>First Name</strong>, or <strong>Last Name</strong>. For
more information, refer to <a href="#ug_users">[ug_users]</a>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-users-list.png" alt="Teams - users list"></span></p>
</div>
<div class="sect4">
<h5 id="ug_teams_permissions"><a class="anchor" href="#ug_teams_permissions"></a>Add a User</h5>
<div class="paragraph">
<p>In order to add a user to a team, the user must already be created.
Refer to <a href="#ug_users_create">Create a User</a> to create a user. Adding a user to a team
adds them as a member only, specifying a role for the user on different
resources can be done in the <strong>Access</strong> tab . To add existing users to the
Team:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Follow the prompts to add user(s) and assign them to roles.</p>
</li>
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To remove roles for a particular user, click the disassociate (x) button
next to its resource.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>This launches a confirmation dialog, asking you to confirm the
disassociation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate-confirm.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_team_roles"><a class="anchor" href="#_team_roles"></a>10.1.2. Team Roles</h4>
<div class="paragraph">
<p>Selecting the <strong>Roles</strong> view displays a list of the permissions that are
currently available for this Team. The permissions list may be sorted
and searched by <strong>Resource Name</strong>, <strong>Type</strong>, or <strong>Role</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-permissions-sample-roles.png" alt="Teams - permissions list"></span></p>
</div>
<div class="paragraph">
<p>The set of privileges assigned to Teams that provide the ability to
read, modify, and administer projects, inventories, and other automation
controller elements are permissions. By default, the Team is given the
"read" permission (also called a role).</p>
</div>
<div class="paragraph">
<p>Permissions must be set explicitly via an Inventory, Project, Job
Template, or within the Organization view.</p>
</div>
<div class="sect4">
<h5 id="_add_team_permissions"><a class="anchor" href="#_add_team_permissions"></a>Add Team Permissions</h5>
<div class="paragraph">
<p>To add permissions to a Team:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button, which opens the Add Permissions Wizard.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-users-add-permissions-form.png" alt="Add Permissions Form"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click to select the object for which the team will have access and
click <strong>Next</strong>.</p>
</li>
<li>
<p>Click to select the resource to assign team roles and click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-permissions-templates-select.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click the checkbox beside the role to assign that role to your chosen
type of resource. Different resources have different options available.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-permissions-template-roles.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click <strong>Save</strong> when done, and the Add Permissions Wizard closes to
display the updated profile for the user with the roles assigned for
each selected resource.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/teams-permissions-sample-roles.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To remove Permissions for a particular resource, click the disassociate
(x) button next to its resource. This launches a confirmation dialog,
asking you to confirm the disassociation.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>You can also add teams, individual, or multiple users and assign them
permissions at the object level (projects, inventories, job templates,
and workflow templates) as well. This feature reduces the time for an
organization to onboard many users at one time.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_credentials"><a class="anchor" href="#ug_credentials"></a>11. Credentials</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Credentials are utilized for authentication when launching Jobs against
machines, synchronizing with inventory sources, and importing project
content from a version control system.</p>
</div>
<div class="paragraph">
<p>You can grant users and teams the ability to use these credentials,
without actually exposing the credential to the user. If you have a user
move to a different team or leave the organization, you donât have to
re-key all of your systems just because that credential was available in
the automation controller.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The automation controller encrypts passwords and key information in the
database and never makes secret information visible via the API. See
<code>Automation Controller Administration Guide &lt;administration:ag_secret_handling&gt;</code>
for details.</p>
</div>
<div class="sect2">
<h3 id="how_credentials_work"><a class="anchor" href="#how_credentials_work"></a>11.1. Understanding How Credentials Work</h3>
<div class="paragraph">
<p>The automation controller uses SSH to connect to remote hosts (or the
Windows equivalent). In order to pass the key from the automation
controller to SSH, the key must be decrypted before it can be written a
named pipe. The automation controller then uses that pipe to send the
key to SSH (so that it is never written to disk).</p>
</div>
<div class="paragraph">
<p>If passwords are used, the automation controller handles those by
responding directly to the password prompt and decrypting the password
before writing it to the prompt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_getting_started_with_credentials"><a class="anchor" href="#_getting_started_with_credentials"></a>11.2. Getting Started with Credentials</h3>
<div class="paragraph">
<p>Click <strong>Credentials</strong> from the left navigation bar to access the
Credentials page. The Credentials page displays a search-able list of
all available Credentials and can be sorted by <strong>Name</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-demo-edit-details.png" alt="Credentials - home with example credentials"></span></p>
</div>
<div class="paragraph">
<p>Credentials added to a Team are made available to all members of the
Team, whereas credentials added to a User are only available to that
specific User by default.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If deleting items that are used by other work items, a message opens
listing the items are affected by the deletion and prompts you to
confirm the deletion. Some screens will contain items that are invalid
or previously deleted, so they will fail to run. Below is an example of
such a message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/warning-deletion-dependencies.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To help you get started, a Demo Credential has been created for your
use.</p>
</div>
<div class="paragraph">
<p>Clicking on the link for the <strong>Demo Credential</strong> takes you to the
<strong>Details</strong> view of this Credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-home-with-demo-credential-details.png" alt="Credentials - home with demo credential details"></span></p>
</div>
<div class="paragraph">
<p>Clicking the <strong>Access</strong> tab shows you users and teams associated with this
Credential and their granted roles (owner, admin, auditor, etc.)</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-home-with-permissions-detail.png" alt="Credentials - home with permissions credential details"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>A credential with roles associated will retain them even after the
credential has been reassigned to another organization.</p>
</div>
<div class="paragraph">
<p>You can click the <strong>Add</strong> button to assign this <strong>Demo Credential</strong> to
additional users. If no users exist, add them from the <strong>Users</strong> menu and
refer to the <a href="#ug_users">[ug_users]</a> section for further detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="ug_credentials_add"><a class="anchor" href="#ug_credentials_add"></a>11.3. Add a New Credential</h3>
<div class="paragraph">
<p>To create a new credential:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button from the <strong>Credentials</strong> screen.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-credential.png" alt="Create credential"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the name for your new credential in the <strong>Name</strong> field.</p>
</li>
<li>
<p>Optionally enter a description and enter or select the name of the
organization with which the credential is associated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>A credential with a set of permissions associated with one organization
will remain even after the credential is reassigned to another
organization.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Enter or select the credential type you want to create.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-drop-down-menu.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Enter the appropriate details depending on the type of credential
selected, as described in the next section, <a href="#ug_credentials_cred_types">Credential Types</a>.</p>
</li>
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="ug_credentials_cred_types"><a class="anchor" href="#ug_credentials_cred_types"></a>11.4. Credential Types</h3>
<div class="paragraph">
<p>The following credential types are supported with the automation
controller:</p>
</div>
<div class="paragraph">
<p>The credential types associated with Centrify, CyberArk, HashiCorp
Vault, Microsoft Azure Key Management System (KMS), and Thycotic are
part of the credential plugins capability that allows an external system
to lookup your secrets information. See the <a href="#ug_credential_plugins">Secret Management System</a>
section for further detail.</p>
</div>
<div class="sect3">
<h4 id="ug_credentials_aws"><a class="anchor" href="#ug_credentials_aws"></a>11.4.1. Amazon Web Services</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of cloud
inventory with Amazon Web Services.</p>
</div>
<div class="paragraph">
<p>The automation controller uses the following environment variables for
AWS credentials and are fields prompted in the user interface:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AWS_ACCESS_KEY_ID
AWS_SECRET_ACCESS_KEY
AWS_SECURITY_TOKEN</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-aws-credential.png" alt="Credentials - create AWS credential"></span></p>
</div>
<div class="paragraph">
<p>Traditional Amazon Web Services credentials consist of the AWS <strong>Access
Key</strong> and <strong>Secret Key</strong>.</p>
</div>
<div class="paragraph">
<p>The automation controller provides support for EC2 STS tokens (sometimes
referred to as IAM STS credentials). Security Token Service (STS) is a
web service that enables you to request temporary, limited-privilege
credentials for AWS Identity and Access Management (IAM) users. To learn
more about the IAM/EC2 STS Token, refer to:
<a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html" class="bare">http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html</a></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If the value of your tags in EC2 contain booleans (yes/no/true/false),
you must remember to quote them.</p>
</div>
<div class="paragraph">
<p>Warning</p>
</div>
<div class="paragraph">
<p>To use implicit IAM role credentials, do not attach AWS cloud
credentials in the automation controller when relying on IAM roles to
access the AWS API. While it may seem to make sense to attach your AWS
cloud credential to your job template, doing so will force the use of
your AWS credentials and will not "fall through" to use your IAM role
credentials (this is due to the use of the boto library.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_ansible_galaxyautomation_hub_api_token"><a class="anchor" href="#_ansible_galaxyautomation_hub_api_token"></a>11.4.2. Ansible Galaxy/Automation Hub API Token</h4>
<div class="paragraph">
<p>Selecting this credential allows the automation controller to access
Galaxy or use a collection published on a local Automation Hub. See
<a href="#ug_collections_usage">Using Collections via Hub</a> for detail. Entering the Galaxy server URL is the
only required value on this screen.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-galaxy-credential.png" alt="Credentials - create galaxy credential"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_centrify_vault_credential_provider_lookup"><a class="anchor" href="#_centrify_vault_credential_provider_lookup"></a>11.4.3. Centrify Vault Credential Provider Lookup</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_centrify">Centrify Vault Credential Provider Lookup</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_registry"><a class="anchor" href="#_container_registry"></a>11.4.4. Container Registry</h4>
<div class="paragraph">
<p>Selecting this credential allows the automation controller to access a
collection of container images. See
<a href="https://www.redhat.com/en/topics/cloud-native-apps/what-is-a-container-registry">What
is a container registry?</a> for more information.</p>
</div>
<div class="paragraph">
<p>Aside from specifying a name, the <strong>Authentication URL</strong> is the only
required field on this screen, and it is already pre-populated with a
default value. You may change this default by specifying the
authentication endpoint for a different container registry.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-container-credential.png" alt="Credentials - create container credential"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_cyberark_aim_credential_provider_lookup"><a class="anchor" href="#_cyberark_aim_credential_provider_lookup"></a>11.4.5. CyberArk AIM Credential Provider Lookup</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_cyberarkaim">CyberArk AIM Credential Provider Lookup</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_cyberark_conjur_secret_lookup"><a class="anchor" href="#_cyberark_conjur_secret_lookup"></a>11.4.6. CyberArk Conjur Secret Lookup</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_cyberarkconjur">CyberArk Conjur Secret Lookup</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_github"><a class="anchor" href="#ug_credentials_github"></a>11.4.7. GitHub Personal Access Token</h4>
<div class="paragraph">
<p>Selecting this credential allows you to access GitHub using a Personal
Access Token (PAT), which is obtained through GitHub. See <a href="#ug_webhooks">[ug_webhooks]</a>
for detail. Entering the provided token is the only required value in
this screen.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-webhook-github-credential.png" alt="Credentials - create GitHub credential"></span></p>
</div>
<div class="paragraph">
<p>GitHub PAT credentials require a value in the <strong>Token</strong> field, which is
provided in your GitHub profile settings.</p>
</div>
<div class="paragraph">
<p>This credential can be used for establishing an API connection to GitHub
for use in webhook listener jobs, to post status updates.</p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_gitlab"><a class="anchor" href="#ug_credentials_gitlab"></a>11.4.8. GitLab Personal Access Token</h4>
<div class="paragraph">
<p>Selecting this credential allows you to access GitLab using a Personal
Access Token (PAT), which is obtained through GitLab. See <a href="#ug_webhooks">[ug_webhooks]</a>
for detail. Entering the provided token is the only required value in
this screen.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-webhook-gitlab-credential.png" alt="Credentials - create GitLab credential"></span></p>
</div>
<div class="paragraph">
<p>GitLab PAT credentials require a value in the <strong>Token</strong> field, which is
provided in your GitLab profile settings.</p>
</div>
<div class="paragraph">
<p>This credential can be used for establishing an API connection to GitLab
for use in webhook listener jobs, to post status updates.</p>
</div>
</div>
<div class="sect3">
<h4 id="_google_compute_engine"><a class="anchor" href="#_google_compute_engine"></a>11.4.9. Google Compute Engine</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of cloud
inventory with Google Compute Engine (GCE).</p>
</div>
<div class="paragraph">
<p>The automation controller uses the following environment variables for
GCE credentials and are fields prompted in the user interface:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GCE_EMAIL
GCE_PROJECT
GCE_CREDENTIALS_FILE_PATH</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-gce-credential.png" alt="Credentials - create GCE credential"></span></p>
</div>
<div class="paragraph">
<p>GCE credentials have the following inputs that are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Service Account Email Address</strong>: The email address assigned to the
Google Compute Engine <strong>service account</strong>.</p>
</li>
<li>
<p><strong>Project</strong>: Optionally provide the GCE assigned identification or the
unique project ID you provided at project creation time.</p>
</li>
<li>
<p><strong>Service Account JSON File</strong>: Optionally upload a GCE service account
file. Use the folder
(<span class="image"><img src="images/file-browser-button.png" alt="file-browser"></span>)
icon to browse for the file that contains the special account
information that can be used by services and applications running on
your GCE instance to interact with other Google Cloud Platform APIs.
This grants permissions to the service account and virtual machine
instances.</p>
</li>
<li>
<p><strong>RSA Private Key</strong>: The PEM file associated with the service account
email.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_hashicorp_vault_secret_lookup"><a class="anchor" href="#_hashicorp_vault_secret_lookup"></a>11.4.10. HashiCorp Vault Secret Lookup</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_hashivault">HashiCorp Vault Secret Lookup</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hashicorp_vault_signed_ssh"><a class="anchor" href="#_hashicorp_vault_signed_ssh"></a>11.4.11. HashiCorp Vault Signed SSH</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_hashivaultssh">HashiCorp Vault Signed SSH</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_insights"><a class="anchor" href="#_insights"></a>11.4.12. Insights</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of cloud
inventory with Red Hat Insights.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-insights-credential.png" alt="Credentials - create Insights credential"></span></p>
</div>
<div class="paragraph">
<p>Insights credentials consist of the Insights <strong>Username</strong> and <strong>Password</strong>,
which is the userâs Red Hat Customer Portal Account username and
password.</p>
</div>
</div>
<div class="sect3">
<h4 id="_machine"><a class="anchor" href="#_machine"></a>11.4.13. Machine</h4>
<div class="paragraph">
<p>Machine credentials enable the automation controller to invoke Ansible
on hosts under your management. Just like using Ansible on the command
line, you can specify the SSH username, optionally provide a password,
an SSH key, a key password, or even have the automation controller
prompt the user for their password at deployment time. They define ssh
and user-level privilege escalation access for playbooks, and are used
when submitting jobs to run playbooks on a remote host. Network
connections (<code>httpapi</code>, <code>netconf</code>, and <code>network_cli</code>) use <strong>Machine</strong> for
the credential type.</p>
</div>
<div class="paragraph">
<p>Machine/SSH credentials do not use environment variables. Instead, they
pass the username via the <code>ansible -u</code> flag, and interactively write the
SSH password when the underlying SSH client prompts for it.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-machine-credential.png" alt="Credentials - create machine credential"></span></p>
</div>
<div class="paragraph">
<p>Machine credentials have several attributes that may be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Username</strong>: The username to be used for SSH authentication.</p>
</li>
<li>
<p><strong>Password</strong>: The actual password to be used for SSH authentication.
This password will be stored encrypted in the database, if entered.
Alternatively, you can configure the automation controller to ask the
user for the password at launch time by selecting <strong>Prompt on launch</strong>. In
these cases, a dialog opens when the job is launched, promoting the user
to enter the password and password confirmation.</p>
</li>
<li>
<p><strong>SSH Private Key</strong>: Copy or drag-and-drop the SSH private key for the
machine credential.</p>
</li>
<li>
<p><strong>Private Key Passphrase</strong>: If the SSH Private Key used is protected by
a password, you can configure a Key Password for the private key. This
password will be stored encrypted in the database, if entered.
Alternatively, you can configure the automation controller to ask the
user for the password at launch time by selecting <strong>Prompt on launch</strong>. In
these cases, a dialog opens when the job is launched, prompting the user
to enter the password and password confirmation.</p>
</li>
<li>
<p><strong>Privilege Escalation Method</strong>: Specifies the type of escalation
privilege to assign to specific users. This is equivalent to specifying
the <code>--become-method=BECOME_METHOD</code> parameter, where <code>BECOME_METHOD</code>
could be any of the typical methods described below, or a custom method
you&#8217;ve written. Begin entering the name of the method, and the
appropriate name auto-populates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-machine-credential-priv-escalation.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>empty selection: If a task/play has <code>become</code> set to <code>yes</code> and is used
with an empty selection, then it will default to <code>sudo</code></p>
</li>
<li>
<p><strong>sudo</strong>: Performs single commands with super user (root user)
privileges</p>
</li>
<li>
<p><strong>su</strong>: Switches to the super user (root user) account (or to other user
accounts)</p>
</li>
<li>
<p><strong>pbrun</strong>: Requests that an application or command be run in a
controlled account and provides for advanced root privilege delegation
and keylogging</p>
</li>
<li>
<p><strong>pfexec</strong>: Executes commands with predefined process attributes, such
as specific user or group IDs</p>
</li>
<li>
<p><strong>dzdo</strong>: An enhanced version of sudo that uses RBAC information in an
Centrify&#8217;s Active Directory service (see Centrify&#8217;s
<a href="http://community.centrify.com/t5/Centrify-Server-Suite/FAQ-What-is-DirectAuthorize-dzdo-dzwin/td-p/21193">site
on DZDO</a>)</p>
</li>
<li>
<p><strong>pmrun</strong>: Requests that an application is run in a controlled account
(refer to
<a href="http://documents.software.dell.com/privilege-manager-for-unix/6.0/administrators-guide/privilege-manager-programs/pmrun">Privilege
Manager for Unix 6.0</a>)</p>
</li>
<li>
<p><strong>runas</strong>: Allows you to run as the current user</p>
</li>
<li>
<p><strong>enable</strong>: Switches to elevated permissions on a network device</p>
</li>
<li>
<p><strong>doas</strong>: Allows your remote/login user to execute commands as another
user via the doas ("Do as user") utility</p>
</li>
<li>
<p><strong>ksu</strong>: Allows your remote/login user to execute commands as another
user via Kerberos access</p>
</li>
<li>
<p><strong>machinectl</strong>: Allows you to manage containers via the systemd machine
manager</p>
</li>
<li>
<p><strong>sesu</strong>: Allows your remote/login user to execute commands as another
user via the CA Privileged Access Manager</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Custom <code>become</code> plugins are available only starting with Ansible 2.8.
For more detail on this concept, refer to <span class="title-ref">Und.adoc[]anding
Privilege Escalation
<a href="https://docs.ansible.com/ansible/latest/user_guide/become.html" class="bare">https://docs.ansible.com/ansible/latest/user_guide/become.html</a></span> and the
<span class="title-ref">list of become plugins
<a href="https://docs.ansible.com/ansible/latest/plugins/become.html#plugin-list" class="bare">https://docs.ansible.com/ansible/latest/plugins/become.html#plugin-list</a></span>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Privilege Escalation Username</strong> field is only seen if an option for
privilege escalation is selected. Enter the username to use with
escalation privileges on the remote system.</p>
</li>
<li>
<p><strong>Privilege Escalation Password</strong>: field is only seen if an option for
privilege escalation is selected. Enter the actual password to be used
to authenticate the user via the selected privilege escalation type on
the remote system. This password will be stored encrypted in the
database, if entered. Alternatively, you may configure the automation
controller to ask the user for the password at launch time by selecting
<strong>Prompt on launch</strong>. In these cases, a dialog opens when the job is
launched, promoting the user to enter the password and password
confirmation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Sudo Password must be used in combination with SSH passwords or SSH
Private Keys, since the automation controller must f.adoc[] establish an
authenticated SSH connection with the host prior to invoking sudo to
change to the sudo user.</p>
</div>
<div class="paragraph">
<p>Warning</p>
</div>
<div class="paragraph">
<p>Credentials which are used in <em>Scheduled Jobs</em> must not be configured as
"<strong>Prompt on launch</strong>".</p>
</div>
</div>
<div class="sect3">
<h4 id="_microsoft_azure_key_vault"><a class="anchor" href="#_microsoft_azure_key_vault"></a>11.4.14. Microsoft Azure Key Vault</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_azurekeyvault">Microsoft Azure Key Vault</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_microsoft_azure_resource_manager"><a class="anchor" href="#_microsoft_azure_resource_manager"></a>11.4.15. Microsoft Azure Resource Manager</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of cloud
inventory with Microsoft Azure Resource Manager.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-azure-credential.png" alt="Credentials - create Azure credential"></span></p>
</div>
<div class="paragraph">
<p>Microsoft Azure Resource Manager credentials have several attributes
that may be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Subscription ID</strong>: The Subscription UUID for the Microsoft Azure
account (required).</p>
</li>
<li>
<p><strong>Username</strong>: The username to use to connect to the Microsoft Azure
account.</p>
</li>
<li>
<p><strong>Password</strong>: The password to use to connect to the Microsoft Azure
account.</p>
</li>
<li>
<p><strong>Client ID</strong>: The Client ID for the Microsoft Azure account.</p>
</li>
<li>
<p><strong>Client Secret</strong>: The Client Secret for the Microsoft Azure account.</p>
</li>
<li>
<p><strong>Tenant ID</strong>: The Tenant ID for the Microsoft Azure account.</p>
</li>
<li>
<p><strong>Azure Cloud Environment</strong>: The variable associated with Azure cloud or
Azure stack environments.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These fields are equivalent to the variables in the API. To pass service
principal credentials, define the following variables:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AZURE_CLIENT_ID
AZURE_SECRET
AZURE_SUBSCRIPTION_ID
AZURE_TENANT
AZURE_CLOUD_ENVIRONMENT</pre>
</div>
</div>
<div class="paragraph">
<p>To pass an Active Directory username/password pair, define the following
variables:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AZURE_AD_USER
AZURE_PASSWORD
AZURE_SUBSCRIPTION_ID</pre>
</div>
</div>
<div class="paragraph">
<p>You can also pass credentials as parameters to a task within a playbook.
The order of precedence is parameters, then environment variables, and
finally a file found in your home directory.</p>
</div>
<div class="paragraph">
<p>To pass credentials as parameters to a task, use the following
parameters for service principal credentials:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>client_id
secret
subscription_id
tenant
azure_cloud_environment</pre>
</div>
</div>
<div class="paragraph">
<p>Or, pass the following parameters for Active Directory
username/password:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ad_user
password
subscription_id</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_network"><a class="anchor" href="#_network"></a>11.4.16. Network</h4>
<div class="paragraph">
<p>Select the Network credential type <strong>only</strong> if you are using a
<span class="title-ref">local</span> connection with <span class="title-ref">provider</span> to use
Ansible networking modules to connect to and manage networking devices.
When connecting to network devices, the credential type must match the
connection type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>local</code> connections using <code>provider</code>, credential type should be
<strong>Network</strong></p>
</li>
<li>
<p>For all other network connections (<code>httpapi</code>, <code>netconf</code>, and
<code>network_cli</code>), credential type should be <strong>Machine</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For an overview of connection types available for network devices, refer
to <a href="">Multiple Communication Protocols</a>.</p>
</div>
<div class="paragraph">
<p>The automation controller uses the following environment variables for
Network credentials and are fields prompted in the user interface:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ANSIBLE_NET_USERNAME
ANSIBLE_NET_PASSWORD</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-network-credential.png" alt="Credentials - create network credential"></span></p>
</div>
<div class="paragraph">
<p>Network credentials have several attributes that may be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Username</strong>: The username to use in conjunction with the network device
(required).</p>
</li>
<li>
<p><strong>Password</strong>: The password to use in conjunction with the network
device.</p>
</li>
<li>
<p><strong>SSH Private Key</strong>: Copy or drag-and-drop the actual SSH Private Key to
be used to authenticate the user to the network via SSH.</p>
</li>
<li>
<p><strong>Private Key Passphrase</strong>: The actual passphrase for the private key to
be used to authenticate the user to the network via SSH.</p>
</li>
<li>
<p><strong>Authorize</strong>: Select this from the Options field to control whether or
not to enter privileged mode.</p>
</li>
<li>
<p>If <strong>Authorize</strong> is checked, enter a password in the <strong>Authorize
Password</strong> field to access privileged mode.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information, refer to the <em>Inside Playbook</em> blog,
<a href="https://www.ansible.com/blog/porting-ansible-network-playbooks-with-new-connection-plugins">Porting
Ansible Network Playbooks with New Connection Plugins</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_ocp_k8s"><a class="anchor" href="#ug_credentials_ocp_k8s"></a>11.4.17. OpenShift or Kubernetes API Bearer Token</h4>
<div class="paragraph">
<p>Selecting this credential type allows you to create instance groups that
point to a Kubernetes or OpenShift container. For more information about
this concept, refer to <a href="#ag_ext_exe_env">[ag_ext_exe_env]</a>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-containers-credential.png" alt="Credentials - create Containers credential"></span></p>
</div>
<div class="paragraph">
<p>Container credentials have the following inputs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpenShift or Kubernetes API Endpoint</strong> (required): the endpoint to be
used to connect to an OpenShift or Kubernetes container</p>
</li>
<li>
<p><strong>API Authentication Bearer Token</strong> (required): The token to use to
authenticate the connection</p>
</li>
<li>
<p><strong>Verify SSL</strong>: Optionally you can check this option to verify the
serverâs SSL certificate is valid and trusted. Environments that use
internal or private CAâs should leave this option unchecked to disable
verification.</p>
</li>
<li>
<p><strong>Certificate Authority Data</strong>: include the <code>BEGIN CERTIFICATE</code> and
<code>END CERTIFICATE</code> lines when pasting the certificate, if provided</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>ContainerGroup</code> is a type of <code>InstanceGroup</code> that has an associated
Credential that allows for connecting to an OpenShift cluster. To set up
a container group, you must first have the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A namespace you can launch into (every cluster has a âdefaultâ
namespace, but you may want to use a specific namespace)</p>
</li>
<li>
<p>A service account that has the roles that allow it to launch and
manage Pods in this namespace</p>
</li>
<li>
<p>If you will be using execution environments in a private registry, and
have a Container Registry credential associated to them in the
automation controller, the service account also needs the roles to get,
create, and delete secrets in the namespace. If you do not want to give
these roles to the service account, you can pre-create the
<code>ImagePullSecrets</code> and specify them on the pod spec for the
ContainerGroup. In this case, the execution environment should NOT have
a Container Registry credential associated, or the controller will
attempt to create the secret for you in the namespace.</p>
</li>
<li>
<p>A token associated with that service account (OpenShift or Kubernetes
Bearer Token)</p>
</li>
<li>
<p>A CA certificate associated with the cluster</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section describes creating a Service Account in an Openshift
cluster (or K8s) in order to be used to run jobs in a container group
via automation controller. After the Service Account is created, its
credentials are provided to the controller in the form of an Openshift
or Kubernetes API bearer token credential. Below describes how to create
a service account and collect the needed information for configuring
automation controller.</p>
</div>
<div class="paragraph">
<p>To configure the controller:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To create a service account, you may download and use this sample
service account,
<code>containergroup sa &lt;../../common/source/containergroup-sa.yml&gt;</code> and
modify it as needed to obtain the above credentials.</p>
</li>
<li>
<p>Apply the configuration from <code>containergroup-sa.yml</code>:</p>
<div class="literalblock">
<div class="content">
<pre>oc apply -f containergroup-sa.yml</pre>
</div>
</div>
</li>
<li>
<p>Get the secret name associated with the service account:</p>
<div class="literalblock">
<div class="content">
<pre>export SA_SECRET=$(oc get sa containergroup-service-account -o json | jq '.secrets[0].name' | tr -d '"')</pre>
</div>
</div>
</li>
<li>
<p>Get the token from the secret:</p>
<div class="literalblock">
<div class="content">
<pre>oc get secret $(echo ${SA_SECRET}) -o json | jq '.data.token' | xargs | base64 --decode &gt; containergroup-sa.token</pre>
</div>
</div>
</li>
<li>
<p>Get the CA cert:</p>
<div class="literalblock">
<div class="content">
<pre>oc get secret $SA_SECRET -o json | jq '.data["ca.crt"]' | xargs | base64 --decode &gt; containergroup-ca.crt</pre>
</div>
</div>
</li>
<li>
<p>Use the contents of <code>containergroup-sa.token</code> and
<code>containergroup-ca.crt</code> to provide the information for the
<a href="#ug_credentials_ocp_k8s">OpenShift or Kubernetes API Bearer Token</a> required for the container group.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_openstack"><a class="anchor" href="#_openstack"></a>11.4.18. OpenStack</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of cloud
inventory with OpenStack.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-openstack-credential.png" alt="Credentials - create OpenStack credential"></span></p>
</div>
<div class="paragraph">
<p>OpenStack credentials have the following inputs that are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Username</strong>: The username to use to connect to OpenStack.</p>
</li>
<li>
<p><strong>Password (API Key)</strong>: The password or API key to use to connect to
OpenStack.</p>
</li>
<li>
<p><strong>Host (Authentication URL)</strong>: The host to be used for authentication.</p>
</li>
<li>
<p><strong>Project (Tenant Name)</strong>: The Tenant name or Tenant ID used for
OpenStack. This value is usually the same as the username.</p>
</li>
<li>
<p><strong>Project (Domain Name)</strong>: Optionally provide the project name
associated with your domain.</p>
</li>
<li>
<p><strong>Domain name</strong>: Optionally provide the FQDN to be used to connect to
OpenStack.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are interested in using OpenStack Cloud Credentials, refer to
<a href="#ug_CloudCredentials">Utilizing Cloud Credentials</a> in this guide for more information, including a
sample playbook.</p>
</div>
</div>
<div class="sect3">
<h4 id="_red_hat_ansible_automation_platform"><a class="anchor" href="#_red_hat_ansible_automation_platform"></a>11.4.19. Red Hat Ansible Automation Platform</h4>
<div class="paragraph">
<p>Selecting this credential allows you to access another automation
controller instance.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-at-credential.png" alt="Credentials - create tower credential"></span></p>
</div>
<div class="paragraph">
<p>Automation controller credentials have the following inputs that are
required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Controller Hostname</strong>: The base URL or IP address of the other
instance to connect to.</p>
</li>
<li>
<p><strong>Username</strong>: The username to use to connect to it.</p>
</li>
<li>
<p><strong>Password</strong>: The password to use to connect to it.</p>
</li>
<li>
<p><strong>Oauth Token</strong>: If username and password is not used, provide an OAuth
token to use to authenticate.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_red_hat_satellite_6"><a class="anchor" href="#_red_hat_satellite_6"></a>11.4.20. Red Hat Satellite 6</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of cloud
inventory with Red Hat Satellite 6.</p>
</div>
<div class="paragraph">
<p>The automation controller writes a Satellite configuration file based on
fields prompted in the user interface. The absolute path to the file is
set in the following environment variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FOREMAN_INI_PATH</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-rh-sat-credential.png" alt="Credentials - create Red Hat Satellite 6 credential"></span></p>
</div>
<div class="paragraph">
<p>Satellite credentials have the following inputs that are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Satellite 6 URL</strong>: The Satellite 6 URL or IP address to connect to.</p>
</li>
<li>
<p><strong>Username</strong>: The username to use to connect to Satellite 6.</p>
</li>
<li>
<p><strong>Password</strong>: The password to use to connect to Satellite 6.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_red_hat_virtualization"><a class="anchor" href="#_red_hat_virtualization"></a>11.4.21. Red Hat Virtualization</h4>
<div class="paragraph">
<p>This credential allows the automation controller to access Ansible&#8217;s
<code>oVirt4.py</code> dynamic inventory plugin, which is managed by Red Hat
Virtualization (RHV).</p>
</div>
<div class="paragraph">
<p>The automation controller uses the following environment variables for
Red Hat Virtualization credentials and are fields in the user interface:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>OVIRT_URL
OVIRT_USERNAME
OVIRT_PASSWORD</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-rhv-credential.png" alt="Credentials - create rhv credential"></span></p>
</div>
<div class="paragraph">
<p>RHV credentials have the following inputs that are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Host (Authentication URL)</strong>: The host URL or IP address to connect to.
In order to sync with the inventory, the credential URL needs to include
the <code>ovirt-engine/api</code> path.</p>
</li>
<li>
<p><strong>Username</strong>: The username to use to connect to oVirt4. This needs to
include the domain profile to succeed, for example
<code>username@ovirt.host.com</code>.</p>
</li>
<li>
<p><strong>Password</strong>: The password to use to connect to it.</p>
</li>
<li>
<p><strong>CA File</strong>: Optionally provide an absolute path to the oVirt
certificate file (it may end in <code>.pem</code>, <code>.cer</code> and <code>.crt</code> extensions,
but preferably <code>.pem</code> for consistency)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_source_control"><a class="anchor" href="#_source_control"></a>11.4.22. Source Control</h4>
<div class="paragraph">
<p>SCM (source control) credentials are used with Projects to clone and
update local source code repositories from a remote revision control
system such as Git or Subversion.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-scm-credential.png" alt="Credentials - create SCM credential"></span></p>
</div>
<div class="paragraph">
<p>Source Control credentials have several attributes that may be
configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Username</strong>: The username to use in conjunction with the source control
system.</p>
</li>
<li>
<p><strong>Password</strong>: The password to use in conjunction with the source control
system.</p>
</li>
<li>
<p><strong>SCM Private Key</strong>: Copy or drag-and-drop the actual SSH Private Key to
be used to authenticate the user to the source control system via SSH.</p>
</li>
<li>
<p><strong>Private Key Passphrase</strong>: If the SSH Private Key used is protected by
a passphrase, you may configure a Key Passphrase for the private key.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Source Control credentials cannot be configured as "<strong>Prompt on launch</strong>".
If you are using a GitHub account for a Source Control credential and
you have 2FA (Two Factor Authenication) enabled on your account, you
will need to use your Personal Access Token in the password field rather
than your account password.</p>
</div>
</div>
<div class="sect3">
<h4 id="_thycotic_devops_secrets_vault"><a class="anchor" href="#_thycotic_devops_secrets_vault"></a>11.4.23. Thycotic DevOps Secrets Vault</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_thycoticvault">Thycotic DevOps Secrets Vault</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_thycotic_secret_server"><a class="anchor" href="#_thycotic_secret_server"></a>11.4.24. Thycotic Secret Server</h4>
<div class="paragraph">
<p>This is considered part of the secret management capability. See
<a href="#ug_credentials_thycoticserver">Thycotic Secret Server</a> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vault"><a class="anchor" href="#_vault"></a>11.4.25. Vault</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of inventory with
Ansible Vault.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-vault-credential.png" alt="Credentials - create Vault credential"></span></p>
</div>
<div class="paragraph">
<p>Vault credentials require the <strong>Vault Password</strong> and an optional <strong>Vault
Identifier</strong> if applying multi-Vault credentialing. For more information
on the automation controller Multi-Vault support, refer to the
<a href="#ag_multi_vault">[ag_multi_vault]</a> section of the Automation Controller Administration
Guide.</p>
</div>
<div class="paragraph">
<p>You may configure the automation controller to ask the user for the
password at launch time by selecting <strong>Prompt on launch</strong>. In these cases,
a dialog opens when the job is launched, promoting the user to enter the
password and password confirmation.</p>
</div>
<div class="paragraph">
<p>Warning</p>
</div>
<div class="paragraph">
<p>Credentials which are used in <em>Scheduled Jobs</em> must not be configured as
"<strong>Prompt on launch</strong>".</p>
</div>
<div class="paragraph">
<p>For more information about Ansible Vault, refer to:
<a href="http://docs.ansible.com/ansible/playbooks_vault.html" class="bare">http://docs.ansible.com/ansible/playbooks_vault.html</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_vmware_vcenter"><a class="anchor" href="#_vmware_vcenter"></a>11.4.26. VMware vCenter</h4>
<div class="paragraph">
<p>Selecting this credential type enables synchronization of inventory with
VMware vCenter.</p>
</div>
<div class="paragraph">
<p>The automation controller uses the following environment variables for
VMware vCenter credentials and are fields prompted in the user
interface:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>VMWARE_HOST
VMWARE_USER
VMWARE_PASSWORD
VMWARE_VALIDATE_CERTS</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-vmware-credential.png" alt="Credentials - create VMware credential"></span></p>
</div>
<div class="paragraph">
<p>VMware credentials have the following inputs that are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>vCenter Host</strong>: The vCenter hostname or IP address to connect to.</p>
</li>
<li>
<p><strong>Username</strong>: The username to use to connect to vCenter.</p>
</li>
<li>
<p><strong>Password</strong>: The password to use to connect to vCenter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If the VMware guest tools are not running on the instance, VMware
inventory sync may not return an IP address for that instance.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_credential_types"><a class="anchor" href="#ug_credential_types"></a>12. Custom Credential Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an administrator with superuser access, you can define a custom
credential type in a standard format using a YAML/JSON-like definition,
allowing the assignment of new credential types to jobs and inventory
updates. This allows you to define a custom credential type that works
in ways similar to existing credential types. For example, you could
create a custom credential type that injects an API token for a
third-party web service into an environment variable, which your
playbook or custom inventory script could consume.</p>
</div>
<div class="paragraph">
<p>Custom credentials support the following ways of injecting their
authentication information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Environment variables</p>
</li>
<li>
<p>Ansible extra variables</p>
</li>
<li>
<p>File-based templating (i.e., generating <code>.ini</code> or <code>.conf</code> files that
contain credential values)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can attach one SSH and multiple cloud credentials to a Job Template.
Each cloud credential must be of a different type. In other words, only
one AWS credential, one GCE credential, etc., are allowed. Vault
credentials and machine credentials are separate entities.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>When creating a new credential type, you are responsible for avoiding
collisions in the <code>extra_vars</code>, <code>env</code>, and file namespaces. Also, avoid
environment variable or extra variable names that start with <code>ANSIBLE_</code>
because they are reserved. You must have Superuser permissions to be
able to create and edit a credential type (<code>CredentialType</code>) and to be
able to view the <code>CredentialType.injection</code> field.</p>
</div>
<div class="sect2">
<h3 id="_content_sourcing_from_collections"><a class="anchor" href="#_content_sourcing_from_collections"></a>12.1. Content sourcing from collections</h3>
<div class="paragraph">
<p>A "managed" credential type of <code>kind=galaxy</code> represents a content source
for fetching collections defined in <code>requirements.yml</code> when project
updates are run (e.g., galaxy.ansible.com, cloud.redhat.com, on-premise
Automation Hub). This new type will represent a URL and (optional)
authentication details necessary to construct the environment variables
when a project update runs <code>ansible-galaxy collection install</code> as
described in the Ansible documentation,
<a href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#configuring-the-ansible-galaxy-client">Configuring
the ansible-galaxy client</a>. It has fields which map directly to the
configuration options exposed to the Ansible Galaxy CLI, e.g.,
per-server. An endpoint in the API reflects an ordered list of these
credentials at the Organization level:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/api/v2/organizations/N/galaxy_credentials/</pre>
</div>
</div>
<div class="paragraph">
<p>Installations of the automation controller migrates existing
Galaxy-oriented setting values in such a way that post-upgrade, proper
credentials are created and attached to every Organization. After
upgrading to the latest version , every organization that existed prior
to upgrade now has a list of (one or more) "Galaxy" credentials
associated with it.</p>
</div>
<div class="paragraph">
<p>Additionally, post-upgrade, these settings are not be visible (or
editable) from the <code>/api/v2/settings/jobs/</code> endpoint.</p>
</div>
<div class="paragraph">
<p>The automation controller should still continue to fetch roles directly
from public Galaxy even if galaxy.ansible.com is not the first
credential in the list for the Organization. The global "Galaxy"
settings are no longer configured at the jobs level, but at the
Organization level in the User Interface. The Organization&#8217;s Add and
Edit windows have an optional <strong>Credential</strong> lookup field for credentials
of <code>kind=galaxy</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-galaxy-credentials.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>It is very important to specify the order of these credentials as order
sets precedence for the sync and lookup of the content. For more
information, see <a href="#ug_organizations_create">Creating a New Organization</a>. For detail on how to set up
a project using collections, see <a href="#ug_collections_usage">Using Collections via Hub</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_backwards_compatible_api_considerations"><a class="anchor" href="#_backwards_compatible_api_considerations"></a>12.2. Backwards-Compatible API Considerations</h3>
<div class="paragraph">
<p>Support for version 2 of the API (<code>api/v2/</code>) means a one-to-many
relationship for Job Templates to credentials (including multi-cloud
support). Credentials can be filtered using the v2 API:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ curl "https://controller.example.org/api/v2/credentials/?credential_type__namespace=aws"</pre>
</div>
</div>
<div class="paragraph">
<p>In the V2 CredentialType model, the relationships are defined as
follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 85%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets environment variables (e.g., <code>ANSIBLE_NET_AUTHORIZE</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source Control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EC2, AWS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lots of others</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Insights</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Insights</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Galaxy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">galaxy.ansible.com, cloud.redhat.com</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">on-premise Automation Hub</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_getting_started_with_credential_types"><a class="anchor" href="#_getting_started_with_credential_types"></a>12.3. Getting Started with Credential Types</h3>
<div class="paragraph">
<p>Access the Credentials from clicking <strong>Credential Types</strong> from the left
navigation bar. If no custom credential types have been created, the
Credential Types view will not have any to display and will prompt you
to add one:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-home-empty.png" alt="Credential Types - home empty"></span></p>
</div>
<div class="paragraph">
<p>If credential types have been created, this page displays a list of all
existing and available Credential Types.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-home-with-example-types.png" alt="Credential Types - home with example credential types"></span></p>
</div>
<div class="paragraph">
<p>To view more information about a credential type, click on its name or
the Edit (<span class="image"><img src="images/edit-button.png" alt="edit"></span>) button
from the <strong>Actions</strong> column.</p>
</div>
<div class="paragraph">
<p>Each credential type displays its own unique configurations in the
<strong>Input Configuration</strong> field and the <strong>Injector Configuration</strong> field, if
applicable. Both YAML and JSON formats are supported in the
configuration fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_new_credential_type"><a class="anchor" href="#_create_a_new_credential_type"></a>12.4. Create a New Credential Type</h3>
<div class="paragraph">
<p>To create a new credential type:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button in the <strong>Credential Types</strong> screen.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-create-new.png" alt="Create new credential type"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details in the <strong>Name</strong> and <strong>Description</strong> field.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>When creating a new credential type, do not use reserved variable names
that start with <code>ANSIBLE_</code> for the <strong>INPUT</strong> and <strong>INJECTOR</strong> names and IDs,
as they are invalid for custom credential types.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the <strong>Input Configuration</strong> field, specify an input schema which
defines a set of ordered fields for that type. The format can be in YAML
or JSON, as shown:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>YAML</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>fields:
  - type: string
    id: username
    label: Username
  - type: string
    id: password
    label: Password
    secret: true
required:
  - username
  - password</pre>
</div>
</div>
<div class="paragraph">
<p>View more YAML examples at <a href="http://www.yaml.org/start.html" class="bare">http://www.yaml.org/start.html</a>.</p>
</div>
<div class="paragraph">
<p><strong>JSON</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
"fields": [
  {
  "type": "string",
  "id": "username",
  "label": "Username"
  },
  {
  "secret": true,
  "type": "string",
  "id": "password",
  "label": "Password"
   }
  ],
 "required": ["username", "password"]
}</pre>
</div>
</div>
<div class="paragraph">
<p>View more JSON examples at www.json.org.</p>
</div>
<div class="paragraph">
<p>The configuration in JSON format below show each field and how they are
used:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "fields": [{
    "id": "api_token",               # required - a unique name used to
                                     # reference the field value

    "label": "API Token",            # required - a unique label for the
                                     # field

    "help_text": "User-facing short text describing the field.",

    "type": ("string" | "boolean")   # defaults to 'string'

    "choices": ["A", "B", "C"]       # (only applicable to `type=string`)

    "format": "ssh_private_key"      # optional, can be used to enforce data
                                     # format validity for SSH private key
                                     # data (only applicable to `type=string`)

    "secret": true,                  # if true, the field value will be encrypted

    "multiline": false               # if true, the field should be rendered
                                     # as multi-line for input entry
                                     # (only applicable to `type=string`)
},{
    # field 2...
},{
    # field 3...
}],

"required": ["api_token"]            # optional; one or more fields can be marked as required
},</pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>When <code>type=string</code>, fields can optionally specify multiple choice
options:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="literalblock">
<div class="content">
<pre>{
  "fields": [{
      "id": "api_token",          # required - a unique name used to reference the field value
      "label": "API Token",       # required - a unique label for the field
      "type": "string",
      "choices": ["A", "B", "C"]
  }]
},</pre>
</div>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>In the <strong>Injector Configuration</strong> field, enter environment variables or
extra variables that specify the values a credential type can inject.
The format can be in YAML or JSON (see examples in the previous step).
The configuration in JSON format below show each field and how they are
used:</p>
</li>
</ol>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "file": {
      "template": "[mycloud]\ntoken={{ api_token }}"
  },
  "env": {
      "THIRD_PARTY_CLOUD_API_TOKEN": "{{ api_token }}"
  },
  "extra_vars": {
      "some_extra_var": "{{ username }}:{{ password }}"
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Credential Types can also generate temporary files to support .ini files
or certificate/key data:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "file": {
      "template": "[mycloud]\ntoken={{ api_token }}"
  },
  "env": {
      "MY_CLOUD_INI_FILE": "{{ tower.filename }}"
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the automation controller will write a temporary file
that contains:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[mycloud]\ntoken=SOME_TOKEN_VALUE</pre>
</div>
</div>
<div class="paragraph">
<p>The absolute file path to the generated file will be stored in an
environment variable named <code>MY_CLOUD_INI_FILE</code>.</p>
</div>
<div class="paragraph">
<p>An example of referencing multiple files in a custom credential template
is as follows:</p>
</div>
<div class="paragraph">
<p><strong>Inputs</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "fields": [{
    "id": "cert",
    "label": "Certificate",
    "type": "string"
  },{
    "id": "key",
    "label": "Key",
    "type": "string"
  }]
}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Injectors</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "file": {
    "template.cert_file": "[mycert]\n{{ cert }}",
    "template.key_file": "[mykey]\n{{ key }}"
},
"env": {
    "MY_CERT_INI_FILE": "{{ tower.filename.cert_file }}",
    "MY_KEY_INI_FILE": "{{ tower.filename.key_file }}"
}</pre>
</div>
</div>
<div class="paragraph">
<p>_
}
_</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
<li>
<p>Scroll down to the bottom of the screen and your newly created
credential type appears on the list of credential types:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-new-listed.png" alt="New credential type"></span></p>
</div>
<div class="paragraph">
<p>Click <span class="image"><img src="images/edit-button.png" alt="edit"></span> to modify
the credential type options under the Actions column.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>In the Edit screen, you can modify the details or delete the credential.
If the <strong>Delete</strong> button is grayed out, it is indication that the
credential type that is being used by a credential, and you must delete
the credential type from all the credentials that use it before you can
delete it. Below is an example of such a message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-delete-confirmation.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Verify that the newly created credential type can be selected from the
<strong>Credential Type</strong> selection window when creating a new credential:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credential-types-new-listed-verify.png" alt="Verify new credential type"></span></p>
</div>
<div class="paragraph">
<p>For details on how to create a new credential, see <a href="#ug_credentials">Credentials</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_credential_plugins"><a class="anchor" href="#ug_credential_plugins"></a>13. Secret Management System</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Users and admins upload machine and cloud credentials so that automation
can access machines and external services on their behalf. By default,
sensitive credential values (such as SSH passwords, SSH private keys,
API tokens for cloud services) are stored in the database after being
encrypted. With external credentials backed by credential plugins, you
can map credential fields (like a password or an SSH Private key) to
values stored in a <code>secret management system</code> instead of providing them
to the controller directly. automation controller provides a secret
management system that include integrations for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Centrify Vault Credential Provider Lookup</p>
</li>
<li>
<p>CyberArk Application Identity Manager (AIM)</p>
</li>
<li>
<p>CyberArk Conjur</p>
</li>
<li>
<p>HashiCorp Vault Key-Value Store (KV)</p>
</li>
<li>
<p>HashiCorp Vault SSH Secrets Engine</p>
</li>
<li>
<p>Microsoft Azure Key Management System (KMS)</p>
</li>
<li>
<p>Thycotic DevOps Secrets Vault</p>
</li>
<li>
<p>Thycotic Secret Server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These external secret values will be fetched prior to running a playbook
that needs them. For more information on specifying these credentials in
the User Interface, see <a href="#ug_credentials">Credentials</a>.</p>
</div>
<div class="sect2">
<h3 id="_configure_and_link_secret_lookups"><a class="anchor" href="#_configure_and_link_secret_lookups"></a>13.1. Configure and link secret lookups</h3>
<div class="paragraph">
<p>When configuring automation controller to pull a secret from a 3rd-party
system, it is in essence linking credential fields to external systems.
To link a credential field to a value stored in an external system,
select the external credential corresponding to that system and provide
<code>metadata</code> to look up the desired value. The metadata input fields are
part of the <code>external credential type</code> definition of the
<code>source credential</code>.</p>
</div>
<div class="paragraph">
<p>Automation controller provides a <code>credential plugin</code> interface for
developers, integrators, admins, and power-users with the ability to add
new external credential types to extend it to support other secret
management systems. For more detail, see the
<a href="https://github.com/ansible/awx/blob/devel/docs/credentials/credential_plugins.md">development
docs for credential plugins</a>.</p>
</div>
<div class="paragraph">
<p>Use the automation controller User Interface to configure and use each
of the supported 3-party secret management systems.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, create an external credential for authenticating with the
secret management system. At minimum, provide a name for the external
credential and select one of the following for the <strong>Credential Type</strong>:</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Navigate to the credential form of the target credential and link one
or more input fields to the external credential along with metadata for
locating the secret in the external system. In this example, the <em>Demo
Credential</em> is the target credential.</p>
</li>
</ol>
</div>
<div id="ag_credential_plugins_link_step" class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>For any of the fields below the <strong>Type Details</strong> area that you want to
link to the external credential, click the
<span class="image"><img src="images/key-mgmt-button.png" alt="key"></span> button of the
input field. You are prompted to set the input source to use to retrieve
your secret information.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-link-credential-prompt.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Select the credential you want to link to, and click <strong>Next</strong>. This
takes you to the <strong>Metadata</strong> tab of the input source. This example shows
the Metadata prompt for HashiVault Secret Lookup. Metadata is specific
to the input source you select. See the <em>Metadata for credential input
sources</em> table for details.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-link-metadata-prompt.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click <strong>Test</strong> to verify connection to the secret management system. If
the lookup is unsuccessful, an error message like this one displays:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-link-metadata-test-error.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>When done, click <strong>OK</strong>. This closes the prompt window and returns you
to the Details screen of your target credential. <strong>Repeat these steps</strong>,
starting with <code>step 3 above &lt;ag_credential_plugins_link_step&gt;</code> to
complete the remaining input fields for the target credential. By
linking the information in this manner, automation controller retrieves
sensitive information, such as username, password, keys, certificates,
and tokens from the 3rd-party management systems and populates that data
into the remaining fields of the target credential form.</p>
</li>
<li>
<p>If necessary, supply any information manually for those fields that do
not use linking as a way of retrieving sensitive information. Refer to
the appropriate <a href="#ug_credentials_cred_types">Credential Types</a> for more detail about each
of the fields.</p>
</li>
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_metadata_for_credential_input_sources"><a class="anchor" href="#_metadata_for_credential_input_sources"></a>13.1.1. Metadata for credential input sources</h4>
<div class="paragraph">
<p><strong>Centrify Vault Credential Provider Lookup</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account Name (Required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the system account or domain
associated with Centrify Vault.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the name used by the Centrify portal.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>CyberArk AIM</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object Query (Required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lookup query for the object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object Query Format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select <code>Exact</code> for a specific secret name, or
<code>Regexp</code> for a secret that has a dynamically generated name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reason</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If required per the object&#8217;s policy, supply a reason for
checking out the secret, as CyberArk logs those.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>CyberArk Conjur</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The identifier for the secret.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify a version of the secret, if necessary,
otherwise, leave it empty to use the latest version.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>HashiVault Secret Lookup</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of Secret Backend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the name of the KV backend to use.
Leave it blank to use the first path segment of the <strong>Path to Secret</strong>
field instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to Secret (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the path to where the secret
information is stored; for example, <code>/path/username</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Name (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the name of the key to look up the secret
information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Version (V2 Only)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify a version if necessary, otherwise,
leave it empty to use the latest version.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>HashiCorp Signed SSH</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsigned Public Key (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the public key of the cert you
want to get signed. It needs to be present in the authorized keys file
of the target host(s).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to Secret (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the path to where the secret
information is stored; for example, <code>/path/username</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role Name (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A role is a collection of SSH settings and
parameters that are stored in Hashi vault. Typically, you can specify a
couple of them with different privileges, timeouts, etc. So you could
have a role that is allowed to get a cert signed for root, and other
less privileged ones, for example.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid Principals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify a user (or users) other than the default,
that you are requesting vault to authorize the cert for the stored key.
Hashi vault has a default user for whom it signs (e.g., ec2-user).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Azure KMS</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Name (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actual name of the secret as it is
referenced in Azure&#8217;s Key vault app.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify a version of the secret, if necessary,
otherwise, leave it empty to use the latest version.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Thycotic DevOps Secrets Vault</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Path (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the path to where the secret
information is stored (e.g., /path/username).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Thycotic Secret Server</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret ID (required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The identifier for the secret.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the field to be used from the secret.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="ug_credentials_centrify"><a class="anchor" href="#ug_credentials_centrify"></a>13.1.2. Centrify Vault Credential Provider Lookup</h4>
<div class="paragraph">
<p>You need the Centrify Vault web service running to store secrets in
order for this integration to work. When <strong>Centrify Vault Credential
Provider Lookup</strong> is selected for <strong>Credential Type</strong>, provide the
following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Centrify Tenant URL</strong> (required): provide the URL used for
communicating with Centrify&#8217;s secret management system</p>
</li>
<li>
<p><strong>Centrify API User</strong> (required): provide the username</p>
</li>
<li>
<p><strong>Centrify API Password</strong> (required): provide the password</p>
</li>
<li>
<p><strong>OAuth2 Application ID</strong> : specify the identifier given associated with
the OAuth2 client</p>
</li>
<li>
<p><strong>OAuth2 Scope</strong> : specify the scope of the OAuth2 client</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below shows an example of a configured CyberArk AIM credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-centrify-vault-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_cyberarkaim"><a class="anchor" href="#ug_credentials_cyberarkaim"></a>13.1.3. CyberArk AIM Credential Provider Lookup</h4>
<div class="paragraph">
<p>You need the CyberArk Central Credential Provider web service running to
store secrets in order for this integration to work. When <strong>CyberArk AIM
Credential Provider Lookup</strong> is selected for <strong>Credential Type</strong>, provide
the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CyberArk AIM URL</strong> (required): provide the URL used for communicating
with CyberArk AIM&#8217;s secret management system</p>
</li>
<li>
<p><strong>Application ID</strong> (required): specify the identifier given by CyberArk
AIM services</p>
</li>
<li>
<p><strong>Client Key</strong>: paste the client key if provided by CyberArk</p>
</li>
<li>
<p><strong>Client Certificate</strong>: include the <code>BEGIN CERTIFICATE</code> and
<code>END CERTIFICATE</code> lines when pasting the certificate, if provided by
CyberArk</p>
</li>
<li>
<p><strong>Verify SSL Certificates</strong>: this option is only available when the URL
uses HTTPS. Check this option to verify the serverâs SSL certificate is
valid and trusted. Environments that use internal or private CA&#8217;s should
leave this option unchecked to disable verification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below shows an example of a configured CyberArk AIM credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-cyberark-aim-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_cyberarkconjur"><a class="anchor" href="#ug_credentials_cyberarkconjur"></a>13.1.4. CyberArk Conjur Secret Lookup</h4>
<div class="paragraph">
<p>When <strong>CyberArk Conjur Secret Lookup</strong> is selected for <strong>Credential Type</strong>,
provide the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Conjur URL</strong> (required): provide the URL used for communicating with
CyberArk Conjur&#8217;s secret management system</p>
</li>
<li>
<p><strong>API Key</strong> (required): provide the key given by your Conjur admin</p>
</li>
<li>
<p><strong>Account</strong> (required): the organization&#8217;s account name</p>
</li>
<li>
<p><strong>Username</strong> (required): the specific authenticated user for this
service</p>
</li>
<li>
<p><strong>Public Key Certificate</strong>: include the <code>BEGIN CERTIFICATE</code> and
<code>END CERTIFICATE</code> lines when pasting the public key, if provided by
CyberArk</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below shows an example of a configured CyberArk Conjur credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-cyberark-conjur-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_hashivault"><a class="anchor" href="#ug_credentials_hashivault"></a>13.1.5. HashiCorp Vault Secret Lookup</h4>
<div class="paragraph">
<p>When <strong>HashiCorp Vault Secret Lookup</strong> is selected for <strong>Credential Type</strong>,
provide the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Server URL</strong> (required): provide the URL used for communicating with
HashiCorp Vault&#8217;s secret management system</p>
</li>
<li>
<p><strong>Token</strong>: specify the access token used to authenticate HashiCorp&#8217;s
server</p>
</li>
<li>
<p><strong>CA Certificate</strong>: specify the CA certificate used to verify
HashiCorp&#8217;s server</p>
</li>
<li>
<p><strong>Approle Role_ID</strong>: specify the ID for Approle authentication</p>
</li>
<li>
<p><strong>Approle Secret_ID</strong>: specify the corresponding secret ID for Approle
authentication</p>
</li>
<li>
<p><strong>Path to Approle Auth</strong>: specify a path if other than the default path
of <code>/approle</code></p>
</li>
<li>
<p><strong>API Version</strong> (required): select v1 for static lookups and v2 for
versioned lookups</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more detail about Approle and its fields, refer to the
<a href="https://www.vaultproject.io/docs/auth/approle">Vault documentation for
Approle Auth Method</a>. Below shows an example of a configured HashiCorp
Vault Secret Lookup credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-hashicorp-kv-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_hashivaultssh"><a class="anchor" href="#ug_credentials_hashivaultssh"></a>13.1.6. HashiCorp Vault Signed SSH</h4>
<div class="paragraph">
<p>When <strong>HashiCorp Vault Signed SSH</strong> is selected for <strong>Credential Type</strong>,
provide the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Server URL</strong> (required): provide the URL used for communicating with
HashiCorp Signed SSH&#8217;s secret management system</p>
</li>
<li>
<p><strong>Token</strong>: specify the access token used to authenticate HashiCorp&#8217;s
server</p>
</li>
<li>
<p><strong>CA Certificate</strong>: specify the CA certificate used to verify
HashiCorp&#8217;s server</p>
</li>
<li>
<p><strong>Approle Role_ID</strong>: specify the ID for Approle authentication</p>
</li>
<li>
<p><strong>Approle Secret_ID</strong>: specify the corresponding secret ID for Approle
authentication</p>
</li>
<li>
<p><strong>Path to Approle Auth</strong>: specify a path if other than the default path
of <code>/approle</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more detail about Approle and its fields, refer to the
<a href="https://www.vaultproject.io/docs/auth/approle">Vault documentation for
Approle Auth Method</a>.</p>
</div>
<div class="paragraph">
<p>Below shows an example of a configured HashiCorp SSH Secrets Engine
credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-hashicorp-ssh-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_azurekeyvault"><a class="anchor" href="#ug_credentials_azurekeyvault"></a>13.1.7. Microsoft Azure Key Vault</h4>
<div class="paragraph">
<p>triple: credential; Azure; KMS</p>
</div>
<div class="paragraph">
<p>When <strong>Microsoft Azure Key Vault</strong> is selected for <strong>Credential Type</strong>,
provide the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Vault URL (DNS Name)</strong> (required): provide the URL used for
communicating with MS Azure&#8217;s key management system</p>
</li>
<li>
<p><strong>Client ID</strong> (required): provide the identifier as obtained by the
Azure Active Directory</p>
</li>
<li>
<p><strong>Client Secret</strong> (required): provide the secret as obtained by the
Azure Active Directory</p>
</li>
<li>
<p><strong>Tenant ID</strong> (required): provide the unique identifier that is
associated with an Azure Active Directory instance within an Azure
subscription</p>
</li>
<li>
<p><strong>Cloud Environment</strong>: select the applicable cloud environment to apply</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below shows an example of a configured Microsoft Azure KMS credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-azure-kms-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_thycoticvault"><a class="anchor" href="#ug_credentials_thycoticvault"></a>13.1.8. Thycotic DevOps Secrets Vault</h4>
<div class="paragraph">
<p>When <strong>Thycotic DevOps Secrets Vault</strong> is selected for <strong>Credential Type</strong>,
provide the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Tenant</strong> (required): provide the URL used for communicating with
Thycotic&#8217;s secret management system</p>
</li>
<li>
<p><strong>Top-level Domain (TLD)</strong> : provide the top-level domain designation
(e.g., com, edu, org) associated with the secret vault you want to
integrate</p>
</li>
<li>
<p><strong>Client ID</strong> (required): provide the identifier as obtained by the
Thycotic secret management system</p>
</li>
<li>
<p><strong>Client Secret</strong> (required): provide the secret as obtained by the
Thycotic secret management system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below shows an example of a configured Thycotic DevOps Secrets Vault
credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-thycotic-devops-credential.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_credentials_thycoticserver"><a class="anchor" href="#ug_credentials_thycoticserver"></a>13.1.9. Thycotic Secret Server</h4>
<div class="paragraph">
<p>When <strong>Thycotic Secrets Server</strong> is selected for <strong>Credential Type</strong>,
provide the following metadata to properly configure your lookup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Secret Server URL</strong> (required): provide the URL used for communicating
with the Thycotic Secrets Server management system</p>
</li>
<li>
<p><strong>Username</strong> (required): specify the authenticated user for this service</p>
</li>
<li>
<p><strong>Password</strong> (required): provide the password associated with the user</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below shows an example of a configured Thycotic Secret Server
credential.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/credentials-create-thycotic-server-credential.png" alt="image"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_applications_auth"><a class="anchor" href="#ug_applications_auth"></a>14. Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creating and configuring token-based authentication for external
applications is available starting in automation controller 3.3. This
makes it easier for external applications such as ServiceNow and Jenkins
to integrate with automation controller. OAuth 2 allows you to use
tokens to share certain data with an application without disclosing
login information, and furthermore, these tokens can be scoped as
"read-only". You create an application that is representative of the
external application you are integrating with, then use it to create
tokens for that application to use on behalf of the users of the
external application.</p>
</div>
<div class="paragraph">
<p>Having these tokens associated to an application resource gives you the
ability to manage all tokens issued for a particular application more
easily. By separating token issuance under Applications, you can revoke
all tokens based on the Application without having to revoke all tokens
in the system.</p>
</div>
<div class="paragraph">
<p>When integrating an external web app with automation controller that web
app may need to create OAuth2 Tokens on behalf of users in that other
web app. Creating an application with the Authorization Code grant type
is the preferred way to do this because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>external applications can obtain a token for users, using their
credentials</p>
</li>
<li>
<p>compartmentalized tokens issued for a particular application, allows
those tokens to be easily managed (revoke all tokens associated with
that application, for example)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_getting_started_with_applications"><a class="anchor" href="#_getting_started_with_applications"></a>14.1. Getting Started with Applications</h3>
<div class="paragraph">
<p>Access the Applications page by clicking <strong>Applications</strong> from the left
navigation bar. The Applications page displays a search-able list of all
available Applications currently managed by the controller and can be
sorted by <strong>Name</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/apps-list-view-examples.png" alt="Applications - home with example apps"></span></p>
</div>
<div class="paragraph">
<p>If no other applications exist, only a gray box with a message to add
applications displays.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/apps-list-view-empty.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="ug_applications_auth_create"><a class="anchor" href="#ug_applications_auth_create"></a>14.2. Create a new application</h3>
<div class="paragraph">
<p>Token-based authentication for users can be configured in the
Applications window.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the automation controller User Interface, click <strong>Applications</strong> from
the left navigation bar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Applications window opens.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the <strong>Add</strong> button located in the upper right corner of the
Applications window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The New Application window opens.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/apps-create-new.png" alt="Create application"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Enter the following details in <strong>Create New Application</strong> window:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong> (required): provide a name for the application you want to
create</p>
</li>
<li>
<p><strong>Description</strong>: optionally provide a short description for your
application</p>
</li>
<li>
<p><strong>Organization</strong> (required): provide an organization for which this
application is associated</p>
</li>
<li>
<p><strong>Authorization Grant Type</strong> (required): Select from one of the grant
types to use in order for the user to acquire tokens for this
application. Refer to
<code>grant types &lt;administration:ag_oauth2_token_auth_grant_types&gt;</code> in the
Applications section of the Automation Controller Administration Guide.</p>
</li>
<li>
<p><strong>Redirect URIS</strong>: Provide a list of allowed URIs, separated by spaces.
This is required if you specified the grant type to be <strong>Authorization
code</strong>.</p>
</li>
<li>
<p><strong>Client Type</strong> (required): Select the level of security of the client
device</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>When done, click <strong>Save</strong> or <strong>Cancel</strong> to abandon your changes. Upon
saving, the client ID displays in a pop-up window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/apps-client-id-popup.png" alt="image"></span></p>
</div>
<div class="sect3">
<h4 id="_applications_tokens"><a class="anchor" href="#_applications_tokens"></a>14.2.1. Applications - Tokens</h4>
<div class="paragraph">
<p>Selecting the <strong>Tokens</strong> view displays a list of the users that have
tokens to access the application.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/apps-tokens-list-view-examples.png" alt="Applications - tokens list"></span></p>
</div>
<div class="paragraph">
<p>Tokens can only access resources that its associated user can access,
and can be limited further by specifying the scope of the token.</p>
</div>
<div class="sect4">
<h5 id="ug_tokens_auth_create"><a class="anchor" href="#ug_tokens_auth_create"></a>Add Tokens</h5>
<div class="paragraph">
<p>Tokens are added through the Users screen and can be associated with an
application at that time. Specifying an application can be performed
directly in the User&#8217;s token settings. You can create a token for <em>your</em>
user in the Tokens configuration tab, meaning only you can create and
see your tokens in your own user screen. To add a token:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Access the Users list view by clicking <strong>Users</strong> from the left
navigation bar then click on your user to configure your OAuth 2 tokens.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>You can only create OAuth 2 Tokens for your user via the API or UI,
which means you can only access your own user profile in order to
configure or view your tokens. If you are an admin and need to create or
remove tokens for other users, see the revoke and create commands in the
<code>Token and session management &lt;administration:ag_token_utility&gt;</code> section
of the Automation Controller Administration Guide.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the <strong>Tokens</strong> tab from your user&#8217;s profile.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When no tokens are present, the Tokens screen prompts you to add them:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-tokens-empty.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click the <strong>Add</strong> button, which opens the Create Token window.</p>
</li>
<li>
<p>Enter the following details in Create Token window:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Application</strong>: enter the name of the application with which you want
to associate your token. Alternatively, you can search for it by
clicking the <span class="image"><img src="images/search-button.png" alt="search"></span>
button. This opens a separate window that allows you to choose from the
available options. Use the Search bar to filter by name if the list is
extensive. Leave this field blank if you want to create a Personal
Access Token (PAT) that is not linked to any application.</p>
</li>
<li>
<p><strong>Description</strong>: optionally provide a short description for your token.</p>
</li>
<li>
<p><strong>Scope</strong> (required): specify the level of access you want this token to
have.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>When done, click <strong>Save</strong> or <strong>Cancel</strong> to abandon your changes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After the token is saved, the newly created token for the user displays
with the token information and when it expires.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-token-information-example.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>This is the only time the token value and associated refresh token value
will ever be shown.</p>
</div>
<div class="paragraph">
<p>In the user&#8217;s profile, the application for which it is assigned to and
its expiration displays in the token list view.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/users-token-assignment-example.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To verify the application in the example above now shows the user with
the appropriate token, go to the <strong>Tokens</strong> tab of the Applications
window:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/apps-tokens-list-view-example2.png" alt="image"></span></p>
</div>
<div id="ug_execution_environments" class="paragraph">
<p>Execution Environments ===========</p>
</div>
<div class="paragraph">
<p>The ability to build and deploy Python virtual environments for
automation has been replaced by Ansible execution environments. Unlike
legacy virtual environments, execution environments are container images
that make it possible to incorporate system-level dependencies and
collection-based content. Each execution environment allows you to have
a customized image to run jobs, and each of them contain only what you
need when running the job, nothing more.</p>
</div>
<div id="ug_build_ees" class="paragraph">
<p>Building an Execution Environment -----------------</p>
</div>
<div class="paragraph">
<p>Using Ansible content that depends on non-default dependencies (custom
virtual environments) can be tricky. Packages must be installed on each
node, play nicely with other software installed on the host system, and
be kept in sync. Previously, jobs ran inside of a virtual environment at
<code>/var/lib/awx/venv/ansible</code> by default, which was pre-loaded with
dependencies for ansible-runner and certain types of Ansible content
used by the Ansible control machine.</p>
</div>
<div class="paragraph">
<p>To help simplify this process, container images can be built that serve
as Ansible
<a href="https://docs.ansible.com/ansible/latest/network/getting_started/basic_concepts.html#control-node">control
nodes</a>. These container images are referred to as automation execution
environments, which you can create with ansible-builder and then
ansible-runner can make use of those images.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install_ansible_builder"><a class="anchor" href="#_install_ansible_builder"></a>15. Install ansible-builder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to build images, either installations of podman or docker is
required along with the ansible-builder Python package. The
<code>--container-runtime</code> option needs to correspond to the Podman/Docker
executable you intend to use.</p>
</div>
<div class="paragraph">
<p>To install from PyPi:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ pip install ansible-builder</pre>
</div>
</div>
<div class="paragraph">
<p>To install from the mainline development branch:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ pip install https://github.com/ansible/ansible-builder/archive/devel.zip</pre>
</div>
</div>
<div class="paragraph">
<p>To install from a specific tag or branch, replace <code>&lt;ref&gt;</code> in the
following example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ pip install https://github.com/ansible/ansible-builder/archive/&lt;ref&gt;.zip</pre>
</div>
</div>
<div id="build_ee" class="paragraph">
<p>Build an execution environment <sub>~</sub><sub>~</sub><sub>~</sub><sub>~</sub><sub>~</sub></p>
</div>
<div class="paragraph">
<p>Ansible-builder is used to create an execution environment.</p>
</div>
<div class="paragraph">
<p>An execution environment is expected to contain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ansible</p>
</li>
<li>
<p>Ansible Runner</p>
</li>
<li>
<p>Ansible Collections</p>
</li>
<li>
<p>Python and/or system dependencies of:</p>
<div class="ulist">
<ul>
<li>
<p>modules/plugins in collections</p>
</li>
<li>
<p>content in ansible-base</p>
</li>
<li>
<p>custom user needs</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Building a new execution environment involves a definition (a <code>.yml</code>
file) that specifies which content you would like to include in your
execution environment, such as collections, Python requirements, and
system-level packages. The content from the output generated from
migrating to execution environments has some of the required data that
can be piped to a file or pasted into this definition file. See
<code>migrate_new_venv</code> for more detail. If you did not migrate from a
virtual environment, you can create a definition file with the required
data outlined in <code>ref_ee_definition</code>.</p>
</div>
<div class="paragraph">
<p>Collection developers can declare requirements for their content by
providing the appropriate metadata. For more information, refer to
<code>ref_collections_metadata</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_run_the_builder"><a class="anchor" href="#_run_the_builder"></a>16. Run the builder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you created a definition, use this procedure to build your
execution environment.</p>
</div>
<div class="paragraph">
<p>The <code>ansible-builder build</code> command takes an execution environment
definition as an input. It outputs the build context necessary for
building an execution environment image, and proceeds with building that
image. The image can be re-built with the build context elsewhere, and
produces the same result. By default, it looks for a file named
<code>execution-environment.yml</code> in the current directory.</p>
</div>
<div class="paragraph">
<p>For the illustration purposes, the following example
<code>execution-environment.yml</code> file is used as a starting point:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>---
version: 1
dependencies:
  galaxy: requirements.yml</pre>
</div>
</div>
<div class="paragraph">
<p>The content of <code>requirements.yml</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>---
collections:
  - name: awx.awx</pre>
</div>
</div>
<div class="paragraph">
<p>To build an execution environment using the files above, run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ansible-builder build
...
STEP 7: COMMIT my-awx-ee
--&gt; 09c930f5f6a
09c930f5f6ac329b7ddb321b144a029dbbfcc83bdfc77103968b7f6cdfc7bea2
Complete! The build context can be found at: context</pre>
</div>
</div>
<div class="paragraph">
<p>In addition to producing a ready-to-use container image, the build
context is preserved, which can be rebuilt at a different time and/or
location with the tooling of your choice, such as <code>docker build</code> or
<code>podman build</code>.</p>
</div>
<div class="paragraph">
<p>Use an execution environment in jobs --------------------</p>
</div>
<div class="paragraph">
<p>Depending on whether an execution environment is made available for
global use or tied to an organization, you must have the appropriate
level of administrator privileges in order to use an execution
environment in a job. Execution environments tied to an organization
require Organization administrators to be able to run jobs with those
execution environments.</p>
</div>
<div class="paragraph">
<p>In order to use an execution environment in a job, you must have created
one using ansible-builder. See <code>build_ee</code> for detail. Once an execution
environment is created, you can use it to run jobs. Use the automation
controller user interface to specify the execution environment to use in
your job templates.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Before running a job or job template that uses an execution environment
that has a credential assigned to it, be sure that the credential
contains a username, host, and password.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <strong>Execution Environments</strong> from the left navigation bar.</p>
</li>
<li>
<p>Add an execution environment by selecting the <strong>Add</strong> button.</p>
</li>
<li>
<p>Enter the appropriate details into the following fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter a name for the execution environment (required).</p>
</li>
<li>
<p><strong>Image</strong>: Enter the image name (required). The image name requires its
full location (repo), the registry, image name, and version tag in the
example format of
<code>quay.io/ansible/awx-ee:latestrepo/project/image-name:tag</code>.</p>
</li>
<li>
<p><strong>Job Type</strong>: optionally choose the type of pull when running jobs:</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Always pull container before running</strong>: Pulls the latest image file
for the container.</p>
</li>
<li>
<p><strong>No pull option has been selected</strong>: No pulls specified.</p>
</li>
<li>
<p><strong>Never pull container before running</strong>: Never pull the latest version
of the container image.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Description</strong>: optional.</p>
</li>
<li>
<p><strong>Organization</strong>: optionally assign the organization to specifically use
this execution environment. To make the execution environment available
for use across multiple organizations, leave this field blank.</p>
</li>
<li>
<p><strong>Registry credential</strong>: If the image has a protected container
registry, provide the credential to access it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ee-new-ee-form-filled.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now your newly added execution environment is ready to be used in a job
template. To add an execution environment to a job template, specify it
in the <strong>Execution Environment</strong> field of the job template, as shown in
the example below. For more information on setting up a job template,
see <a href="#ug_JobTemplates">Job Templates</a> in the Automation Controller User Guide.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-template-with-example-ee-selected.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Once you added an execution environment to a job template, you can see
those templates listed in the <strong>Templates</strong> tab of the execution
environment:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ee-details-templates-list.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Execution Environment mount options ----------------------------</p>
</div>
<div class="paragraph">
<p>Rebuilding an execution environment is one way to add certs, but
inheriting certs from the host provides a more convenient solution. For
VM-based installs, the controller automatically mounts the system trust
store in the execution environment when jobs run.</p>
</div>
<div class="paragraph">
<p>Additionally, you may customize execution environment mount options and
mount paths in the <strong>Paths to expose to isolated jobs</strong> field of the Job
Settings page, where it supports podman-style volume mount syntax. Refer
to the
<a href="https://docs.podman.io/en/latest/markdown/podman-run.1.html#volume-v-source-volume-host-dir-container-dir-options">Podman
documentation</a> for detail.</p>
</div>
<div class="paragraph">
<p>In some cases where the <code>/etc/ssh/*</code> files were added to the execution
environment image due to customization of an execution environment, an
SSH error may occur. For example, exposing the
<code>/etc/ssh/ssh_config.d:/etc/ssh/ssh_config.d:O</code> path allows the
container to be mounted, but the ownership permissions are not mapped
correctly.</p>
</div>
<div class="paragraph">
<p>If you encounter this error, or have upgraded from an older version of
the controller (e.g. 3.8.x), perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change the container ownership on the mounted volume to <code>root</code>.</p>
</li>
<li>
<p>In the <strong>Paths to expose to isolated jobs</strong> field of the Job Settings
page, using the current example, expose the path as such:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/settings-paths2expose-iso-jobs.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The <code>:O</code> option is only supported for directories. It is highly
recommended that you be as specific as possible, especially when
specifying system paths. Mounting <code>/etc</code> or <code>/usr</code> directly have impact
that make it difficult to troubleshoot.</p>
</div>
<div class="paragraph">
<p>This informs podman to run a command similar to the example below, where
the configuration is mounted and the <code>ssh</code> command works as expected.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>podman run -v /ssh_config:/etc/ssh/ssh_config.d/:O ...</pre>
</div>
</div>
<div class="paragraph">
<p>To expose isolated paths in OpenShift or Kubernetes containers as
HostPath, assume the following configuration:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/settings-paths2expose-iso-jobs-mount-containers.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Use the <strong>Expose host paths for Container Groups</strong> toggle to enable it.</p>
</div>
<div class="paragraph">
<p>Once the playbook runs, the resulting Pod spec will display similar to
the example below. Note the details of the <code>volumeMounts</code> and <code>volumes</code>
sections.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/mount-containers-playbook-run-podspec.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_execution_environment_setup_reference"><a class="anchor" href="#_execution_environment_setup_reference"></a>17. Execution Environment Setup Reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains reference information associated with setting up
and building execution environments.</p>
</div>
<div id="ref_ee_definition" class="paragraph">
<p>Execution environment definition <sub>~</sub><sub>~</sub><sub>~</sub><sub>~</sub><sub>~</sub>~~</p>
</div>
<div class="paragraph">
<p>A definition file is a <code>.yml</code> file that is required to build an image
for an execution environment. An example of an execution environment
definition schema is as follows:</p>
</div>
<div class="paragraph">
<p>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>---
version: 1

build_arg_defaults:
  EE_BASE_IMAGE: 'quay.io/ansible/ansible-runner:stable-2.10-devel'

ansible_config: 'ansible.cfg'

dependencies:
  galaxy: requirements.yml
  python: requirements.txt
  system: bindep.txt

additional_build_steps:
  prepend: |
    RUN whoami
    RUN cat /etc/os-release
  append:
    - RUN echo This is a post-install command!
    - RUN ls -la /etc</pre>
</div>
</div>
<div class="sect2">
<h3 id="_build_arguments_and_base_image"><a class="anchor" href="#_build_arguments_and_base_image"></a>17.1. Build arguments and base image</h3>
<div class="paragraph">
<p>Default values for build arguments can be specified in the definition
file in the <code>default_build_args</code> section as a dictionary. This is an
alternative to using the <code>--build-arg</code> CLI flag.</p>
</div>
<div class="paragraph">
<p>Build arguments used by <code>ansible-builder</code> are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ANSIBLE_GALAXY_CLI_COLLECTION_OPTS</code> allows the user to pass the
<code>âpre</code> flag to enable the installation of pre-releases collections.</p>
</li>
<li>
<p><code>EE_BASE_IMAGE</code> specifies the parent image for the execution
environment.</p>
</li>
<li>
<p><code>EE_BUILDER_IMAGE</code> specifies the image used for compiling type tasks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Values given inside of <code>default_build_args</code> will be hard-coded into the
Containerfile, so they will persist if <code>podman build</code> is called
manually.</p>
</div>
<div class="paragraph">
<p>If the same variable is specified in the CLI <code>--build-arg</code> flag, the CLI
value will take higher precedence.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ansible_config_file_path"><a class="anchor" href="#_ansible_config_file_path"></a>17.2. Ansible config file path</h3>
<div class="paragraph">
<p>When using an <code>ansible.cfg</code> file to pass a token and other settings for
a private account to an Automation Hub server, listing the config file
path here (as a string) will enable it to be included as a build
argument in the initial phase of the build.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ansible_galaxy_dependencies"><a class="anchor" href="#_ansible_galaxy_dependencies"></a>17.3. Ansible Galaxy dependencies</h3>
<div class="paragraph">
<p>The <code>galaxy</code> entry points to a valid requirements file for the
<code>ansible-galaxy collection install -r &#8230;&#8203;</code> command.</p>
</div>
<div class="paragraph">
<p>The entry <code>requirements.yml</code> may be a relative path from the directory
of the execution environment definitionâs folder, or an absolute path.</p>
</div>
</div>
<div class="sect2">
<h3 id="_python_dependencies"><a class="anchor" href="#_python_dependencies"></a>17.4. Python dependencies</h3>
<div class="paragraph">
<p>The python entry points to a valid requirements file for the
<code>pip install -r &#8230;&#8203;</code> command.</p>
</div>
<div class="paragraph">
<p>The entry <code>requirements.txt</code> may be a relative path from the directory
of the execution environment definitionâs folder, or an absolute path.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_level_dependencies"><a class="anchor" href="#_system_level_dependencies"></a>17.5. System-level dependencies</h3>
<div class="paragraph">
<p>The <code>system</code> entry points to a <code>bindep</code> requirements file. This will be
processed by <code>bindep</code> and then passed to <code>dnf</code>, other platforms are not
yet supported. For more information about bindep, refer to the
<a href="https://docs.opendev.org/opendev/bindep/latest/readme.html">OpenDev
documentation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_additional_custom_build_steps"><a class="anchor" href="#_additional_custom_build_steps"></a>17.6. Additional custom build steps</h3>
<div class="paragraph">
<p>Additional commands may be specified in the <code>additional_build_steps</code>
section, either for before the main build steps (<code>prepend</code>) or after
(<code>append</code>). The syntax needs to be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a multi-line string (example shown in the <code>prepend</code> section above)</p>
</li>
<li>
<p>a dictionary (as shown via <code>append</code>)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ansible_builder_build_options"><a class="anchor" href="#_ansible_builder_build_options"></a>17.6.1. ansible-builder build options</h4>
<div class="paragraph">
<p>The following options can be used with the <code>ansible-builder build</code>
command:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 60%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Flag</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Syntax</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--tag</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To customize the tagged name applied to the built image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$ ansible-builder build --tag=my-custom-ee</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To use a definition file named something other than
<code>execution-environment.yml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$ ansible-builder build --file=my-ee.yml</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--context</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To specify a location other than the default directory
named <code>context</code> created in the current working directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$ ansible-builder build --context=/path/to/dir</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--build-arg</code></p>
</div>
<div class="paragraph">
<p><em>
*
</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>To use Podman or Dockerâs build-time variables, specify them the same
way you would with <code>podman build</code> or <code>docker build</code>. By default, the
Containerfile / Dockerfile outputted by ansible-builder contains a build
argument <code>EE_BASE_IMAGE,</code> which can be useful for rebuilding execution
environments wi</p>
</div>
</blockquote>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</dt>
<dd>
<p>To use a custom base image (replaces previously discontinued
<code>--base-image</code> option)</p>
</dd>
</dl>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><code>$ ansible-builder build --build-arg FOO=bar</code></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>thout modifying any files.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">---------------------------------------------------------------------------------------+
<code>$ ansible-builder build --build-arg EE_BASE_IMAGE=registry.example.com/another-ee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--container-runtime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To use Docker to build images instead of the
Podman default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$ ansible-builder build --container-runtime=docker</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--verbosity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To customize the level of verbosity</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_examples"><a class="anchor" href="#_examples"></a>17.7. Examples</h3>
<div class="paragraph">
<p>The example in <code>test/data/pytz</code> requires the <code>awx.awx</code> collection in the
execution environment definition. The lookup plugin
<code>awx.awx.tower_schedule_rrule</code> requires the PyPI <code>pytz</code> and another
library to work. If <code>test/data/pytz/execution-environment.yml</code> file is
provided to the <code>ansible-builder build</code> command, then it will install
the collection inside the image, read the <code>requirements.txt</code> file inside
of the collection, and then install <code>pytz</code> into the image.</p>
</div>
<div class="paragraph">
<p>The image produced can be used inside of an <code>ansible-runner</code> project by
placing these variables inside the <code>env/settings</code> file, inside of the
private data directory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>---
container_image: image-name
process_isolation_executable: podman # or docker
process_isolation: true</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>awx.awx</code> collection is a subset of content included in the default
AWX execution environment. More details can be found in the
<a href="https://github.com/ansible/awx-ee">awx-ee repository</a>.</p>
</div>
<div class="sect3">
<h4 id="ref_collections_metadata"><a class="anchor" href="#ref_collections_metadata"></a>17.7.1. Collection-level metadataÂ¶</h4>
<div class="paragraph">
<p>Collections inside of the <code>galaxy</code> entry of an execution environment
will contribute their Python and system requirements to the image.</p>
</div>
<div class="paragraph">
<p>Requirements from a collection can be recognized in these ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A file <code>meta/execution-environment.yml</code> references the Python and/or
bindep requirements files</p>
</li>
<li>
<p>A file named <code>requirements.txt</code> is in the root level of the collection</p>
</li>
<li>
<p>A file named <code>bindep.txt</code> is in the root level of the collection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these files are in the <code>build_ignore</code> of the collection, it
will not work correctly.</p>
</div>
<div class="paragraph">
<p>Collection maintainers can verify that ansible-builder recognizes the
requirements they expect by using the <code>introspect</code> command, for example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ansible-builder introspect --sanitize ~/.ansible/collections/</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_python_dependencies_2"><a class="anchor" href="#_python_dependencies_2"></a>17.8. Python Dependencies</h3>
<div class="paragraph">
<p>Python requirements files are combined into a single file using the
<code>requirements-parser</code> library in order to support complex syntax like
references to other files.</p>
</div>
<div class="paragraph">
<p>Entries from separate collections that give the same package name will
be combined into the same entry, with the constraints combined.</p>
</div>
<div class="paragraph">
<p>There are several package names which are specifically <em>ignored</em> by
ansible-builder, meaning that if a collection lists these, they will not
be included in the combined file. These include test packages and
packages that provide Ansible itself. The full list can be found in
<code>EXCLUDE_REQUIREMENTS</code> in the <code>ansible_builder.requirements</code> module.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_level_dependencies_2"><a class="anchor" href="#_system_level_dependencies_2"></a>17.9. System-level Dependencies</h3>
<div class="paragraph">
<p>The <code>bindep</code> format provides a way of specifying cross-platform
requirements. A minimum expectation is that collections specify
necessary requirements for `[platform:rpm].</p>
</div>
<div class="paragraph">
<p>Entries from multiple collections will be combined into a single file.
Only requirements with no profiles (runtime requirements) will be
installed to the image. Entries from multiple collections which are
outright duplicates of each other may be consolidated in the combined
file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_projects"><a class="anchor" href="#ug_projects"></a>18. Projects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>Project</code> is a logical collection of Ansible playbooks.</p>
</div>
<div class="paragraph">
<p>You can manage playbooks and playbook directories by either placing them
manually under the Project Base Path on your server, or by placing your
playbooks into a source code management (SCM) system supported by
automation controller, including Git, Subversion, and Red Hat Insights.
To create a Red Hat Insights project, refer to <code>insights</code>.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>By default, the Project Base Path is <code>/var/lib/awx/projects</code>, but this
may have been modified by the administrator. It is configured in
<code>/etc/tower/conf.d/custom.py</code>. Use caution when editing this file, as
incorrect settings can disable your installation.</p>
</div>
<div class="paragraph">
<p>The Projects page displays the list of the projects that are currently
available. The default view is collapsed (<strong>Compact</strong>) with project name
and its status, but you can use the arrow next to each entry to expand
for more information.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-list-all.png" alt="Projects - home with example project"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-list-all-expanded.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>For each project listed, you can get the latest SCM revision
(<span class="image"><img src="images/refresh-gray.png" alt="refresh"></span>), edit the
project (<span class="image"><img src="images/edit-button.png" alt="edit"></span>), or
copy the project attributes
(<span class="image"><img src="images/copy-button.png" alt="copy"></span>), using the
respective icons next to each project. Projects are allowed to be
updated while a related job is running. In cases where you have a big
project (around 10 GB), disk space on <code>/tmp</code> may be an issue.</p>
</div>
<div class="paragraph">
<p><strong>Status</strong> indicates the state of the project and may be one of the
following (note that you can also filter your view by specific status
types):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Pending</strong> - The source control update has been created, but not queued
or started yet. Any job (not just source control updates) will stay in
pending until it&#8217;s actually ready to be run by the system. Reasons for
it not being ready because it has dependencies that are currently
running so it has to wait until they are done, or there is not enough
capacity to run in the locations it is configured to.</p>
</li>
<li>
<p><strong>Waiting</strong> - The source control update is in the queue waiting to be
executed.</p>
</li>
<li>
<p><strong>Running</strong> - The source control update is currently in progress.</p>
</li>
<li>
<p><strong>Successful</strong> - The last source control update for this project
succeeded.</p>
</li>
<li>
<p><strong>Failed</strong> - The last source control update for this project failed.</p>
</li>
<li>
<p><strong>Error</strong> - The last source control update job failed to run at all. (To
be deprecated.)</p>
</li>
<li>
<p><strong>Canceled</strong> - The last source control update for the project was
canceled.</p>
</li>
<li>
<p><strong>Never updated</strong> - The project is configured for source control, but
has never been updated.</p>
</li>
<li>
<p><strong>OK</strong> - The project is not configured for source control, and is
correctly in place. (To be deprecated.)</p>
</li>
<li>
<p><strong>Missing</strong> - Projects are absent from the project base path of
<code>/var/lib/awx/projects</code> (applicable for manual or source control managed
projects).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Projects of credential type Manual cannot update or schedule source
control-based actions without being reconfigured as an SCM type
credential.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If deleting items that are used by other work items, a message opens
listing the items are affected by the deletion and prompts you to
confirm the deletion. Some screens will contain items that are invalid
or previously deleted, so they will fail to run. Below is an example of
such a message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/warning-deletion-dependencies.png" alt="image"></span></p>
</div>
<div class="sect2">
<h3 id="_add_a_new_project"><a class="anchor" href="#_add_a_new_project"></a>18.1. Add a new project</h3>
<div class="paragraph">
<p>To create a new project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button, which launches the <strong>Create Project</strong> window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-create-new-project.png" alt="Projects - create new project"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details into the following required fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong></p>
</li>
<li>
<p><strong>Description</strong> (optional)</p>
</li>
<li>
<p><strong>Organization</strong> - A project must have at least one organization. Pick
one organization now to create the project, and then after the project
is created you can add additional organizations.</p>
</li>
<li>
<p><strong>Default Execution Environment</strong> (optional) - Enter the name of the
execution environment or search from a list of existing ones to run this
project. See <code>upgrade_venv</code> in the Ansible Automation Platform Upgrade
and Migration Guide for more information.</p>
</li>
<li>
<p><strong>Source Control Credential Type</strong> - Select from the drop-down menu list
an SCM type associated with this project. The options in the subsequent
section become available depend on the type you choose. Refer to
<a href="#ug_manual` or xref:ug_projects_scm_types">[ug_manual` or xref:ug_projects_scm_types]</a> in the subsequent sections for
more detail.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If adding a manual project, each project path inside of the project root
folder can only be assigned to one project. If you receive the following
message, ensure that you have not already assigned the project path to
an existing project:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><code>All of the project paths have been assigned to existing projects, or there are no directories found in the base path.</code>
<code>You will need to add a project path before creating a new project.</code></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="ug_manual"><a class="anchor" href="#ug_manual"></a>18.1.1. Manage playbooks manually</h4>
<div class="ulist">
<ul>
<li>
<p>Create one or more directories to store playbooks under the Project
Base Path (for example, /var/lib/awx/projects/)</p>
</li>
<li>
<p>Create or copy playbook files into the playbook directory.</p>
</li>
<li>
<p>Ensure that the playbook directory and files are owned by the same
UNIX user and group that the automation controller service runs as.</p>
</li>
<li>
<p>Ensure that the permissions are appropriate for the playbook
directories and files.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you have trouble adding a project path, check the permissions and
SELinux context settings for the project directory and files.</p>
</div>
<div class="paragraph">
<p>Warning</p>
</div>
<div class="paragraph">
<p>If you have not added any Ansible playbook directories to the base
project path, you will receive the following message:</p>
</div>
<div class="paragraph">
<p>Correct this issue by creating the appropriate playbook directories and
checking out playbooks from your SCM or otherwise copying playbooks into
the appropriate playbook directories.</p>
</div>
</div>
<div class="sect3">
<h4 id="ug_projects_scm_types"><a class="anchor" href="#ug_projects_scm_types"></a>18.1.2. Manage playbooks using source control</h4>
<div class="sect4">
<h5 id="_scm_types_git_and_subversion"><a class="anchor" href="#_scm_types_git_and_subversion"></a>SCM Types - Git and Subversion</h5>
<div class="paragraph">
<p>To configure playbooks to use source control, in the Project <strong>Details</strong>
tab:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the appropriate option (Git or Subversion) from the <strong>SCM Type</strong>
drop-down menu list.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details into the following fields:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>SCM URL</strong> - See an example in the tooltip .</p>
</li>
<li>
<p><strong>SCM Branch/Tag/Commit</strong> - Optionally enter the SCM branch, tags,
commit hashes, arbitrary refs, or revision number (if applicable) from
the source control (Git or Subversion) to checkout. Some commit hashes
and refs may not be available unless you also provide a custom refspec
in the next field. If left blank, the default is HEAD which is the last
checked out Branch/Tag/Commit for this project.</p>
</li>
<li>
<p><strong>SCM Refspec</strong> - This field is an option specific to git source control
and only advanced users familiar and comfortable with git should specify
which references to download from the remote repository. For more
detail, see <code>job branch overriding &lt;ug_job_branching&gt;</code>.</p>
</li>
<li>
<p><strong>SCM Credential</strong> - If authentication is required, select the
appropriate SCM credential</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the <strong>SCM Update Options</strong>, optionally select the launch behavior, if
applicable.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Clean</strong> - Removes any local modifications prior to performing an
update.</p>
</li>
<li>
<p><strong>Delete on Update</strong> - Deletes the local repository in its entirety
prior to performing an update. Depending on the size of the repository
this may significantly increase the amount of time required to complete
an update.</p>
</li>
<li>
<p><strong>Update Revision on Launch</strong> - Updates the revision of the project to
the current revision in the remote source control, as well as cache the
roles directory from <code>Galaxy &lt;ug_galaxy&gt;</code> or
<code>Collections &lt;ug_collections&gt;</code>. Automation controller ensures that the
local revision matches and that the roles and collections are up-to-date
with the last update. Also, to avoid job overflows if jobs are spawned
faster than the project can sync, selecting this allows you to configure
a Cache Timeout to cache prior project syncs for a certain number of
seconds.</p>
</li>
<li>
<p><strong>Allow Branch Override</strong> - Allows a job template that uses this project
to launch with a specified SCM branch or revision other than that of the
project&#8217;s. For more detail, see
<code>job branch overriding &lt;ug_job_branching&gt;</code>.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/projects-create-scm-project-branch-override-checked.png" alt="image"></span></p>
</div>
</blockquote>
</div>
</div>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> to save your project.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Tip</p>
</div>
<div class="paragraph">
<p>Using a GitHub link offers an easy way to use a playbook. To help get
you started, use the <code>helloworld.yml</code> file available at:
<a href="https://github.com/ansible/tower-example.git" class="bare">https://github.com/ansible/tower-example.git</a></p>
</div>
<div class="paragraph">
<p>This link offers a very similar playbook to the one created manually in
the instructions found in the
<code>Automation Controller Quick Setup Guide &lt;qs_start&gt;</code>. Using it will not
alter or harm your system in anyway.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect4">
<h5 id="_scm_type_red_hat_insights"><a class="anchor" href="#_scm_type_red_hat_insights"></a>SCM Type - Red Hat Insights</h5>
<div class="paragraph">
<p>To configure playbooks to use Red Hat Insights, in the Project <strong>Details</strong>
tab:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select <strong>Red Hat Insights</strong> from the <strong>SCM Type</strong> drop-down menu list.</p>
</li>
<li>
<p>Red Hat Insights requires a credential for authentication. Select from
the <strong>Credential</strong> field the appropriate credential for use with Insights.</p>
</li>
<li>
<p>In the <strong>SCM Update Options</strong>, optionally select the launch behavior, if
applicable.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Clean</strong> - Removes any local modifications prior to performing an
update.</p>
</li>
<li>
<p><strong>Delete on Update</strong> - Deletes the local repository in its entirety
prior to performing an update. Depending on the size of the repository
this may significantly increase the amount of time required to complete
an update.</p>
</li>
<li>
<p><strong>Update Revision on Launch</strong> - Updates the revision of the project to
the current revision in the remote source control, as well as cache the
roles directory from <code>Galaxy &lt;ug_galaxy&gt;</code> or
<code>Collections &lt;ug_collections&gt;</code>. Automation controller ensures that the
local revision matches and that the roles and collections are up-to-date
with the last update. Also, to avoid job overflows if jobs are spawned
faster than the project can sync, selecting this allows you to configure
a Cache Timeout to cache prior project syncs for a certain number of
seconds.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-create-scm-insights.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> to save your project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_scm_type_remote_archive"><a class="anchor" href="#_scm_type_remote_archive"></a>SCM Type - Remote Archive</h5>
<div class="paragraph">
<p>Playbooks using a remote archive allow projects to be provided based on
a build process that produces a versioned artifact, or release,
containing all the requirements for that project in a single archive.</p>
</div>
<div class="paragraph">
<p>To configure playbooks to use a remote archive, in the Project <strong>Details</strong>
tab:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select <strong>Remote Archive</strong> from the <strong>SCM Type</strong> drop-down menu list.</p>
</li>
<li>
<p>Enter the appropriate details into the following fields:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>SCM URL</strong> - requires a URL to a remote archive, such as a <em>GitHub
Release</em> or a build artifact stored in <em>Artifactory</em> and unpacks it into
the project path for use</p>
</li>
<li>
<p><strong>SCM Credential</strong> - If authentication is required, select the
appropriate SCM credential</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the <strong>SCM Update Options</strong>, optionally select the launch behavior, if
applicable.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Clean</strong> - Removes any local modifications prior to performing an
update.</p>
</li>
<li>
<p><strong>Delete on Update</strong> - Deletes the local repository in its entirety
prior to performing an update. Depending on the size of the repository
this may significantly increase the amount of time required to complete
an update.</p>
</li>
<li>
<p><strong>Update Revision on Launch</strong> - Not recommended, as this option updates
the revision of the project to the current revision in the remote source
control, as well as cache the roles directory from <code>Galaxy &lt;ug_galaxy&gt;</code>
or <code>Collections &lt;ug_collections&gt;</code>.</p>
</li>
<li>
<p><strong>Allow Branch Override</strong> - Not recommended, as this option allows a job
template that uses this project to launch with a specified SCM branch or
revision other than that of the project&#8217;s.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-create-scm-rm-archive.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Since this SCM type is intended to support the concept of unchanging
artifacts, it is advisable to disable Galaxy integration (for roles, at
minimum).</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> to save your project.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updating_projects_from_source_control"><a class="anchor" href="#_updating_projects_from_source_control"></a>18.2. Updating projects from source control</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update an existing SCM-based project by selecting the project and
clicking the <span class="image"><img src="images/refresh-gray.png" alt="refresh"></span>
button.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Please note that immediately after adding a project setup to use source
control, a "Sync" starts that fetches the project details from the
configured source control.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-list-all.png" alt="projects - list all"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click on project&#8217;s status under the <strong>Status</strong> column to get further
details about the update process.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-list-status-more.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-update-status.png" alt="Project - update status"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_permissions"><a class="anchor" href="#_work_with_permissions"></a>18.3. Work with Permissions</h3>
<div class="paragraph">
<p>The set of permissions assigned to this project (role-based access
controls) that provide the ability to read, modify, and administer
projects, inventories, job templates, and other automation controller
elements are Privileges.</p>
</div>
<div class="paragraph">
<p>You can access the project permissions via the <strong>Access</strong> tab next to the
<strong>Details</strong> tab. This screen displays a list of users that currently have
permissions to this project. The list may be sorted and searched by
<strong>Username</strong>, <strong>F.adoc[] Name</strong>, or <strong>Last Name</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-permissions-example.png" alt="Projects - permissions list for example project"></span></p>
</div>
<div class="sect3">
<h4 id="_add_permissions_2"><a class="anchor" href="#_add_permissions_2"></a>18.3.1. Add Permissions</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Select a user or team to add and click <strong>Next</strong></p>
</li>
<li>
<p>Select one or more users or teams from the list by clicking the check
box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-for-example-organization.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>In this example, two users have been selected to be added.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Select the role(s) you want the selected user(s) or team(s) to have.
Be sure to scroll down for a complete list of roles. Different resources
have different options available.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-roles.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or
team(s) and to add them as members.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Add Users/Teams window closes to display the updated roles assigned
for each user and team.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-tab-roles-assigned.png" alt="Permissions tab with Role Assignments"></span></p>
</div>
<div class="paragraph">
<p>To remove roles for a particular user, click the disassociate (x) button
next to its resource.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>This launches a confirmation dialog, asking you to confirm the
disassociation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate-confirm.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_notifications_2"><a class="anchor" href="#_work_with_notifications_2"></a>18.4. Work with Notifications</h3>
<div class="paragraph">
<p>Clicking the <strong>Notifications</strong> tab allows you to review any notification
integrations you have setup.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-notifications-example-list.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Use the toggles to enable or disable the notifications to use with your
particular project. For more detail, see <a href="#ug_notifications_on_off">[ug_notifications_on_off]</a>.</p>
</div>
<div class="paragraph">
<p>If no notifications have been set up, you can configure them from the
<strong>Notifications</strong> link from the left navigation bar to create a new
notification.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/project-notifications-empty.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Refer to <a href="#ug_notifications_types">[ug_notifications_types]</a> for additional details on configuring
various notification types.</p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_job_templates"><a class="anchor" href="#_work_with_job_templates"></a>18.5. Work with Job Templates</h3>
<div class="paragraph">
<p>Clicking on <strong>Job Templates</strong> allows you to add and review any job
templates or workflow templates associated with this project.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-templates-example-list.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Click on the statuses of the jobs that ran using that template to see
its details and other useful information. You can sort this list by
various criteria, and perform a search to filter the templates of
interest.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-templates-job-status.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>From this view, you can also launch
(<span class="image"><img src="images/launch-button.png" alt="launch"></span>) or edit
(<span class="image"><img src="images/edit-button.png" alt="edit"></span>) the template
configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_schedules"><a class="anchor" href="#_work_with_schedules"></a>18.6. Work with Schedules</h3>
<div class="paragraph">
<p>Clicking on <strong>Schedules</strong> allows you to review any schedules set up for
this project.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/generic-schedules-list-configured.png" alt="image"></span></p>
</div>
<div class="sect3">
<h4 id="_schedule_a_project"><a class="anchor" href="#_schedule_a_project"></a>18.6.1. Schedule a Project</h4>
<div class="paragraph">
<p>To schedule a project run, click the <strong>Schedules</strong> tab.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If schedules are already set up; review, edit, or enable/disable your
schedule preferences.</p>
</li>
<li>
<p>If schedules have not been set up, refer to <a href="#ug_scheduling">[ug_scheduling]</a> for more
information.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_galaxy"><a class="anchor" href="#ug_galaxy"></a>18.7. Ansible Galaxy Support</h3>
<div class="paragraph">
<p>At the end of a Project update, automation controller searches for a
file called <code>requirements.yml</code> in the <code>roles</code> directory, located at
<code>&lt;project-top-level-directory&gt;/roles/requirements.yml</code>. If this file is
found, the following command automatically runs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ansible-galaxy role install -r roles/requirements.yml -p &lt;project-specific cache location&gt;/requirements_roles -vvv</pre>
</div>
</div>
<div class="paragraph">
<p>This file allows you to reference Galaxy roles or roles within other
repositories which can be checked out in conjunction with your own
project. The addition of this Ansible Galaxy support eliminates the need
to create git submodules for achieving this result. Given that SCM
projects (along with roles/collections) are pulled into and executed
from a private job environment, a &lt;private job directory&gt; specific to
the project within <code>/tmp</code> is created by default. However, you can
specify another <strong>Job Execution Path</strong> based on your environment in the
Jobs Settings tab of the Settings window:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/configure-tower-jobs-execution-path.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The cache directory is a subdirectory inside the global projects folder.
The content may be copied from the cache location to
<code>&lt;job private directory&gt;/requirements_roles</code> location.</p>
</div>
<div class="paragraph">
<p>By default, automation controller has a system-wide setting that allows
roles to be dynamically downloaded from the <code>roles/requirements.yml</code>
file for SCM projects. You may turn off this setting in the <strong>Jobs
settings</strong> screen of the Settings menu by switching the <strong>Enable Role
Download</strong> toggle button to <strong>OFF</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/configure-tower-jobs-download-roles.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Whenever a project sync runs, automation controller determines if the
project source and any roles from Galaxy and/or Collections are out of
date with the project. Project updates will download the roles inside
the update.</p>
</div>
<div class="paragraph">
<p>If jobs need to pick up a change made to an upstream role, updating the
project will ensure this happens. A change to the role means that a new
commit was pushed to the <em>provision-role</em> source control. To make this
change take effect in a job, you do not need to push a new commit to the
<em>playbooks</em> repo, but you <strong>do need</strong> to update the project, which
downloads roles to a local cache. For instance, say you have two git
repositories in source control. The f.adoc[] one is <em>playbooks</em> and the
project in automation controller points to this URL. The second one is
<em>provision-role</em> and it is referenced by the <code>roles/requirements.yml</code>
file inside of the <em>playbooks</em> git repo.</p>
</div>
<div class="paragraph">
<p>In short, jobs would download the most recent roles before every job
run. Roles and collections are locally cached for performance reasons,
and you will need to select <strong>Update Revision on Launch</strong> in the project
SCM Update Options to ensure that the upstream role is re-downloaded
before each job run:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-scm-update-options-update-on-launch-checked.png" alt="update-on-launch"></span></p>
</div>
<div class="paragraph">
<p>The update happens much earlier in the process than the sync, so this
surfaces errors and details faster and in a more logic place.</p>
</div>
<div class="paragraph">
<p>For more information and examples on the syntax of the
<code>requirements.yml</code> file, refer to the
<a href="https://docs.ansible.com/ansible/latest/galaxy/user_guide.html#installing-multiple-roles-from-a-file">role
requirements section</a> in the Ansible documentation.</p>
</div>
<div class="paragraph">
<p>If there are any directories that should specifically be exposed, you
can specify those in the Jobs section of the Settings screen in the
<strong>Paths to Expose to Isolated Jobs</strong> or by updating the following entry in
the settings file:</p>
</div>
<div class="paragraph">
<p>`AWX_ISOLATION_SHOW_PATHS = ['/list/of/', '/paths']</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The primary file you may want to add to <code>AWX_ISOLATION_SHOW_PATHS</code> is
<code>/var/lib/awx/.ssh</code>, if your playbooks need to use keys or settings
defined there.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>If you made changes in the settings file, be sure to restart services
with the <code>automation-controller-service restart</code> command after your
changes have been saved.</p>
</div>
<div class="paragraph">
<p>In the User Interface, you can configure these settings in the Jobs
settings window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/configure-tower-jobs-path-to-expose.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The <strong>Primary Galaxy Server Username</strong> and <strong>Primary Galaxy Server
Password</strong> fields are no longer configurable in automation controller
3.8. We recommend using tokens to access Galaxy or Automation Hub
instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="ug_collections"><a class="anchor" href="#ug_collections"></a>18.8. Collections Support</h3>
<div class="paragraph">
<p>Automation controller supports project-specific
<a href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html">Ansible
collections</a> in job runs. If you specify a collections requirements file
in the SCM at <code>collections/requirements.yml</code>, automation controller will
install collections in that file in the implicit project sync before a
job run.</p>
</div>
<div class="paragraph">
<p>By default, automation controller has a system-wide setting that allows
collections to be dynamically downloaded from the
<code>collections/requirements.yml</code> file for SCM projects. You may turn off
this setting in the <strong>Jobs settings</strong> tab of the Settings menu by
switching the <strong>Enable Collections Download</strong> toggle button to <strong>OFF</strong>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/configure-tower-jobs-download-collections.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Roles and collections are locally cached for performance reasons, and
you will need to select <strong>Update Revision on Launch</strong> in the project SCM
Update Options to ensure this:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-scm-update-options-update-on-launch-checked.png" alt="update-on-launch"></span></p>
</div>
<div class="sect3">
<h4 id="ug_collections_usage"><a class="anchor" href="#ug_collections_usage"></a>18.8.1. Using Collections via Hub</h4>
<div class="paragraph">
<p>Before automation controller can use Automation Hub as the default
source for collections content, you need to create an API token in the
Automation Hub UI so that it could be specified in automation
controller. You may connect to a private Automation Hub or a public
Automation Hub collection, the only difference is which URL you specify.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <a href="https://cloud.redhat.com/ansible/automation-hub/token" class="bare">https://cloud.redhat.com/ansible/automation-hub/token</a> and
click <strong>Load token</strong>.</p>
</li>
<li>
<p>Click the copy icon to copy the API token to the clipboard.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-ah-loaded-token-shown.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>To use the public Automation Hub, create an Automation Hub credential
using the copied token and pointing to the URLs shown in the <strong>Server
URL</strong> and <strong>SSO URL</strong> fields of the token page:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Galaxy Server URL</strong> = <code><a href="https://cloud.redhat.com/api/automation-hub/" class="bare">https://cloud.redhat.com/api/automation-hub/</a></code></p>
</li>
<li>
<p><strong>AUTH SEVER URL</strong> =
<code><a href="https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token" class="bare">https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token</a></code></p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>To use a private Automation Hub, create an Automation Hub credential
using a token retrieved from the Repo Management dashboard of your local
Automation Hub and pointing to the published repo URL as shown:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-ah-repo-mgmt-get-token.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-ah-repo-mgmt-repos-published.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>You can create different repos with different namespaces/collections in
them. But for each repo in Automation Hub you need to create a different
Automation Hub credential. Copy the <strong>Ansible CLI URL</strong> from the
Automation Hub UI in the format of
<code><a href="https://$&lt;hub_url&gt;/api/galaxy/content/&lt;repo" class="bare">https://$&lt;hub_url&gt;/api/galaxy/content/&lt;repo</a> you want to pull from&gt;</code>
into the <strong>Galaxy Server URL</strong> field of the <em>Create Credential</em> form:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-create-ah-credential.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Refer to
<a href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/1.2/html/managing_red_hat_certified_and_ansible_galaxy_collections_in_automation_hub/index">Managing
Red Hat Certified and Ansible Galaxy Collections in Ansible Hub</a> for
Automation Hub UI-specific instructions.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Navigate to the organization for which you want to be able to sync
content from Automation Hub and add the new Automation Hub credential to
the organization. This step allows you to associate each organization
with the Automation Hub credential (i.e. repo) that you want to be able
to use content from.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-organizations-add-ah-credential.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Suppose you have two repos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Prod</em>: <code>Namespace 1</code> and <code>Namespace 2</code>, each with collection <code>A</code> and
<code>B</code> so: <code>namespace1.collectionA:v2.0.0</code> and
<code>namespace2.collectionB:v2.0.0</code></p>
</li>
<li>
<p><em>Stage</em>: <code>Namespace 1</code> with only collection <code>A</code> so:
<code>namespace1.collectionA:v1.5.0</code> on Automation Hub, you will have a repo
URL for <em>Prod</em> and <em>Stage</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can create an Automation Hub credential for each one. Then you can
assign different levels of access to different organizations. For
example, you can create a Developers organization has access to both
repos, while an Operations organization just has access to the
Automation Hub <strong>Prod</strong> repo only.</p>
</div>
<div class="paragraph">
<p>Refer to
<a href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/1.0/html/managing_user_access_in_automation_hub/index">Managing
User Access in Ansible Hub</a> for Automation Hub UI-specific instructions.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>If the Automation Hub has self-signed certificates, click the toggle
to enable the setting <strong>Ignore Ansible Galaxy SSL Certificate
Verification</strong>. For <strong>public Automation Hub</strong>, which uses a signed
certificate, click the toggle to disable it instead. Note this is a
global setting:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/settings-jobs-ignore-galaxy-certs.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Create a project, where the source repository specifies the necessary
collections in a requirements file located in the
<code>collections/requirements.yml</code> file. Refer to the syntax described in
the Ansible documentation:
<a href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#install-multiple-collections-with-a-requirements-file" class="bare">https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#install-multiple-collections-with-a-requirements-file</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/projects-add-ah-source-repo.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>In the Projects list view, click
<span class="image"><img src="images/refresh-gray.png" alt="update"></span> to run an
update against this project. Automation controller fetches the Galaxy
collections from the <code>collections/requirements.yml</code> file and report it
as changed; and the collections will now be installed for any job
template using this project.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If updates are needed from Galaxy or Collections, a sync is performed
that downloads the required roles, consuming that much more space in
your /tmp file. In cases where you have a big project (around 10 GB),
disk space on <code>/tmp</code> may be an issue.</p>
</div>
<div class="paragraph">
<p>For more information on collections, refer to
<a href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html">Using
Collections</a>. For more information on how Red Hat itself publishes one
of these official collections, which can be used to automate your
automation controller install directly, refer to the
<a href="https://cloud.redhat.com/ansible/automation-hub/ansible/tower/docs">AWX
Ansible Collection</a> documentation. This page is accessible with your Red
Hat customer credentials as part of your Red Hat Ansible Automation
Platform subscription.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inventories"><a class="anchor" href="#_inventories"></a>19. Inventories</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <code>Inventory</code> is a collection of hosts against which jobs may be
launched, the same as an Ansible inventory file. Inventories are divided
into groups and these groups contain the actual hosts. Groups may be
sourced manually, by entering host names into the automation controller,
or from one of its supported cloud providers.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you have a custom dynamic inventory script, or a cloud provider that
is not yet supported natively in the controller, you can also import
that into the controller. Refer to <a href="#ag_inv_import">[ag_inv_import]</a> in the Automation
Controller Administration Guide.</p>
</div>
<div class="paragraph">
<p>The Inventories window displays a list of the inventories that are
currently available. The inventory list may be sorted by name and
searched type, organization, description, owners and modifiers of the
inventory, or additional criteria as needed.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-home-with-examples.png" alt="Inventories - home with examples"></span></p>
</div>
<div class="paragraph">
<p>The list of Inventory details includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: The inventory name. Clicking the Inventory name navigates to
the properties screen for the selected inventory, which shows the
inventory&#8217;s groups and hosts. (This view is also accessible from the
<span class="image"><img src="images/edit-button.png" alt="edit button"></span> icon.)</p>
</li>
<li>
<p><strong>Status</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The statuses are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Success</strong>: when the inventory source sync completed successfully</p>
</li>
<li>
<p><strong>Disabled</strong>: no inventory source added to the inventory</p>
</li>
<li>
<p><strong>Error</strong>: when the inventory source sync completed with error</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of inventories of various states, including one with detail
for a disabled state:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-home-with-status.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Type</strong>: Identifies whether it is a standard inventory or a Smart
Inventory.</p>
</li>
<li>
<p><strong>Organization</strong>: The organization to which the inventory belongs.</p>
</li>
<li>
<p><strong>Actions</strong>: The following actions are available for the selected
inventory:</p>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Edit</strong> (<span class="image"><img src="images/edit-button.png" alt="edit button"></span>): Edit the properties for the selected inventory</p>
</li>
<li>
<p><strong>Copy</strong> (): Makes a copy of an existing inventory as a template for
creating a new one</p>
</li>
</ul>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If deleting items that are used by other work items, a message opens
listing the items are affected by the deletion and prompts you to
confirm the deletion. Some screens will contain items that are invalid
or previously deleted, so they will fail to run. Below is an example of
such a message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/warning-deletion-dependencies.png" alt="image"></span></p>
</div>
<div class="sect2">
<h3 id="ug_inventories_smart"><a class="anchor" href="#ug_inventories_smart"></a>19.1. Smart Inventories</h3>
<div class="paragraph">
<p>A Smart Inventory is a collection of hosts defined by a stored search
that can be viewed like a standard inventory and made to be easily used
with job runs. Organization administrators have admin permission to
inventories in their organization and can create a Smart Inventories. A
Smart Inventory is identified by <code>KIND=smart</code>. You can define a Smart
Inventory using the same method being used with Search.
<code>InventorySource</code> is directly associated with an Inventory.</p>
</div>
<div class="paragraph">
<p>The <code>Inventory</code> model has the following new fields that are blank by
default but are set accordingly for Smart Inventories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kind</code> is set to <code>smart</code> for Smart Inventories</p>
</li>
<li>
<p><code>host_filter</code> is set AND <code>kind</code> is set to <code>smart</code> for Smart
Inventories.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>host</code> model has a related endpoint, <code>smart_inventories</code> that
identifies a set of all the Smart Inventory a host is associated with.
The membership table is updated every time a job runs against a smart
inventory.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>To update the memberships more frequently, you can change the file-based
setting <code>AWX_REBUILD_SMART_MEMBERSHIP</code> to <strong>True</strong> (default is False).
This will update memberships in the following events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a new host is added</p>
</li>
<li>
<p>an existing host is modified (updated or deleted)</p>
</li>
<li>
<p>a new Smart Inventory is added</p>
</li>
<li>
<p>an existing Smart Inventory is modified (updated or deleted)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can view actual inventories without being editable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Names of Host and Group created as a result of an inventory source
sync</p>
</li>
<li>
<p>Group records cannot be edited or moved</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You cannot create hosts from a Smart Inventory host endpoint
(<code>/inventories/N/hosts/</code>) as with a normal inventory. The administrator
of a Smart Inventory has permission to edit fields such as the name,
description, variables, and the ability to delete, but does not have the
permission to modify the <code>host_filter</code>, because that will affect which
hosts (that have a primary membership inside another inventory) are
included in the smart inventory. Note, <code>host_filter</code> only apply to hosts
inside of inventories inside of the Smart Inventory&#8217;s organization.</p>
</div>
<div class="paragraph">
<p>In order to modify the <code>host_filter</code>, you need to be the organization
administrator of the inventory&#8217;s organization. Organization admins
already have implicit "admin" access to all inventories inside the
organization, therefore, this does not convey any permissions they did
not already possess.</p>
</div>
<div class="paragraph">
<p>Administrators of the Smart Inventory can grant other users (who are not
also admins of your organization) permissions like "use" "adhoc" to the
smart inventory, and these will allow the actions indicate by the role,
just like other standard inventories. However, this will not give them
any special permissions to hosts (which live in a different inventory).
It will not allow them direct read permission to hosts, or permit them
to see additional hosts under <code>/#/hosts/</code>, although they can still view
the hosts under the smart inventory host list.</p>
</div>
<div class="paragraph">
<p>In some situations, you can modify the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new Host manually created on Inventory w/ inventory sources</p>
</li>
<li>
<p>In Groups that were created as a result of inventory source syncs</p>
</li>
<li>
<p>Variables on Host and Group are changeable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hosts associated with the Smart Inventory are manifested at view time.
If the results of a Smart Inventory contains more than one host with
identical hostnames, only one of the matching hosts will be included as
part of the Smart Inventory, ordered by Host ID.</p>
</div>
<div class="sect3">
<h4 id="ug_host_filters"><a class="anchor" href="#ug_host_filters"></a>19.1.1. Smart Host Filter</h4>
<div class="paragraph">
<p>You can use a search filter to populate hosts for an inventory. This
feature utilized the capability of the fact searching feature.</p>
</div>
<div class="paragraph">
<p>Facts generated by an Ansible playbook during a Job Template run are
stored by the automation controller into the database whenever
<code>use_fact_cache=True</code> is set per-Job Template. New facts are merged with
existing facts and are per-host. These stored facts can be used to
filter hosts via the <code>/api/v2/hosts</code> endpoint, using the <code>GET</code> query
parameter <code>host_filter</code> For example:
<code>/api/v2/hosts?host_filter=ansible_facts__ansible_processor_vcpus=8</code></p>
</div>
<div class="paragraph">
<p>The <code>host_filter</code> parameter allows for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>grouping via ()</p>
</li>
<li>
<p>use of the boolean and operator:</p>
<div class="ulist">
<ul>
<li>
<p><code>__</code> to reference related fields in relational fields</p>
</li>
<li>
<p><code>__</code> is used on ansible_facts to separate keys in a JSON key path</p>
</li>
<li>
<p>`[] is used to denote a json array in the path specification</p>
</li>
<li>
<p><code>""</code> can be used in the value when spaces are wanted in the value</p>
</li>
</ul>
</div>
</li>
<li>
<p>"classic" Django queries may be embedded in the <code>host_filter</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/api/v2/hosts/?host_filter=name=localhost
/api/v2/hosts/?host_filter=ansible_facts__ansible_date_time__weekday_number="3"
/api/v2/hosts/?host_filter=ansible_facts__ansible_processor[]="GenuineIntel"
/api/v2/hosts/?host_filter=ansible_facts__ansible_lo__ipv6[]__scope="host"
/api/v2/hosts/?host_filter=ansible_facts__ansible_processor_vcpus=8
/api/v2/hosts/?host_filter=ansible_facts__ansible_env__PYTHONUNBUFFERED="true"
/api/v2/hosts/?host_filter=(name=localhost or name=database) and (groups__name=east or groups__name="west coast") and ansible_facts__an</pre>
</div>
</div>
<div class="paragraph">
<p>You can search <code>host_filter</code> by host name, group name, and Ansible
facts.</p>
</div>
<div class="paragraph">
<p>The format for a group search is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groups.name:groupA</pre>
</div>
</div>
<div class="paragraph">
<p>The format for a fact search is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ansible_facts.ansible_fips:false</pre>
</div>
</div>
<div class="paragraph">
<p>You can also perform Smart Search searches, which consist a host name
and host description.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>host_filter=name=my_host</pre>
</div>
</div>
<div class="paragraph">
<p>If a search term in <code>host_filter</code> is of string type, to make the value a
number (e.g. <code>2.66</code>), or a JSON keyword (e.g. <code>null</code>, <code>true</code> or <code>false</code>)
valid, add double quotations around the value to prevent the controller
from mistakenly parsing it as a non-string:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>host_filter=ansible_facts__packages__dnsmasq[]__version="2.66"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ug_host_filter_facts"><a class="anchor" href="#ug_host_filter_facts"></a>19.1.2. Define host filter with ansible_facts</h4>
<div class="paragraph">
<p>To use <code>ansible_facts</code> to define the host filter when creating Smart
Inventories, perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <em>Create new smart inventory screen</em>, click the
<span class="image"><img src="images/search-button.png" alt="search"></span> button next
to the <strong>Smart host filter</strong> field to open a pop-up window to filter hosts
for this inventory.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-create-filter-highlighted.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the search pop-up window, change the search criteria from <strong>Name</strong> to
<strong>Advanced</strong> and select <strong>ansible_facts</strong> from the <strong>Key</strong> field.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-define-host-filter.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>If you wanted to add an ansible fact of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/api/v2/hosts/?host_filter=ansible_facts__ansible_processor[]="GenuineIntel"</pre>
</div>
</div>
<div class="paragraph">
<p>In the search field, enter <code>ansible_processor[]="GenuineIntel"</code> (no
extra spaces or <code>__</code> before the value) and press <strong>[Enter]</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-define-host-filter-facts.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The resulting search criteria for the specified ansible fact populates
in the lower part of the window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-define-host-filter-facts2.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Select</strong> to add it to the <strong>Smart host filter</strong> field.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-create-filter-added.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click <strong>Save</strong> to save the new Smart Inventory.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Details tab of the new Smart Inventory opens and displays the
specified ansible facts in the <strong>Smart host filter</strong> field.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-create-details.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>From the Details view, you can edit the <strong>Smart host filter</strong> field by
clicking <strong>Edit</strong> and delete existing filter(s), clear all existing
filters, or add new ones.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-smart-define-host-filter-facts-group.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_inventories_plugins"><a class="anchor" href="#ug_inventories_plugins"></a>19.2. Inventory Plugins</h3>
<div class="paragraph">
<p>Inventory updates use dynamically-generated YAML files which are parsed
by their respective inventory plugin. In Automation Controller Version
4.3.0, users can provide the new style inventory plugin config directly
to the controller via the inventory source <code>source_vars</code> for all the
following inventory sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#ug_source_ec2">Amazon Web Services EC2</a></p>
</li>
<li>
<p><a href="#ug_source_gce">Google Compute Engine</a></p>
</li>
<li>
<p><a href="#ug_source_azure">Microsoft Azure Resource Manager</a></p>
</li>
<li>
<p><a href="#ug_source_vmvcenter">VMware vCenter</a></p>
</li>
<li>
<p><a href="#ug_source_satellite">Red Hat Satellite 6</a></p>
</li>
<li>
<p><a href="#ug_source_insights">Red Hat Insights</a></p>
</li>
<li>
<p><a href="#ug_source_openstack">OpenStack</a></p>
</li>
<li>
<p><a href="#ug_source_rhv">Red Hat Virtualization</a></p>
</li>
<li>
<p><a href="#ug_source_tower">Red Hat Ansible Automation Platform</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Newly created configurations for inventory sources will contain the
default plugin configuration values. If you want your newly created
inventory sources in 3.8 to match the output of a 3.7 source, you must
apply a specific set of configuration values for that source. To ensure
backward compatibility, the controller uses "templates" for each of
these sources to force the output of inventory plugins into the legacy
format. Refer to <code>ir_inv_plugin_templates_reference</code> section of this
guide for each source and their respective templates to help you migrate
to the new style inventory plugin output.</p>
</div>
<div class="paragraph">
<p><code>source_vars</code> that contain <code>plugin: foo.bar.baz</code> as a top-level key will
be replaced with the appropriate fully-qualified inventory plugin name
at runtime based on the <code>InventorySource</code> source. For example, if ec2 is
selected for the <code>InventorySource</code> then, at run-time, plugin will be set
to <code>amazon.aws.aws_ec2</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="ug_inventories_add"><a class="anchor" href="#ug_inventories_add"></a>19.3. Add a new inventory</h3>
<div class="paragraph">
<p>Adding a new inventory involves several components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#ug_inventories_add_permissions">Add permissions</a></p>
</li>
<li>
<p><a href="#ug_inventories_add_groups">Add groups</a></p>
</li>
<li>
<p><a href="#ug_inventories_add_host">Add hosts</a></p>
</li>
<li>
<p><a href="#ug_inventories_add_source">Add source</a></p>
</li>
<li>
<p><a href="#ug_inventories_view_completed_jobs">View completed jobs</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a new inventory or Smart Inventory:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button, and select the type of inventory to create.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The type of inventory is identified at the top of the create form.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-new-inventory.png" alt="Inventories_create_new - create new inventory"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details into the following fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter a name appropriate for this inventory.</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional).</p>
</li>
<li>
<p><strong>Organization</strong>: Required. Choose among the available organizations.</p>
</li>
<li>
<p><strong>Smart Host Filter</strong>: (Only applicable to Smart Inventories) Click the
<span class="image"><img src="images/search-button.png" alt="search"></span> button to
open a separate window to filter hosts for this inventory. These options
are based on the organization you chose.</p>
<div class="paragraph">
<p>Filters are similar to tags in that tags are used to filter certain
hosts that contain those names. Therefore, to populate the <strong>Smart Host
Filter</strong> field, you are specifying a tag that contains the hosts you
want, not actually selecting the hosts themselves. Enter the tag in the
<strong>Search</strong> field and press [Enter]. Filters are case-sensitive. Refer to
the <a href="#ug_host_filters">Smart Host Filter</a> section for more information.</p>
</div>
</li>
<li>
<p><strong>Instance Groups</strong>: Click the
<span class="image"><img src="images/search-button.png" alt="search"></span> button to
open a separate window. Choose the instance groups for this inventory to
run on. If the list is extensive, use the search to narrow the options.</p>
</li>
<li>
<p><strong>Variables</strong>: Variable definitions and values to be applied to all
hosts in this inventory. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-new-saved-inventory.png" alt="Inventories_create_new_saved - create new inventory"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After saving the new inventory, you can proceed with configuring
permissions, groups, hosts, sources, and view completed jobs, if
applicable to the type of inventory. For more instructions, refer to the
subsequent sections.</p>
</div>
<div class="sect3">
<h4 id="ug_inventories_add_permissions"><a class="anchor" href="#ug_inventories_add_permissions"></a>19.3.1. Add permissions</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Select a user or team to add and click <strong>Next</strong></p>
</li>
<li>
<p>Select one or more users or teams from the list by clicking the check
box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-for-example-organization.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>In this example, two users have been selected to be added.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Select the role(s) you want the selected user(s) or team(s) to have.
Be sure to scroll down for a complete list of roles. Different resources
have different options available.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-roles.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or
team(s) and to add them as members.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Add Users/Teams window closes to display the updated roles assigned
for each user and team.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-tab-roles-assigned.png" alt="Permissions tab with Role Assignments"></span></p>
</div>
<div class="paragraph">
<p>To remove roles for a particular user, click the disassociate (x) button
next to its resource.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>This launches a confirmation dialog, asking you to confirm the
disassociation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate-confirm.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_inventories_add_groups"><a class="anchor" href="#ug_inventories_add_groups"></a>19.3.2. Add groups</h4>
<div class="paragraph">
<p>Inventories are divided into groups, which may contain hosts and other
groups, and hosts. Groups are only applicable to standard inventories
and is not a configurable directly through a Smart Inventory. You can
associate an existing group through host(s) that are used with standard
inventories. There are several actions available for standard
inventories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new Group</p>
</li>
<li>
<p>Create a new Host</p>
</li>
<li>
<p>Run a command on the selected Inventory</p>
</li>
<li>
<p>Edit Inventory properties</p>
</li>
<li>
<p>View activity streams for Groups and Hosts</p>
</li>
<li>
<p>Obtain help building your Inventory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Inventory sources are not associated with groups. Spawned groups are
top-level and may still have child groups, and all of these spawned
groups may have hosts.</p>
</div>
<div class="paragraph">
<p>To create a new group for an inventory:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button to open the <strong>Create Group</strong> window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-new.png" alt="Inventories_manage_group_add"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details into the required and optional fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Required</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional)</p>
</li>
<li>
<p><strong>Variables</strong>: Enter definitions and values to be applied to all hosts
in this group. Enter variables using either JSON or YAML syntax. Use the
radio button to toggle between the two.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>When done, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_add_groups_within_groups"><a class="anchor" href="#_add_groups_within_groups"></a>Add groups within groups</h5>
<div class="paragraph">
<p>To add groups within groups:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Related Groups</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Add</strong> button, and select whether to add a group that already
exists in your configuration or create a new group.</p>
</li>
<li>
<p>If creating a new group, enter the appropriate details into the
required and optional fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Required</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional)</p>
</li>
<li>
<p><strong>Variables</strong>: Enter definitions and values to be applied to all hosts
in this group. Enter variables using either JSON or YAML syntax. Use the
radio button to toggle between the two.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>When done, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <strong>Create Group</strong> window closes and the newly created group displays as
an entry in the list of groups associated with the group that it was
created for.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-subgroup-added.png" alt="Inventories add group subgroup"></span></p>
</div>
<div class="paragraph">
<p>If you chose to add an existing group, available groups will appear in a
separate selection window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-existing-subgroup.png" alt="Inventories add group existing subgroup"></span></p>
</div>
<div class="paragraph">
<p>Once a group is selected, it displays as an entry in the list of groups
associated with the group.</p>
</div>
<div class="paragraph">
<p>5. To configure additional groups and hosts under the subgroup,
click on the name of the subgroup from the list of groups and repeat the
same steps described in this section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_view_or_edit_inventory_groups"><a class="anchor" href="#_view_or_edit_inventory_groups"></a>View or edit inventory groups</h5>
<div class="paragraph">
<p>The list view displays all your inventory groups at once, or you can
filter it to only display the root group(s). An inventory group is
considered a root group if it is not a subset of another group.</p>
</div>
<div class="paragraph">
<p>You may be able to delete a subgroup without concern for dependencies,
since the controller will look for dependencies such as any child groups
or hosts. If any exists, a confirmation dialog displays for you to
choose whether to delete the root group and all of its subgroups and
hosts; or promote the subgroup(s) so they become the top-level inventory
group(s), along with their host(s).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-groups-delete-root-with-children.png" alt="image"></span></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ug_inventories_add_host"><a class="anchor" href="#ug_inventories_add_host"></a>19.3.3. Add hosts</h4>
<div class="paragraph">
<p>You can configure hosts for the inventory as well as for groups and
groups within groups. To configure hosts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Hosts</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Add</strong> button, and select whether to add a host that already
exists in your configuration or create a new host.</p>
</li>
<li>
<p>If creating a new host, select the
<span class="image"><img src="images/on-off-toggle-button.png" alt="toggle button"></span>
button to specify whether or not to include this host while running
jobs.</p>
</li>
<li>
<p>Enter the appropriate details into the required and optional fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Host Name</strong>: Required</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional)</p>
</li>
<li>
<p><strong>Variables</strong>: Enter definitions and values to be applied to all hosts
in this group. Enter variables using either JSON or YAML syntax. Use the
radio button to toggle between the two.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>When done, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <strong>Create Host</strong> window closes and the newly created host displays as
an entry in the list of hosts associated with the group that it was
created for.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-host-added.png" alt="Inventories add group host"></span></p>
</div>
<div class="paragraph">
<p>If you chose to add an existing host, available hosts will appear in a
separate selection window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-existing-host.png" alt="Inventories add existing host"></span></p>
</div>
<div class="paragraph">
<p>Once a host is selected, it displays as an entry in the list of hosts
associated with the group. You can disassociate a host from this screen
by selecting the host and click the <strong>Disassociate</strong> button.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>You may also run ad hoc commands from this screen. Refer to
<a href="#ug_inventories_run_ad_hoc">Running Ad Hoc Commands</a> for more detail.</p>
</div>
<div class="paragraph">
<p>6. To configure additional groups for the host, click on the name
of the host from the list of hosts.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-host-added-emphasized.png" alt="Inventories add group host emphasized"></span></p>
</div>
<div class="paragraph">
<p>This opens the Details tab of the selected host.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-host-details.png" alt="Inventories add group host details"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Click the <strong>Groups</strong> tab to configure groups for the host.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the <strong>Add</strong> button to associate the host with an existing group.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Available groups appear in a separate selection window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-hosts-add-groups.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="2">
<li>
<p>Click to select the group(s) to associate with the host and click
<strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once a group is associated, it displays as an entry in the list of
groups associated with the host.</p>
</div>
</div>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>If a host was used to run a job, you can view details about those jobs
in the <strong>Completed Jobs</strong> tab of the host and click <strong>Expanded</strong> to view
details about each job.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-host-view-completed-jobs.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="ug_inventories_add_source"><a class="anchor" href="#ug_inventories_add_source"></a>19.3.4. Add source</h4>
<div class="paragraph">
<p>Inventory sources are not associated with groups. Spawned groups are
top-level and may still have child groups, and all of these spawned
groups may have hosts. Adding a source to an inventory only applies to
standard inventories. Smart inventories inherit their source from the
standard inventories they are associated with. To configure the source
for the inventory:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the inventory you want to add a source, click the <strong>Sources</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Add</strong> button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This opens the Create Source window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source.png" alt="Inventories create source"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Enter the appropriate details into the required and optional fields:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Required</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional)</p>
</li>
<li>
<p><strong>Execution Environment</strong>: Optionally search
(<span class="image"><img src="images/search-button.png" alt="search"></span>) or enter
the name of the execution environment with which you want to run your
inventory imports. Refer to the <a href="#ug_execution_environments">[ug_execution_environments]</a> section for
details on building an execution environment.</p>
</li>
<li>
<p><strong>Source</strong>: Choose a source for your inventory. Refer to the
<a href="#ug_inventory_sources">Inventory Sources</a> section for more information about each source
and details for entering the appropriate information.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div id="ug_add_inv_common_fields" class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>After completing the required information for your chosen
<code>inventory source &lt;ug_inventory_sources&gt;</code>, you can continue to
optionally specify other common parameters, such as verbosity, host
filters, and variables.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The <strong>Regions</strong>, <strong>Instance Filters</strong>, and <strong>Only Group By</strong> fields have been
removed in automation controller 3.8.</p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Select the appropriate level of output on any inventory source&#8217;s
update jobs from the <strong>Verbosity</strong> drop-down menu.</p>
</li>
<li>
<p>Use the <strong>Host Filter</strong> field to specify only matching host names to be
imported into the controller.</p>
</li>
<li>
<p>In the <strong>Enabled Variable</strong>, specify the controller to retrieve the
enabled state from the given dictionary of host variables. The enabled
variable may be specified using dot notation as 'foo.bar', in which case
the lookup will traverse into nested dicts, equivalent to:
<code>from_dict.get('foo', {}).get('bar', default)</code>.</p>
</li>
<li>
<p>If you specified a dictionary of host variables in the <strong>Enabled
Variable</strong> field, you can provide a value to enable on import. For
example, if <code>enabled_var='status.power_state'</code> and
<code>enabled_value='powered_on'</code> with the following host variables, the host
would be marked enabled:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="literalblock">
<div class="content">
<pre>{
"status": {
"power_state": "powered_on",
"created": "2020-08-04T18:13:04+00:00",
"healthy": true
},
"name": "foobar",
"ip_address": "192.168.2.1"
}</pre>
</div>
</div>
<div class="paragraph">
<p>If <code>power_state</code> were any value other than <code>powered_on</code>, then the host
would be disabled when imported into the controller. If the key is not
found, then the host will be enabled.</p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>All cloud inventory sources have the following update options:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Overwrite</strong>: If checked, any hosts and groups that were previously
present on the external source but are now removed, will be removed from
the controller inventory. Hosts and groups that were not managed by the
inventory source will be promoted to the next manually created group, or
if there is no manually created group to promote them into, they will be
left in the "all" default group for the inventory.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>When not checked, local child hosts and groups not found on the external
source will remain untouched by the inventory update process.</p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Overwrite Variables</strong>: If checked, all variables for child groups and
hosts will be removed and replaced by those found on the external
source. When not checked, a merge will be performed, combining local
variables with those found on the external source.</p>
</li>
<li>
<p><strong>Update on Launch</strong>: Each time a job runs using this inventory, refresh
the inventory from the selected source before executing job tasks. To
avoid job overflows if jobs are spawned faster than the inventory can
sync, selecting this allows you to configure a <strong>Cache Timeout</strong> to cache
prior inventory syncs for a certain number of seconds.</p>
</li>
</ul>
</div>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The "Update on Launch" setting refers to a dependency system for
projects and inventory, and it will not specifically exclude two jobs
from running at the same time. If a cache timeout is specified, then the
dependencies for the second job is created and it uses the project and
inventory update that the f.adoc[] job spawned. Both jobs then wait for
that project and/or inventory update to finish before proceeding. If
they are different job templates, they can then both start and run at
the same time, if the system has the capacity to do so. If you intend to
use the controller&#8217;s provisioning callback feature with a dynamic
inventory source, <strong>Update on Launch</strong> should be set for the inventory
group.</p>
</div>
<div class="paragraph">
<p>If you sync an inventory source that uses a project that has <strong>Update On
Launch</strong> set, then the project may automatically update (according to
cache timeout rules) before the inventory update starts.</p>
</div>
<div class="paragraph">
<p>You can create a job template that uses an inventory that sources from
the same project that the template uses. In this case, the project will
update and then the inventory will update (if updates are not already
in-progress, or if the cache timeout has not already expired).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">

</div>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Review your entries and selections and click <strong>Save</strong> when done. This
allows you to configure additional details, such as schedules and
notifications.</p>
</li>
<li>
<p>To configure schedules associated with this inventory source, click
the <strong>Schedules</strong> tab.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If schedules are already set up; review, edit, or enable/disable your
schedule preferences.</p>
</li>
<li>
<p>if schedules have not been set up, refer to <a href="#ug_scheduling">[ug_scheduling]</a> for more
information.</p>
</li>
</ol>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The <strong>Notifications</strong> tab is only present after you save the newly-created
source.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-with-notifications-tab.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p>To configure notifications for the source, click the <strong>Notifications</strong>
tab.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If notifications are already set up, use the toggles to enable or
disable the notifications to use with your particular source. For more
detail, see <a href="#ug_notifications_on_off">[ug_notifications_on_off]</a>.</p>
</li>
<li>
<p>if notifications have not been set up, refer to <a href="#ug_notifications">[ug_notifications]</a> for
more information.</p>
</li>
</ol>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="13">
<li>
<p>Review your entries and selections and click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once a source is defined, it displays as an entry in the list of sources
associated with the inventory. From the <strong>Sources</strong> tab you can perform a
sync on a single source, or sync all of them at once. You can also
perform additional actions such as scheduling a sync process, and edit
or delete the source.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-view-sources.png" alt="Inventories view sources"></span></p>
</div>
<div class="sect4">
<h5 id="ug_inventory_sources"><a class="anchor" href="#ug_inventory_sources"></a>Inventory Sources</h5>
<div class="paragraph">
<p>Choose a source which matches the inventory type against which a host
can be entered:</p>
</div>
<div class="sect5">
<h6 id="_sourced_from_a_project"><a class="anchor" href="#_sourced_from_a_project"></a>Sourced from a Project</h6>
<div class="paragraph">
<p>An inventory that is sourced from a project means that is uses the SCM
type from the project it is tied to. For example, if the project&#8217;s
source is from GitHub, then the inventory will use the same source.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a project-sourced inventory, select <strong>Sourced from a
Project</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with additional fields. Enter the
following details:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Credential</strong>: Optionally specify the credential to use for this
source.</p>
</li>
<li>
<p><strong>Project</strong>: Required. Specify the project this inventory is using as
its source. Click the
<span class="image"><img src="images/search-button.png" alt="search"></span> button to
choose from a list of projects. If the list is extensive, use the search
to narrow the options.</p>
</li>
<li>
<p><strong>Inventory File</strong>: Required. Select an inventory file associated with
the sourced project. If not already populated, you can type it into the
text field within the drop down menu to filter the extraneous file
types. In addition to a flat file inventory, you can point to a
directory or an inventory script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-sourced-from-project-filter.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>In order to pass to the custom inventory script, you can optionally
set environment variables in the <strong>Environment Variables</strong> field. You may
also place inventory scripts in source control and then run it from a
project. See <a href="#ag_inv_import">[ag_inv_import]</a> in the Automation Controller Administration
Guide for detail.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-sourced-from-project-example.png" alt="Inventories - create source - sourced from project example"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you are executing a custom inventory script from SCM, please make
sure you set the execution bit (i.e. <code>chmod +x</code>) on the script in your
upstream source control. If you do not, the controller will throw a
<code>[Errno 13] Permission denied</code> error upon execution.</p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_ec2"><a class="anchor" href="#ug_source_ec2"></a>Amazon Web Services EC2</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure an AWS EC2-sourced inventory, select <strong>Amazon EC2</strong> from
the Source field.</p>
</li>
<li>
<p>The Create Source window expands with additional fields. Enter the
following details:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Credential</strong>: Optionally choose from an existing AWS credential (for
more information, refer to <a href="#ug_credentials">Credentials</a>).</p>
<div class="paragraph">
<p>If the controller is running on an EC2 instance with an assigned IAM
Role, the credential may be omitted, and the security credentials from
the instance metadata will be used instead. For more information on
using IAM Roles, refer to the
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-%20roles-for-amazon-ec2.html">IAM_Roles_for_Amazon_EC2_documentation_at_Amazon</a>.</p>
</div>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>aws_ec2</code> inventory plugin. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, view the
<a href="https://cloud.redhat.com/ansible/automation-hub/repo/published/amazon/aws/content/inventory/aws_ec2">aws_ec2
inventory plugin documenation</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-AWS-example.png" alt="Inventories - create source - AWS EC2 example"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you only use <code>include_filters</code>, the AWS plugin always returns all the
hosts. To use this properly, the f.adoc[] condition on the <code>or</code> must be on
<code>filters</code> and then build the rest of the <code>OR</code> conditions on a list of
<code>include_filters</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_gce"><a class="anchor" href="#ug_source_gce"></a>Google Compute Engine</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a Google-sourced inventory, select <strong>Google Compute
Engine</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing GCE Credential. For more information, refer to
<a href="#ug_credentials">Credentials</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-GCE-example.png" alt="Inventories - create source - GCE example"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>gcp_compute</code> inventory plugin. Enter variables using either JSON or
YAML syntax. Use the radio button to toggle between the two. For a
detailed description of these variables, view the
<a href="https://cloud.redhat.com/ansible/automation-hub/repo/published/google/cloud/content/inventory/gcp_compute">gcp_compute
inventory plugin documenation</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_azure"><a class="anchor" href="#ug_source_azure"></a>Microsoft Azure Resource Manager</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a Azure Resource Manager-sourced inventory, select
<strong>Microsoft Azure Resource Manager</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing Azure Credential. For more information, refer to
<a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>azure_rm</code> inventory plugin. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, view the
<a href="https://cloud.redhat.com/ansible/automation-hub/repo/published/azure/azcollection/content/inventory/azure_rm">azure_rm
inventory plugin documentation</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-azurerm-example.png" alt="Inventories - create source - Azure RM example"></span></p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_vmvcenter"><a class="anchor" href="#ug_source_vmvcenter"></a>VMware vCenter</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a VMWare-sourced inventory, select <strong>VMware vCenter</strong> from
the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing VMware Credential. For more information, refer
to <a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>vmware_inventory</code> inventory plugin. Enter variables using either JSON
or YAML syntax. Use the radio button to toggle between the two. For a
detailed description of these variables, view the
<a href="https://github.com/ansible-collections/community.vmware/blob/main/plugins/inventory/vmware_vm_inventory.py">vmware_inventory
inventory plugin</a>.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Starting with Ansible 2.9, VMWare properties have changed from lower
case to camelCase. The controller provides aliases for the top-level
keys, but lower case keys in nested properties have been discontinued.
For a list of valid and supported properties starting with Ansible 2.9,
refer to the primary
<a href="https://github.com/ansible/ansible/blob/devel/docs/docsite.adoc" class="bare">https://github.com/ansible/ansible/blob/devel/docs/docsite.adoc</a>/scenario_guides/vmware_scenarios/vmware_inventory_vm_attributes.adoc[][documentation
for hostvars from VMWare inventory imports] in GitHub.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-vmware-example.png" alt="Inventories - create source - VMWare example"></span></p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_satellite"><a class="anchor" href="#ug_source_satellite"></a>Red Hat Satellite 6</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a Red Hat Satellite-sourced inventory, select <strong>Red Hat
Satellite</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing Satellite Credential. For more information,
refer to <a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to specify parameters used by the
foreman inventory source. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, refer to the
<a href="https://docs.ansible.com/ansible/latest/collections/theforeman/foreman/foreman_inventory.html">theforeman.foreman.foreman
â Foreman inventory source</a> in the Ansible documentation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-rhsat6-example.png" alt="Inventories - create source - RH Satellite example"></span></p>
</div>
<div class="paragraph">
<p>If you encounter an issue with the controller inventory not having the
"related groups" from Satellite, you might need to define these
variables in the inventory source. See the inventory plugins template
example for <code>ir_plugin_satellite</code> in the Ansible Automation Platform
Installation and Reference Guide for detail.</p>
</div>
<div class="paragraph">
<p>If you see the message,
<code>"no foreman.id" variable(s) when syncing the inventory</code>, refer to the
solution on the Red Hat Customer Portal at:
<a href="https://access.redhat.com/solutions/5826451" class="bare">https://access.redhat.com/solutions/5826451</a>. Be sure to login with your
customer credentials to access the full article.</p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_insights"><a class="anchor" href="#ug_source_insights"></a>Red Hat Insights</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a Red Hat Insights-sourced inventory, select <strong>Red Hat
Insights</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing Insights Credential. For more information, refer
to <a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>insights</code> inventory plugin. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, view the
<a href="https://cloud.redhat.com/ansible/automation-hub/repo/published/redhat/insights/content/inventory/insights">insights
inventory plugin</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-insights-example.png" alt="Inventories - create source - RH Insights example"></span></p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_openstack"><a class="anchor" href="#ug_source_openstack"></a>OpenStack</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure an OpenStack-sourced inventory, select <strong>OpenStack</strong> from
the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing OpenStack Credential. For more information,
refer to <a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>openstack</code> inventory plugin. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, view the
<a href="https://docs.ansible.com/ansible/latest/collections/openstack/cloud/openstack_inventory.html">openstack
inventory plugin</a> in the Ansible collections documentation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-openstack-example.png" alt="Inventories - create source - OpenStack example"></span></p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_rhv"><a class="anchor" href="#ug_source_rhv"></a>Red Hat Virtualization</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a Red Hat Virtualization-sourced inventory, select <strong>Red
Hat Virtualization</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing Red Hat Virtualization Credential. For more
information, refer to <a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>ovirt</code> inventory plugin. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, view the
<a href="https://cloud.redhat.com/ansible/automation-hub/repo/published/redhat/rhv/content/inventory/ovirt">ovirt
inventory plugin</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-rhv-example.png" alt="Inventories - create source - RHV example"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Red Hat Virtualization (ovirt) inventory source requests are secure by
default. To change this default setting, set the key <code>ovirt_insecure</code> to
<strong>true</strong> in <code>source_variables</code>, which is only available from the API
details of the inventory source at the <code>/api/v2/inventory_sources/N/</code>
endpoint.</p>
</div>
</div>
<div class="sect5">
<h6 id="ug_source_tower"><a class="anchor" href="#ug_source_tower"></a>Red Hat Ansible Automation Platform</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To configure a automation controller-sourced inventory, select <strong>Red
Hat Ansible Automation Platform</strong> from the Source field.</p>
</li>
<li>
<p>The Create Source window expands with the required <strong>Credential</strong> field.
Choose from an existing Ansible Automation Platform Credential. For more
information, refer to <a href="#ug_credentials">Credentials</a>.</p>
</li>
<li>
<p>You can optionally specify the verbosity, host filter, enabled
variable/value, and update options as described in the main procedure
for <code>adding a source &lt;ug_add_inv_common_fields&gt;</code>.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-create-source-rhaap-example.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Use the <strong>Source Variables</strong> field to override variables used by the
<code>controller</code> inventory plugin. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two. For a detailed
description of these variables, view the
<a href="https://cloud.redhat.com/ansible/automation-hub/repo/published/ansible/controller/content/inventory/controller">controller
inventory plugin</a> (requires your Red Hat Customer login).</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ug_customscripts"><a class="anchor" href="#ug_customscripts"></a>Export old inventory scripts</h5>
<div class="paragraph">
<p>Despite the removal of the custom inventory scripts API, the scripts are
still saved in the database. The commands described in this section
allows you to recover the scripts in a format that is suitable for you
to subsequently check into source control. Usage looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ awx-manage export_custom_scripts --filename=my_scripts.tar
Dump of old custom inventory scripts at my_scripts.tar</pre>
</div>
</div>
<div class="paragraph">
<p>Making use of the output:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mkdir my_scripts
$ tar -xf my_scripts.tar -C my_scripts</pre>
</div>
</div>
<div class="paragraph">
<p>The naming of the scripts is <code><em>&lt;pk&gt;_</em>&lt;name&gt;</code>. This is the naming scheme
used for project folders.</p>
</div>
<div class="paragraph">
<p>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ls my_scripts
_10__inventory_script_rawhook             _19__                                       _30__inventory_script_listenhospital
_11__inventory_script_upperorder          _1__inventory_script_commercialinternet45   _4__inventory_script_whitestring
_12__inventory_script_eastplant           _22__inventory_script_pinexchange           _5__inventory_script_literaturepossession
_13__inventory_script_governmentculture   _23__inventory_script_brainluck             _6__inventory_script_opportunitytelephone
_14__inventory_script_bottomguess         _25__inventory_script_buyerleague           _7__inventory_script_letjury
_15__inventory_script_wallisland          _26__inventory_script_lifesport             _8__random_inventory_script_
_16__inventory_script_wallisland          _27__inventory_script_exchangesomewhere     _9__random_inventory_script_
_17__inventory_script_bidstory            _28__inventory_script_boxchild
_18__p                                    _29__inventory_script_we.adoc[]ress</pre>
</div>
</div>
<div class="paragraph">
<p>Each file contains a script. Scripts can be <code>bash/python/ruby/more</code>, so
the extension is not included. They are all directly executable
(assuming the scripts worked). If you execute the script, it dumps the
inventory data.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ./my_scripts/_11__inventory_script_upperorder
{"group_\ud801\udcb0\uc20e\u7b0e\ud81c\udfeb\ub12b\ub4d0\u9ac6\ud81e\udf07\u6ff9\uc17b": {"hosts":
["host_\ud821\udcad\u68b6\u7a51\u93b4\u69cf\uc3c2\ud81f\uddbe\ud820\udc92\u3143\u62c7",
"host_\u6057\u3985\u1f60\ufefb\u1b22\ubd2d\ua90c\ud81a\udc69\u1344\u9d15",
"host_\u78a0\ud820\udef3\u925e\u69da\ua549\ud80c\ude7e\ud81e\udc91\ud808\uddd1\u57d6\ud801\ude57",
"host_\ud83a\udc2d\ud7f7\ua18a\u779a\ud800\udf8b\u7903\ud820\udead\u4154\ud808\ude15\u9711",
"host_\u18a1\u9d6f\u08ac\u74c2\u54e2\u740e\u5f02\ud81d\uddee\ufbd6\u4506"], "vars": {"ansible_host": "127.0.0.1", "ansible_connection":
"local"}}}</pre>
</div>
</div>
<div class="paragraph">
<p>You can verify functionality with <code>ansible-inventory</code>. This should give
the same data, but reformatted.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ansible-inventory -i ./my_scripts/_11__inventory_script_upperorder --list --export</pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, you could <code>cd</code> into <code>my_scripts</code> and then issue a
<code>git init</code> command, add the scripts you want, push it to source control,
and then create an SCM inventory source in the automation controller
user interface.</p>
</div>
<div class="paragraph">
<p>For more information on syncing or using custom inventory scripts, refer
to <a href="#ag_inv_import` in the">[ag_inv_import` in the]</a> in the Automation Controller Administration
Guide.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ug_inventories_view_completed_jobs"><a class="anchor" href="#ug_inventories_view_completed_jobs"></a>19.3.5. View completed jobs</h4>
<div class="paragraph">
<p>If an inventory was used to run a job, you can view details about those
jobs in the <strong>Completed Jobs</strong> tab of the inventory and click <strong>Expanded</strong>
to view details about each job.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-view-completed-jobs.png" alt="Inventories view completed jobs"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_inventories_run_ad_hoc"><a class="anchor" href="#ug_inventories_run_ad_hoc"></a>19.4. Running Ad Hoc Commands</h3>
<div class="paragraph">
<p>To run an ad hoc command:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select an inventory source from the list of hosts or groups. The
inventory source can be a single group or host, a selection of multiple
hosts, or a selection of multiple groups.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/inventories-add-group-host-added.png" alt="ad hoc-commands-inventory-home"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the <strong>Run Command</strong> button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Run command window opens.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ad-hoc-run-execute-command.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Enter the details for the following fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Module</strong>: Select one of the modules that the automation controller
supports running commands against.</p>
<div class="paragraph">
<p>------------------------------------------------+ | command |
apt_repository | mount | win_service |
------------------------------------------------+ | shell | apt_rpm
| ping | win_updates |
------------------------------------------------+ | yum | service |
selinux | win_group |
------------------------------------------------+ | apt | group |
setup | win_user | ----------------------------------- + | apt_key |
user | win_ping | |
------------------------------------------------+</p>
</div>
</li>
<li>
<p><strong>Arguments</strong>: Provide arguments to be used with the module you
selected.</p>
</li>
<li>
<p><strong>Limit</strong>: Enter the limit used to target hosts in the inventory. To
target all hosts in the inventory enter <code>all</code> or <code>*</code>, or leave the field
blank. This is automatically populated with whatever was selected in the
previous view prior to clicking the launch button.</p>
</li>
<li>
<p><strong>Machine Credential</strong>: Select the credential to use when accessing the
remote hosts to run the command. Choose the credential containing the
username and SSH key or password that Ansbile needs to log into the
remote hosts.</p>
</li>
<li>
<p><strong>Verbosity</strong>: Select a verbosity level for the standard output.</p>
</li>
<li>
<p><strong>Forks</strong>: If needed, select the number of parallel or simultaneous
processes to use while executing the command.</p>
</li>
<li>
<p><strong>Show Changes</strong>: Select to enable the display of Ansible changes in the
standard output. The default is OFF.</p>
</li>
<li>
<p><strong>Enable Privilege Escalation</strong>: If enabled, the playbook is run with
administrator privileges. This is the equivalent of passing the
<code>--become</code> option to the <code>ansible</code> command.</p>
</li>
<li>
<p><strong>Extra Variables</strong>: Provide extra command line variables to be applied
when running this inventory. Enter variables using either JSON or YAML
syntax. Use the radio button to toggle between the two.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ad-hoc-commands-inventory-run-command.png" alt="ad hoc-commands-inventory-run-command"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click <strong>Next</strong> to choose the execution environment you want the ad-hoc
command to be run against.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ad-hoc-commands-inventory-run-command-ee.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click <strong>Next</strong> to choose the credential you want to use and click the
<strong>Launch</strong> button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The results display in the <strong>Output</strong> tab of the module&#8217;s job window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/ad-hoc-commands-inventory-results-example.png" alt="ad hoc-commands-inventory-results-example"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ir_inv_plugin_templates_reference"><a class="anchor" href="#ir_inv_plugin_templates_reference"></a>20. Supported Inventory Plugin Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Upon upgrade to 4.x, existing configurations will be migrated to the new
format that will produce a backwards compatible inventory output. Use
the templates below to help aid in migrating your inventories to the new
style inventory plugin output.</p>
</div>
<div class="sect2">
<h3 id="_amazon_web_services_ec2"><a class="anchor" href="#_amazon_web_services_ec2"></a>20.1. Amazon Web Services EC2</h3>
<div class="literalblock">
<div class="content">
<pre>compose:
  ansible_host: public_ip_address
  ec2_account_id: owner_id
  ec2_ami_launch_index: ami_launch_index | string
  ec2_architecture: architecture
  ec2_block_devices: dict(block_device_mappings | map(attribute='device_name') | list | zip(block_device_mappings | map(attribute='ebs.volume_id') | list))
  ec2_client_token: client_token
  ec2_dns_name: public_dns_name
  ec2_ebs_optimized: ebs_optimized
  ec2_eventsSet: events | default("")
  ec2_group_name: placement.group_name
  ec2_hypervisor: hypervisor
  ec2_id: instance_id
  ec2_image_id: image_id
  ec2_instance_profile: iam_instance_profile | default("")
  ec2_instance_type: instance_type
  ec2_ip_address: public_ip_address
  ec2_kernel: kernel_id | default("")
  ec2_key_name: key_name
  ec2_launch_time: launch_time | regex_replace(" ", "T") | regex_replace("(\+)(\d\d):(\d)(\d)$", ".\g&lt;2&gt;\g&lt;3&gt;Z")
  ec2_monitored: monitoring.state in ['enabled', 'pending']
  ec2_monitoring_state: monitoring.state
  ec2_persistent: persistent | default(false)
  ec2_placement: placement.availability_zone
  ec2_platform: platform | default("")
  ec2_private_dns_name: private_dns_name
  ec2_private_ip_address: private_ip_address
  ec2_public_dns_name: public_dns_name
  ec2_ramdisk: ramdisk_id | default("")
  ec2_reason: state_transition_reason
  ec2_region: placement.region
  ec2_requester_id: requester_id | default("")
  ec2_root_device_name: root_device_name
  ec2_root_device_type: root_device_type
  ec2_security_group_ids: security_groups | map(attribute='group_id') | list |  join(',')
  ec2_security_group_names: security_groups | map(attribute='group_name') | list |  join(',')
  ec2_sourceDestCheck: source_dest_check | default(false) | lower | string
  ec2_spot_instance_request_id: spot_instance_request_id | default("")
  ec2_state: state.name
  ec2_state_code: state.code
  ec2_state_reason: state_reason.message if state_reason is defined else ""
  ec2_subnet_id: subnet_id | default("")
  ec2_tag_Name: tags.Name
  ec2_virtualization_type: virtualization_type
  ec2_vpc_id: vpc_id | default("")
filters:
  instance-state-name:
  - running
groups:
  ec2: true
hostnames:
  - network-interface.addresses.association.public-ip
  - dns-name
  - private-dns-name
keyed_groups:
  - key: image_id | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: images
    prefix: ''
    separator: ''
  - key: placement.availability_zone
    parent_group: zones
    prefix: ''
    separator: ''
  - key: ec2_account_id | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: accounts
    prefix: ''
    separator: ''
  - key: ec2_state | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: instance_states
    prefix: instance_state
  - key: platform | default("undefined") | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: platforms
    prefix: platform
  - key: instance_type | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: types
    prefix: type
  - key: key_name | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: keys
    prefix: key
  - key: placement.region
    parent_group: regions
    prefix: ''
    separator: ''
  - key: security_groups | map(attribute="group_name") | map("regex_replace", "[^A-Za-z0-9\_]", "_") | list
    parent_group: security_groups
    prefix: security_group
  - key: dict(tags.keys() | map("regex_replace", "[^A-Za-z0-9\_]", "_") | list | zip(tags.values()
      | map("regex_replace", "[^A-Za-z0-9\_]", "_") | list))
    parent_group: tags
    prefix: tag
  - key: tags.keys() | map("regex_replace", "[^A-Za-z0-9\_]", "_") | list
    parent_group: tags
    prefix: tag
  - key: vpc_id | regex_replace("[^A-Za-z0-9\_]", "_")
    parent_group: vpcs
    prefix: vpc_id
  - key: placement.availability_zone
    parent_group: '{{ placement.region }}'
    prefix: ''
    separator: ''
plugin: amazon.aws.aws_ec2
use_contrib_script_compatible_sanitization: true</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_google_compute_engine_2"><a class="anchor" href="#_google_compute_engine_2"></a>20.2. Google Compute Engine</h3>
<div class="literalblock">
<div class="content">
<pre>auth_kind: serviceaccount
compose:
  ansible_ssh_host: networkInterfaces[0].accessConfigs[0].natIP | default(networkInterfaces[0].networkIP)
  gce_description: description if description else None
  gce_id: id
  gce_image: image
  gce_machine_type: machineType
  gce_metadata: metadata.get("items", []) | items2dict(key_name="key", value_name="value")
  gce_name: name
  gce_network: networkInterfaces[0].network.name
  gce_private_ip: networkInterfaces[0].networkIP
  gce_public_ip: networkInterfaces[0].accessConfigs[0].natIP | default(None)
  gce_status: status
  gce_subnetwork: networkInterfaces[0].subnetwork.name
  gce_tags: tags.get("items", [])
  gce_zone: zone
hostnames:
- name
- public_ip
- private_ip
keyed_groups:
- key: gce_subnetwork
  prefix: network
- key: gce_private_ip
  prefix: ''
  separator: ''
- key: gce_public_ip
  prefix: ''
  separator: ''
- key: machineType
  prefix: ''
  separator: ''
- key: zone
  prefix: ''
  separator: ''
- key: gce_tags
  prefix: tag
- key: status | lower
  prefix: status
- key: image
  prefix: ''
  separator: ''
plugin: google.cloud.gcp_compute
retrieve_image_info: true
use_contrib_script_compatible_sanitization: true</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_microsoft_azure_resource_manager_2"><a class="anchor" href="#_microsoft_azure_resource_manager_2"></a>20.3. Microsoft Azure Resource Manager</h3>
<div class="literalblock">
<div class="content">
<pre>conditional_groups:
  azure: true
default_host_filters: []
fail_on_template_errors: false
hostvar_expressions:
  computer_name: name
  private_ip: private_ipv4_addresses[0] if private_ipv4_addresses else None
  provisioning_state: provisioning_state | title
  public_ip: public_ipv4_addresses[0] if public_ipv4_addresses else None
  public_ip_id: public_ip_id if public_ip_id is defined else None
  public_ip_name: public_ip_name if public_ip_name is defined else None
  tags: tags if tags else None
  type: resource_type
keyed_groups:
- key: location
  prefix: ''
  separator: ''
- key: tags.keys() | list if tags else []
  prefix: ''
  separator: ''
- key: security_group
  prefix: ''
  separator: ''
- key: resource_group
  prefix: ''
  separator: ''
- key: os_disk.operating_system_type
  prefix: ''
  separator: ''
- key: dict(tags.keys() | map("regex_replace", "^(.*)$", "\1_") | list | zip(tags.values() | list)) if tags else []
  prefix: ''
  separator: ''
plain_host_names: true
plugin: azure.azcollection.azure_rm
use_contrib_script_compatible_sanitization: true</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vmware_vcenter_2"><a class="anchor" href="#_vmware_vcenter_2"></a>20.4. VMware vCenter</h3>
<div class="literalblock">
<div class="content">
<pre>compose:
  ansible_host: guest.ipAddress
  ansible_ssh_host: guest.ipAddress
  ansible_uuid: 99999999 | random | to_uuid
  availablefield: availableField
  configissue: configIssue
  configstatus: configStatus
  customvalue: customValue
  effectiverole: effectiveRole
  guestheartbeatstatus: guestHeartbeatStatus
  layoutex: layoutEx
  overallstatus: overallStatus
  parentvapp: parentVApp
  recenttask: recentTask
  resourcepool: resourcePool
  rootsnapshot: rootSnapshot
  triggeredalarmstate: triggeredAlarmState
filters:
- runtime.powerState == "poweredOn"
keyed_groups:
- key: config.guestId
  prefix: ''
  separator: ''
- key: '"templates" if config.template else "guests"'
  prefix: ''
  separator: ''
plugin: community.vmware.vmware_vm_inventory
properties:
- availableField
- configIssue
- configStatus
- customValue
- datastore
- effectiveRole
- guestHeartbeatStatus
- layout
- layoutEx
- name
- network
- overallStatus
- parentVApp
- permission
- recentTask
- resourcePool
- rootSnapshot
- snapshot
- triggeredAlarmState
- value
- capability
- config
- guest
- runtime
- storage
- summary
strict: false
with_nested_properties: true</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ir_plugin_satellite"><a class="anchor" href="#ir_plugin_satellite"></a>20.5. Red Hat Satellite 6</h3>
<div class="literalblock">
<div class="content">
<pre>group_prefix: foreman_
keyed_groups:
- key: foreman['environment_name'] | lower | regex_replace(' ', '') | regex_replace('[^A-Za-z0-9_]', '_') | regex_replace('none', '')
  prefix: foreman_environment_
  separator: ''
- key: foreman['location_name'] | lower | regex_replace(' ', '') | regex_replace('[^A-Za-z0-9_]', '_')
  prefix: foreman_location_
  separator: ''
- key: foreman['organization_name'] | lower | regex_replace(' ', '') | regex_replace('[^A-Za-z0-9_]', '_')
  prefix: foreman_organization_
  separator: ''
- key: foreman['content_facet_attributes']['lifecycle_environment_name'] | lower | regex_replace(' ', '') | regex_replace('[^A-Za-z0-9_]', '_')
  prefix: foreman_lifecycle_environment_
  separator: ''
- key: foreman['content_facet_attributes']['content_view_name'] | lower | regex_replace(' ', '') | regex_replace('[^A-Za-z0-9_]', '_')
  prefix: foreman_content_view_
  separator: ''
legacy_hostvars: true
plugin: theforeman.foreman.foreman
validate_certs: false
want_facts: true
want_hostcollections: false
want_params: true</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openstack_2"><a class="anchor" href="#_openstack_2"></a>20.6. OpenStack</h3>
<div class="literalblock">
<div class="content">
<pre>expand_hostvars: true
fail_on_errors: true
inventory_hostname: uuid
plugin: openstack.cloud.openstack</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_red_hat_virtualization_2"><a class="anchor" href="#_red_hat_virtualization_2"></a>20.7. Red Hat Virtualization</h3>
<div class="literalblock">
<div class="content">
<pre>compose:
  ansible_host: (devices.values() | list)[0][0] if devices else None
keyed_groups:
- key: cluster
  prefix: cluster
  separator: _
- key: status
  prefix: status
  separator: _
- key: tags
  prefix: tag
  separator: _
ovirt_hostname_preference:
- name
- fqdn
ovirt_insecure: false
plugin: ovirt.ovirt.ovirt</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_red_hat_ansible_automation_platform_2"><a class="anchor" href="#_red_hat_ansible_automation_platform_2"></a>20.8. Red Hat Ansible Automation Platform</h3>
<div class="literalblock">
<div class="content">
<pre>include_metadata: true
inventory_id: &lt;inventory_id or url_quoted_named_url&gt;
plugin: awx.awx.tower
validate_certs: &lt;true or false&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_JobTemplates"><a class="anchor" href="#ug_JobTemplates"></a>21. Job Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>job template</code> is a definition and set of parameters for running an
Ansible job. Job templates are useful to execute the same job many
times. Job templates also encourage the reuse of Ansible playbook
content and collaboration between teams.</p>
</div>
<div class="paragraph">
<p>The <strong>Templates</strong> menu opens a list of the job templates that are
currently available. The default view is collapsed (Compact), showing
the template name, template type, and the timestamp of last job that ran
using that template. You can click <strong>Expanded</strong> (arrow next to each entry)
to expand to view more information. This list is sorted alphabetically
by name, but you can sort by other criteria, or search by various fields
and attributes of a template.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-home-with-example-job-template.png" alt="Job templates - home with example job template"></span></p>
</div>
<div class="paragraph">
<p>From this screen, you can launch
(<span class="image"><img src="images/launch-button.png" alt="launch"></span>), edit
(<span class="image"><img src="images/edit-button.png" alt="edit"></span>), and copy
(<span class="image"><img src="images/copy-button.png" alt="copy"></span>) a job template.
To delete a job template, you must select one or more templates and
click the <strong>Delete</strong> button. Before deleting a job template, be sure it is
not used in a workflow job template.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If deleting items that are used by other work items, a message opens
listing the items are affected by the deletion and prompts you to
confirm the deletion. Some screens will contain items that are invalid
or previously deleted, so they will fail to run. Below is an example of
such a message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/warning-deletion-dependencies.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Job templates can be used to build a workflow template. For templates
that show the Workflow Visualizer
(<span class="image"><img src="images/wf-viz-icon.png" alt="wf-viz-icon"></span>) icon
next to them are workflow templates. Clicking it allows you to
graphically build a workflow. Many parameters in a job template allow
you to enable <strong>Prompt on Launch</strong> that can be modified at the workflow
level, and do not affect the values assigned at the job template level.
For instructions, see the <a href="#ug_wf_editor">Workflow Visualizer</a> section.</p>
</div>
<div class="sect2">
<h3 id="_create_a_job_template"><a class="anchor" href="#_create_a_job_template"></a>21.1. Create a Job Template</h3>
<div class="paragraph">
<p>To create a new job template:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button then select <strong>Job Template</strong> from the menu list.</p>
</li>
<li>
<p>Enter the appropriate details into the following fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter a name for the job.</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional).</p>
</li>
<li>
<p><strong>Job Type</strong>: Choose a job type:</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Run</strong>: Execute the playbook when launched, running Ansible tasks on
the selected hosts.</p>
</li>
<li>
<p><strong>Check</strong>: Perform a "dry run" of the playbook and report changes that
would be made without actually making them. Tasks that do not support
check mode will be skipped and will not report potential changes.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose a job type of run or check.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>More information on job types can be found in the
<a href="http://docs.ansible.com/playbooks_special_topics.html">Playbooks: Special
Topics</a> section of the Ansible documentation.</p>
</div>
</div>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Inventory</strong>: Choose the inventory to be used with this job template
from the inventories available to the currently logged in user.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose an inventory to run this job
template against.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Project</strong>: Choose the project to be used with this job template from
the projects available to the currently logged in user.</p>
</li>
<li>
<p><strong>SCM Branch</strong>: This field is only present if you chose a project that
allows branch override. Specify the overriding branch to use in your job
run. If left blank, the specified SCM branch (or commit hash or tag)
from the project is used. For more detail, see
<code>job branch overriding &lt;ug_job_branching&gt;</code>.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose an SCM branch.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Playbook</strong>: Choose the playbook to be launched with this job template
from the available playbooks. This field automatically populates with
the names of the playbooks found in the project base path for the
selected project. Alternatively, you can enter the name of the playbook
if it is not listed, such as the name of a file (like <code>foo.yml</code>) you
want to use to run with that playbook. If you enter a filename that is
not valid, the template will display an error, or cause the job to fail.</p>
</li>
<li>
<p><strong>Credentials</strong>: Click the button to open a separate window. Choose the
credential from the available options to be used with this job template.
Use the drop-down menu list to filter by credential type if the list is
extensive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Some credential types are not listed because they do not apply to
certain job templates.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-credentials-selection-box.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, upon launching a job template that
has a default machine credential, you will not be able to remove the
default machine credential in the Prompt dialog without replacing it
with another machine credential before it can launch. Alternatively, you
can add more credentials as you see fit. Below is an example of such a
message:</p>
</li>
<li>
<p><strong>Forks</strong>: The number of parallel or simultaneous processes to use while
executing the playbook. A value of zero uses the Ansible default
setting, which is 5 parallel processes unless overridden in
<code>/etc/ansible/ansible.cfg</code>.</p>
</li>
<li>
<p><strong>Limit</strong>: A host pattern to further constrain the list of hosts managed
or affected by the playbook. Multiple patterns can be separated by
colons (":"). As with core Ansible, "a:b" means "in group a or b",
"a:b:&amp;c" means "in a or b but must be in c", and "a:!b" means "in a, and
definitely not in b".</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose a limit.</p>
<div class="paragraph">
<p>Note</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information and examples refer to
<a href="http://docs.ansible.com/intro_patterns.html">Patterns</a> in the Ansible
documentation.</p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Verbosity</strong>: Control the level of output Ansible produces as the
playbook executes. Choose the verbosity from Normal to various Verbose
or Debug settings. This only appears in the "details" report view.
Verbose logging includes the output of all commands. Debug logging is
exceedingly verbose and includes information on SSH operations that can
be useful in certain support instances. Most users do not need to see
debug mode output.</p>
<div class="paragraph">
<p>Warning</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Verbosity 5 causes automation controller to block heavily when jobs are
running, which could delay reporting that the job has finished (even
though it has) and can cause the browser tab to lock up.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose a verbosity.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Job Tags</strong>: Provide a comma-separated list of playbook tags to specify
what parts of the playbooks should be executed. For more information and
examples refer to <a href="http://docs.ansible.com/playbooks_tags.html">Tags</a> in
the Ansible documentation.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose a job tag.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Skip Tags</strong>: Provide a comma-separated list of playbook tags to skip
certain tasks or parts of the playbooks to be executed. For more
information and examples refer to
<a href="http://docs.ansible.com/playbooks_tags.html">Tags</a> in the Ansible
documentation.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose tag(s) to skip.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Labels</strong>: Supply optional labels that describe this job template, such
as "dev" or "test". Labels can be used to group and filter job templates
and completed jobs in the display.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p>Labels are created when they are added to the Job Template. Labels are
associated to a single Organization using the Project that is provided
in the Job Template. Members of the Organization can create labels on a
Job Template if they have edit permissions (such as admin role).</p>
</li>
<li>
<p>Once the Job Template is saved, the labels appear in the Job Templates
overview in the <em>Expanded</em> view.</p>
</li>
<li>
<p>Click on the "x" beside a label to remove it. When a label is removed,
and is no longer associated with a Job or Job Template, the label is
permanently deleted from the list of Organization labels.</p>
</li>
<li>
<p>Jobs inherit labels from the Job Template at the time of launch. If a
label is deleted from a Job Template, it is also deleted from the Job.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Instance Groups</strong>: Click the button to open a separate window. Choose
the instance groups on which you want to run this job template. If the
list is extensive, use the search to narrow the options.</p>
</li>
<li>
<p><strong>Job Slicing</strong>: Specify the number of slices you want this job template
to run. Each slice will run the same tasks against a portion of the
inventory. For more information about job slices, see <a href="#ug_job_slice">Job Slicing</a>.</p>
</li>
<li>
<p><strong>Timeout</strong>: Allows you to specify the length of time (in seconds) that
the job may run before it is canceled. Defaults to 0 for no job timeout.</p>
</li>
<li>
<p><strong>Show Changes</strong>: Allows you to see the changes made by Ansible tasks.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose whether or not to show
changes.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Options</strong>: Specify options for launching this template, if necessary.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Privilege Escalation</strong>: If checked, you enable this playbook to run as
an administrator. This is the equivalent of passing the <code>--become</code>
option to the <code>ansible-playbook</code> command.</p>
</li>
<li>
<p><strong>Provisioning Callbacks</strong>: If checked, you enable a host to call back
to automation controller via the REST API and invoke the launch of a job
from this job template. Refer to <a href="#ug_provisioning_callbacks">Provisioning Callbacks</a> for
additional information.</p>
</li>
<li>
<p><strong>Enable Webhook</strong>: Turns on the ability to interface with a predefined
SCM system web service that is used to launch a job template. Currently
supported SCM systems are GitHub and GitLab.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div id="ug_jt_enable_webhooks" class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If you enable webhooks, other fields display, prompting for additional
information:</p>
</div>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-options-webhooks.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Webhook Service</strong>: Select which service to listen for webhooks from</p>
</li>
<li>
<p><strong>Webhook URL</strong>: Automatically populated with the URL for the webhook
service to POST requests to.</p>
</li>
<li>
<p><strong>Webhook Key</strong>: Generated shared secret to be used by the webhook
service to sign payloads sent to automation controller. This must be
configured in the settings on the webhook service in order for
automation controller to accept webhooks from this service.</p>
</li>
<li>
<p><strong>Webhook Credential</strong>: Optionally, provide a GitHub or GitLab personal
access token (PAT) as a credential to use to send status updates back to
the webhook service. Before you can select it, the credential must
exist. See <a href="#ug_credentials_cred_types">Credential Types</a> to create one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For additional information on setting up webhooks, see <a href="#ug_webhooks">[ug_webhooks]</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Concurrent Jobs</strong>: If checked, you are allowing jobs in the queue to
run simultaneously if not dependent on one another. Check this box if
you want to run job slices simultaneously. Refer to <a href="#ug_job_concurrency">[ug_job_concurrency]</a>
for additional information.</p>
</li>
<li>
<p><strong>Enable Fact Storage</strong>: When checked, automation controller will store
gathered facts for all hosts in an inventory related to the job running.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">

</div>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Extra Variables</strong>:</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p>Pass extra command line variables to the playbook. This is the "-e" or
"--extra-vars" command line parameter for ansible-playbook that is
documented in the Ansible documentation at
<a href="http://docs.ansible.com/playbooks_variables.html#passing-variables-on-the-command-line">Passing
Variables on the Command Line</a>.</p>
</li>
<li>
<p>Provide key/value pairs using either YAML or JSON. These variables
have a maximum value of precedence and overrides other variables
specified elsewhere. An example value might be:</p>
<div class="literalblock">
<div class="content">
<pre>git_branch: production
release_version: 1.5</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ug_jobtemplates_extravars">Extra Variables</a> for more information.</p>
</div>
</li>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose command line variables.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you want to be able to specify <code>extra_vars</code> on a schedule, you must
select <strong>Prompt on Launch</strong> for <strong>EXTRA VARIABLES</strong> on the job template, or
a enable a survey on the job template, then those answered survey
questions become <code>extra_vars</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-create-new-job-template.png" alt="Job templates - create new job template"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>When you have completed configuring the details of the job template,
click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Saving the template does not exit the job template page but advances to
the Job Template Details tab for viewing. After saving the template, you
can click <strong>Launch</strong> to launch the job, or click <strong>Edit</strong> to add or change
the attributes of the template, such as permissions, notifications, view
completed jobs, and add a survey (if the job type is not a scan). You
must f.adoc[] save the template prior to launching, otherwise, the <strong>Launch</strong>
button remains grayed-out.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-job-template-saved.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>You can verify the template is saved when the newly created template
appears on the Templates list view.</p>
</div>
</div>
<div class="sect2">
<h3 id="_add_permissions_3"><a class="anchor" href="#_add_permissions_3"></a>21.2. Add Permissions</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Select a user or team to add and click <strong>Next</strong></p>
</li>
<li>
<p>Select one or more users or teams from the list by clicking the check
box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-for-example-organization.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>In this example, two users have been selected to be added.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Select the role(s) you want the selected user(s) or team(s) to have.
Be sure to scroll down for a complete list of roles. Different resources
have different options available.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/organizations-add-users-roles.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or
team(s) and to add them as members.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Add Users/Teams window closes to display the updated roles assigned
for each user and team.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-tab-roles-assigned.png" alt="Permissions tab with Role Assignments"></span></p>
</div>
<div class="paragraph">
<p>To remove roles for a particular user, click the disassociate (x) button
next to its resource.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>This launches a confirmation dialog, asking you to confirm the
disassociation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/permissions-disassociate-confirm.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_notifications_3"><a class="anchor" href="#_work_with_notifications_3"></a>21.3. Work with Notifications</h3>
<div class="paragraph">
<p>Clicking the <strong>Notifications</strong> tab allows you to review any notification
integrations you have setup and their statuses, if they have ran.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-template-completed-notifications-view.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Use the toggles to enable or disable the notifications to use with your
particular template. For more detail, see <a href="#ug_notifications_on_off">[ug_notifications_on_off]</a>.</p>
</div>
<div class="paragraph">
<p>If no notifications have been set up, click the <strong>Add</strong> button to create a
new notification. Refer to <a href="#ug_notifications_types">[ug_notifications_types]</a> for additional
details on configuring various notification types and extended
messaging.</p>
</div>
</div>
<div class="sect2">
<h3 id="_view_completed_jobs"><a class="anchor" href="#_view_completed_jobs"></a>21.4. View Completed Jobs</h3>
<div class="paragraph">
<p>The <strong>Completed Jobs</strong> tab provides the list of job templates that have
ran. Click <strong>Expanded</strong> to view details of each job, including its status,
ID, and name; type of job, time started and completed, who started the
job; and which template, inventory, project, and credential were used.
You can filter the list of completed jobs using any of these criteria.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-template-completed-jobs-view.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Sliced jobs that display on this list are labeled accordingly, with the
number of sliced jobs that have run:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sliced-job-shown-jobs-list-view.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_scheduling"><a class="anchor" href="#_scheduling"></a>21.5. Scheduling</h3>
<div class="paragraph">
<p>Access the schedules for a particular job template from the <strong>Schedules</strong>
tab.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-schedules.png" alt="Job Templates - schedule launch"></span></p>
</div>
<div class="sect3">
<h4 id="_schedule_a_job_template"><a class="anchor" href="#_schedule_a_job_template"></a>21.5.1. Schedule a Job Template</h4>
<div class="paragraph">
<p>To schedule a job template run, click the <strong>Schedules</strong> tab.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If schedules are already set up; review, edit, or enable/disable your
schedule preferences.</p>
</li>
<li>
<p>If schedules have not been set up, refer to <a href="#ug_scheduling">[ug_scheduling]</a> for more
information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <strong>Prompt on Launch</strong> was selected for the <strong>Credentials</strong> field, and you
create or edit scheduling information for your job template, a <strong>Prompt</strong>
button displays at the bottom of the Schedules form. You will not be
able to remove the default machine credential in the Prompt dialog
without replacing it with another machine credential before you can save
it. Below is an example of such a message:</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>To able to set <code>extra_vars</code> on schedules, you must select <strong>Prompt on
Launch</strong> for <strong>EXTRA VARIABLES</strong> on the job template, or a enable a survey
on the job template, then those answered survey questions become
<code>extra_vars</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_surveys"><a class="anchor" href="#ug_surveys"></a>21.6. Surveys</h3>
<div class="paragraph">
<p>Job types of Run or Check will provide a way to set up surveys in the
Job Template creation or editing screens. Surveys set extra variables
for the playbook similar to 'Prompt for Extra Variables' does, but in a
user-friendly question and answer way. Surveys also allow for validation
of user input. Click the <strong>Survey</strong> tab to create a survey.</p>
</div>
<div class="paragraph">
<p>Use cases for surveys are numerous. An example might be if operations
wanted to give developers a "push to stage" button they could run
without advanced Ansible knowledge. When launched, this task could
prompt for answers to questions such as, "What tag should we release?"</p>
</div>
<div class="paragraph">
<p>Many types of questions can be asked, including multiple-choice
questions.</p>
</div>
<div class="sect3">
<h4 id="ug_surveys_create"><a class="anchor" href="#ug_surveys_create"></a>21.6.1. Create a Survey</h4>
<div class="paragraph">
<p>To create a survey:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Survey</strong> tab and click the <strong>Add</strong> button.</p>
</li>
<li>
<p>A survey can consist of any number of questions. For each question,
enter the following information:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: The question to ask the user</p>
</li>
<li>
<p><strong>Description</strong>: (optional) A description of what&#8217;s being asked of the
user.</p>
</li>
<li>
<p><strong>Answer Variable Name</strong>: The Ansible variable name to store the user&#8217;s
response in. This is the variable to be used by the playbook. Variable
names cannot contain spaces.</p>
</li>
<li>
<p><strong>Answer Type</strong>: Choose from the following question types.</p>
<div class="ulist">
<ul>
<li>
<p><em>Text</em>: A single line of text. You can set the minimum and maximum
length (in characters) for this answer.</p>
</li>
<li>
<p><em>Textarea</em>: A multi-line text field. You can set the minimum and
maximum length (in characters) for this answer.</p>
</li>
<li>
<p><em>Password</em>: Responses are treated as sensitive information, much like
an actual password is treated. You can set the minimum and maximum
length (in characters) for this answer.</p>
</li>
<li>
<p><em>Multiple Choice (single select)</em>: A list of options, of which only
one can be selected at a time. Enter the options, one per line, in the
<strong>Multiple Choice Options</strong> box.</p>
</li>
<li>
<p><em>Multiple Choice (multiple select)</em>: A list of options, any number of
which can be selected at a time. Enter the options, one per line, in the
<strong>Multiple Choice Options</strong> box.</p>
</li>
<li>
<p><em>Integer</em>: An integer number. You can set the minimum and maximum
length (in characters) for this answer.</p>
</li>
<li>
<p><em>Float</em>: A decimal number. You can set the minimum and maximum length
(in characters) for this answer.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Required</strong>: Whether or not an answer to this question is required from
the user.</p>
</li>
<li>
<p><strong>Minimum length</strong> and <strong>Maximum length</strong>: Specify if a certain length in
the answer is required.</p>
</li>
<li>
<p><strong>Default Answer</strong>: The default answer to the question. This value is
pre-filled in the interface and is used if the answer is not provided by
the user.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-template-create-survey.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Once you have entered the question information, click <strong>Save</strong> to add
the question.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The survey question displays in the Survey list. For any question, you
can click <span class="image"><img src="images/edit-button.png" alt="edit"></span> to edit
the question, or check the box next to each question and click <strong>Delete</strong>
to delete the question, or use the toggle button at the top of the
screen to enable or disable the survey prompt(s).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-template-completed-survey.png" alt="job-template-completed-survey"></span></p>
</div>
<div class="paragraph">
<p>If you have more than one survey question, use the <strong>Edit Order</strong> button
to rearrange the order of the questions by clicking and dragging on the
grid icon.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-template-rearrange-survey.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>To add more questions, click the <strong>Add</strong> button to add additional
questions.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_optional_survey_questions"><a class="anchor" href="#_optional_survey_questions"></a>21.6.2. Optional Survey Questions</h4>
<div class="paragraph">
<p>The <strong>Required</strong> setting on a survey question determines whether the
answer is optional or not for the user interacting with it.</p>
</div>
<div class="paragraph">
<p>Behind the scenes, optional survey variables can be passed to the
playbook in <code>extra_vars</code>, even when they aren&#8217;t filled in.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a non-text variable (input type) is marked as optional, and is not
filled in, no survey <code>extra_var</code> is passed to the playbook.</p>
</li>
<li>
<p>If a text input or text area input is marked as optional, is not
filled in, and has a minimum <code>length &gt; 0</code>, no survey <code>extra_var</code> is
passed to the playbook.</p>
</li>
<li>
<p>If a text input or text area input is marked as optional, is not
filled in, and has a minimum <code>length === 0</code>, that survey <code>extra_var</code> is
passed to the playbook, with the value set to an empty string ( "" ).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_launch_a_job_template"><a class="anchor" href="#_launch_a_job_template"></a>21.7. Launch a Job Template</h3>
<div class="paragraph">
<p>A major benefit of automation controller is the push-button deployment
of Ansible playbooks. You can easily configure a template to store all
parameters you would normally pass to the ansible-playbook on the
command line&#8212;&#8203;not just the playbooks, but the inventory, credentials,
extra variables, and all options and settings you can specify on the
command line.</p>
</div>
<div class="paragraph">
<p>Easier deployments drive consistency, by running your playbooks the same
way each time, and allow you to delegate responsibilities&#8212;&#8203;even users
who arenât Ansible experts can run playbooks written by others.</p>
</div>
<div class="paragraph">
<p>Launch a job template by any of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access the job template list from the <strong>Templates</strong> menu on the left
navigation bar or while in the Job Template Details view, scroll to the
bottom to access the
<span class="image"><img src="images/launch-button.png" alt="launch"></span> button from
the list of templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-home-with-example-job-template-launch.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>While in the Job Template Details view of the job template you want to
launch, click <strong>Launch</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A job may require additional information to run. The following data may
be requested at launch:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Credentials that were setup</p>
</li>
<li>
<p>The option <code>Prompt on Launch</code> is selected for any parameter</p>
</li>
<li>
<p>Passwords or passphrases that have been set to <strong>Ask</strong></p>
</li>
<li>
<p>A survey, if one has been configured for the job templates</p>
</li>
<li>
<p>Extra variables, if requested by the job template</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If a job has user-provided values, then those are respected upon
relaunch. If the user did not specify a value, then the job uses the
default value from the job template. Jobs are not relaunched as-is. They
are relaunched with the user prompts re-applied to the job template.</p>
</div>
<div class="paragraph">
<p>Below is an example job launch that prompts for Job Tags, and runs the
example survey created in <a href="#ug_surveys">Surveys</a>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-launch-with-prompt-at-launch-jobtags.png" alt="job-launch-with-prompt-job-tags"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-launch-with-prompt-at-launch-survey.png" alt="job-launch-with-prompt-survey"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Providing values on one tab, and going back to a previous tab, and then
continuing on to the next tab will result in having to re-provide values
on the rest of the tabs. Make sure you fill in the tabs in the order the
prompts appear to avoid this.</p>
</div>
<div class="paragraph">
<p>Along with any extra variables set in the job template and survey,
automation controller automatically adds the following variables to the
job environment. Also note, <code>awx_</code>* variables are defined by the system
and cannot be overridden. Variables about the job context, like
<code>awx_job_template_name</code> are not affected if they are set in
<code>extra_vars</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>awx_job_id</code>: The Job ID for this job run</p>
</li>
<li>
<p><code>awx_job_launch_type</code>: The description to indicate how the job was
started:</p>
<div class="ulist">
<ul>
<li>
<p><strong>manual</strong>: Job was started manually by a user.</p>
</li>
<li>
<p><strong>relaunch</strong>: Job was started via relaunch.</p>
</li>
<li>
<p><strong>callback</strong>: Job was started via host callback.</p>
</li>
<li>
<p><strong>scheduled</strong>: Job was started from a schedule.</p>
</li>
<li>
<p><strong>dependency</strong>: Job was started as a dependency of another job.</p>
</li>
<li>
<p><strong>workflow</strong>: Job was started from a workflow job.</p>
</li>
<li>
<p><strong>sync</strong>: Job was started from a project sync.</p>
</li>
<li>
<p><strong>scm</strong>: Job was created as an Inventory SCM sync.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>awx_job_template_id</code>: The Job Template ID that this job run uses</p>
</li>
<li>
<p><code>awx_job_template_name</code>: The Job Template name that this job uses</p>
</li>
<li>
<p><code>awx_project_revision</code>: The revision identifier for the source tree
that this particular job uses (it is also the same as the job&#8217;s field
<code>scm_revision</code>)</p>
</li>
<li>
<p><code>awx_project_scm_branch</code>: The configured default project SCM branch
for the project the job template uses</p>
</li>
<li>
<p><code>awx_job_scm_branch</code> If the SCM Branch is overwritten by the job, the
value is shown here</p>
</li>
<li>
<p><code>awx_user_email</code>: The user email of the controller user that started
this job. This is not available for callback or scheduled jobs.</p>
</li>
<li>
<p><code>awx_user_f.adoc[]_name</code>: The user&#8217;s f.adoc[] name of the controller user
that started this job. This is not available for callback or scheduled
jobs.</p>
</li>
<li>
<p><code>awx_user_id</code>: The user ID of the controller user that started this
job. This is not available for callback or scheduled jobs.</p>
</li>
<li>
<p><code>awx_user_last_name</code>: The user&#8217;s last name of the controller user that
started this job. This is not available for callback or scheduled jobs.</p>
</li>
<li>
<p><code>awx_user_name</code>: The user name of the controller user that started
this job. This is not available for callback or scheduled jobs.</p>
</li>
<li>
<p><code>awx_schedule_id</code>: If applicable, the ID of the schedule that launched
this job</p>
</li>
<li>
<p><code>awx_schedule_name</code>: If applicable, the name of the schedule that
launched this job</p>
</li>
<li>
<p><code>awx_workflow_job_id</code>: If applicable, the ID of the workflow job that
launched this job</p>
</li>
<li>
<p><code>awx_workflow_job_name</code>: If applicable, the name of the workflow job
that launched this job. Note this is also the same as the workflow job
template.</p>
</li>
<li>
<p><code>awx_inventory_id</code>: If applicable, the ID of the inventory this job
uses</p>
</li>
<li>
<p><code>awx_inventory_name</code>: If applicable, the name of the inventory this
job uses</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For compatibility, all variables are also given an "awx" prefix, for
example, <code>awx_job_id</code>.</p>
</div>
<div class="paragraph">
<p>Upon launch, automation controller automatically redirects the web
browser to the Job Status page for this job under the <strong>Jobs</strong> tab.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>You can re-launch the most recent job from the list view to re-run on
all hosts or just failed hosts in the specified inventory. Refer to
<a href="#ug_jobs">Jobs</a> in the Automation Controller User Guide for more detail.</p>
</div>
<div class="paragraph">
<p>When slice jobs are running, job lists display the workflow and job
slices, as well as a link to view their details individually.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sliced-job-shown-jobs-list-view.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_copy_a_job_template"><a class="anchor" href="#_copy_a_job_template"></a>21.8. Copy a Job Template</h3>
<div class="paragraph">
<p>If you choose to copy Job Template, it <strong>does not</strong> copy any associated
schedule, notifications, or permissions. Schedules and notifications
must be recreated by the user or admin creating the copy of the Job
Template. The user copying the Job Template will be granted the admin
permission, but no permissions are assigned (copied) to the Job
Template.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Access the job template list from the <strong>Templates</strong> menu on the left
navigation bar or while in the Job Template Details view, scroll to the
bottom to access it from the list of templates.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-home-with-example-job-template.png" alt="Job templates - home with example job template"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the <span class="image"><img src="images/copy-button.png" alt="copy"></span>
button associated with the template you want to copy.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The new template with the name of the template from which you copied and
a timestamp displays in the list of templates.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click to open the new template and click <strong>Edit</strong>.</p>
</li>
<li>
<p>Replace the contents of the <strong>Name</strong> field with a new name, and provide
or modify the entries in the other fields to complete this page.</p>
</li>
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="ug_jobtemplates_scanjobs"><a class="anchor" href="#ug_jobtemplates_scanjobs"></a>21.9. Scan Job Templates</h3>
<div class="paragraph">
<p>Scan jobs are no longer supported starting with automation controller
3.2. This system tracking feature was used as a way to capture and store
facts as historical data. Facts are now stored in the controller via
fact caching. For more information, see <a href="#ug_fact_caching">Fact Caching</a>.</p>
</div>
<div class="paragraph">
<p>If you have Job Template Scan Jobs in your system prior to automation
controller 3.2, they have been converted to type run (like normal job
templates) and retained their associated resources (i.e. inventory,
credential). Job Template Scan Jobs that do not have a related project
are assigned a special playbook by default, or you can specify a project
with your own scan playbook. A project was created for each organization
that points to <a href="https://github.com/ansible/tower-fact-modules" class="bare">https://github.com/ansible/tower-fact-modules</a> and the Job
Template was set to the playbook,
<a href="https://github.com/ansible/tower-fact-modules/blob/master/scan_facts.yml" class="bare">https://github.com/ansible/tower-fact-modules/blob/master/scan_facts.yml</a>.</p>
</div>
<div class="sect3">
<h4 id="_fact_scan_playbooks"><a class="anchor" href="#_fact_scan_playbooks"></a>21.9.1. Fact Scan Playbooks</h4>
<div class="paragraph">
<p>The scan job playbook, <code>scan_facts.yml</code>, contains invocations of three
<code>fact scan modules</code> - packages, services, and files, along with
Ansible&#8217;s standard fact gathering. The <code>scan_facts.yml</code> playbook file
looks like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sourceCode" data-lang="sourceCode">- hosts: all
  vars:
    scan_use_checksum: false
    scan_use_recursive: false
  tasks:
    - scan_packages:
    - scan_services:
    - scan_files:
        paths: '{{ scan_file_paths }}'
        get_checksum: '{{ scan_use_checksum }}'
        recursive: '{{ scan_use_recursive }}'
      when: scan_file_paths is defined</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>scan_files</code> fact module is the only module that accepts parameters,
passed via <code>extra_vars</code> on the scan job template.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sourceCode" data-lang="sourceCode">scan_file_paths: '/tmp/'
scan_use_checksum: true
scan_use_recursive: true</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>scan_file_paths</code> parameter may have multiple settings (such as
<code>/tmp/</code> or <code>/var/log</code>).</p>
</li>
<li>
<p>The <code>scan_use_checksum</code> and <code>scan_use_recursive</code> parameters may also
be set to false or omitted. An omission is the same as a false setting.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Scan job templates should enable <code>become</code> and use credentials for which
<code>become</code> is a possibility. You can enable become by checking the <strong>Enable
Privilege Escalation</strong> from the Options menu:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-create-new-job-template-become.png" alt="image"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_supported_oses_for_scan_facts_yml"><a class="anchor" href="#_supported_oses_for_scan_facts_yml"></a>21.9.2. Supported OSes for <code>scan_facts.yml</code></h4>
<div class="paragraph">
<p>If you use the <code>scan_facts.yml</code> playbook with use fact cache, ensure
that your OS is supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Red Hat Enterprise Linux 5, 6, &amp; 7</p>
</li>
<li>
<p>Ubuntu 16.04 (Support for Unbuntu is deprecated and will be removed in
a future release)</p>
</li>
<li>
<p>OEL 6 &amp; 7</p>
</li>
<li>
<p>SLES 11 &amp; 12</p>
</li>
<li>
<p>Debian 6, 7, 8</p>
</li>
<li>
<p>Fedora 22, 23, 24</p>
</li>
<li>
<p>Amazon Linux 2016.03</p>
</li>
<li>
<p>Windows Server 2008 and later</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that some of these operating systems may require initial
configuration in order to be able to run python and/or have access to
the python packages (such as <code>python-apt</code>) that the scan modules depend
on.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pre_scan_setup"><a class="anchor" href="#_pre_scan_setup"></a>21.9.3. Pre-scan Setup</h4>
<div class="paragraph">
<p>The following are examples of playbooks that configure certain
distributions so that scan jobs can be run against them.</p>
</div>
<div class="paragraph">
<p><strong>Bootstrap Ubuntu (16.04)</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>---

- name: Get Ubuntu 16, and on ready
 hosts: all
 sudo: yes
 gather_facts: no

 tasks:

 - name: install python-simplejson
   raw: sudo apt-get -y update
   raw: sudo apt-get -y install python-simplejson
   raw: sudo apt-get install python-apt</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Bootstrap Fedora (23, 24)</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>---

- name: Get Fedora ready
 hosts: all
 sudo: yes
 gather_facts: no

 tasks:

 - name: install python-simplejson
   raw: sudo dnf -y update
   raw: sudo dnf -y install python-simplejson
   raw: sudo dnf -y install rpm-python</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_custom_fact_scans"><a class="anchor" href="#_custom_fact_scans"></a>21.9.4. Custom Fact Scans</h4>
<div class="paragraph">
<p>A playbook for a custom fact scan is similar to the example of the Fact
Scan Playbook above. As an example, a playbook that only uses a custom
<code>scan_foo</code> Ansible fact module would look like this:</p>
</div>
<div class="paragraph">
<p><em>scan_custom.yml</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sourceCode" data-lang="sourceCode">- hosts: all
  gather_facts: false
  tasks:
    - scan_foo:</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>scan_foo.py</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sourceCode" data-lang="sourceCode">def main():
    module = AnsibleModule(
        argument_spec = dict())

    foo = [
      {
        "hello": "world"
      },
      {
        "foo": "bar"
      }
    ]
    results = dict(ansible_facts=dict(foo=foo))
    module.exit_json(**results)

main()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use a custom fact module, ensure that it lives in the <code>/library/</code>
subdirectory of the Ansible project used in the scan job template. This
fact scan module is very simple, returning a hard-coded set of facts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sourceCode" data-lang="sourceCode">[
   {
     "hello": "world"
   },
   {
     "foo": "bar"
   }
 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to the <a href="">Module Provided 'Facts'</a> section of the Ansible
documentation for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_fact_caching"><a class="anchor" href="#ug_fact_caching"></a>21.10. Fact Caching</h3>
<div class="paragraph">
<p>Automation controller can store and retrieve facts on a per-host basis
through an Ansible Fact Cache plugin. This behavior is configurable on a
per-job template basis. Fact caching is turned off by default but can be
enabled to serve fact requests for all hosts in an inventory related to
the job running. This allows you to use job templates with <code>--limit</code>
while still having access to the entire inventory of host facts. A
global timeout setting that the plugin enforces per-host, can be
specified (in seconds) through the Jobs settings menu:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/configure-tower-jobs-fact-cache-timeout.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Upon launching a job that uses fact cache (<code>use_fact_cache=True</code>), the
controller will store all <code>ansible_facts</code> associated with each host in
the inventory associated with the job. The Ansible Fact Cache plugin
that ships with automation controller will only be enabled on jobs with
fact cache enabled (<code>use_fact_cache=True</code>).</p>
</div>
<div class="paragraph">
<p>When a job that has fact cache enabled (<code>use_fact_cache=True</code>) finishes
running, the controller will restore all records for the hosts in the
inventory. Any records with update times <em>newer</em> than the currently
stored facts per-host will be updated in the database.</p>
</div>
<div class="paragraph">
<p>New and changed facts will be logged via the controller&#8217;s logging
facility. Specifically, to the <code>system_tracking</code> namespace or logger.
The logging payload will include the fields:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><code>host_name</code></p>
</li>
<li>
<p><code>inventory_id</code></p>
</li>
<li>
<p><code>ansible_facts</code></p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>where <code>ansible_facts</code> is a dictionary of all Ansible facts for
<code>host_name</code> in the controller inventory, <code>inventory_id</code>.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If a hostname includes a forward slash (<code>/</code>), fact cache will not work
for that host. If you have an inventory with 100 hosts and one host has
a <code>/</code> in the name, 99 of those hosts will still collect facts.</p>
</div>
<div class="sect3">
<h4 id="_benefits_of_fact_caching"><a class="anchor" href="#_benefits_of_fact_caching"></a>21.10.1. Benefits of Fact Caching</h4>
<div class="paragraph">
<p>Fact caching saves a significant amount of time over running fact
gathering. If you have a playbook in a job that runs against a thousand
hosts and forks, you could easily spend 10 minutes gathering facts
across all of those hosts. But if you run a job on a regular basis, the
f.adoc[] run of it caches these facts and the next run will just pull them
from the database. This cuts the runtime of jobs against large
inventories, including Smart Inventories, by an enormous magnitude.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Do not modify the <code>ansible.cfg</code> file to apply fact caching. Custom fact
caching could conflict with the controller&#8217;s fact caching feature. It is
recommended to use the fact caching module that comes with automation
controller. Fact caching is not supported for isolated nodes.</p>
</div>
<div class="paragraph">
<p>You can choose to use cached facts in your job by enabling it in the
<strong>Options</strong> field of the Job Templates window.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-templates-options-use-factcache.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To clear facts, you need to run the Ansible <code>clear_facts</code>
<a href="http://docs.ansible.com/ansible/latest/modules/meta_module.html#examples">meta
task</a>. Below is an example playbook that uses the Ansible <code>clear_facts</code>
meta task.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>- hosts: all
  gather_facts: false
  tasks:
    - name: Clear gathered facts from all currently targeted hosts
      meta: clear_facts</pre>
</div>
</div>
<div class="paragraph">
<p>The API endpoint for fact caching can be found at:
<code><a href="http://&lt;controller" class="bare">http://&lt;controller</a> server name&gt;/api/v2/hosts/x/ansible_facts</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_CloudCredentials"><a class="anchor" href="#ug_CloudCredentials"></a>21.11. Utilizing Cloud Credentials</h3>
<div class="paragraph">
<p>Cloud Credentials can be used when syncing a respective cloud inventory.
Cloud Credentials may also be associated with a Job Template and
included in the runtime environment for use by a playbook. Cloud
Credentials currently supported:</p>
</div>
<div class="sect3">
<h4 id="_openstack_3"><a class="anchor" href="#_openstack_3"></a>21.11.1. OpenStack</h4>
<div class="paragraph">
<p>The sample playbook below invokes the <code>nova_compute</code> Ansible OpenStack
cloud module and requires credentials to do anything meaningful, and
specifically requires the following information: <code>auth_url</code>, <code>username</code>,
<code>password</code>, and <code>project_name</code>. These fields are made available to the
playbook via the environmental variable <code>OS_CLIENT_CONFIG_FILE</code>, which
points to a YAML file written by the controller based on the contents of
the cloud credential. This sample playbook loads the YAML file into the
Ansible variable space.</p>
</div>
<div class="paragraph">
<p><code>OS_CLIENT_CONFIG_FILE</code> example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>clouds:
  devstack:
    auth:
      auth_url: http://devstack.yoursite.com:5000/v2.0/
      username: admin
      password: your_password_here
      project_name: demo</pre>
</div>
</div>
<div class="paragraph">
<p>Playbook example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>- hosts: all
  gather_facts: false
  vars:
    config_file: "{{ lookup('env', 'OS_CLIENT_CONFIG_FILE') }}"
    nova_tenant_name: demo
    nova_image_name: "cirros-0.3.2-x86_64-uec"
    nova_instance_name: autobot
    nova_instance_state: 'present'
    nova_flavor_name: m1.nano

    nova_group:
      group_name: antarctica
      instance_name: deceptacon
      instance_count: 3
  tasks:
    - debug: msg="{{ config_file }}"
    - stat: path="{{ config_file }}"
      register: st
    - include_vars: "{{ config_file }}"
      when: st.stat.exists and st.stat.isreg

    - name: "Print out clouds variable"
      debug: msg="{{ clouds|default('No clouds found') }}"

    - name: "Setting nova instance state to: {{ nova_instance_state }}"
      local_action:
        module: nova_compute
        login_username: "{{ clouds.devstack.auth.username }}"
        login_password: "{{ clouds.devstack.auth.password }}"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_amazon_web_services"><a class="anchor" href="#_amazon_web_services"></a>21.11.2. Amazon Web Services</h4>
<div class="paragraph">
<p>Amazon Web Services cloud credentials are exposed as the following
environment variables during playbook execution (in the job template,
choose the cloud credential needed for your setup):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AWS_ACCESS_KEY_ID</code></p>
</li>
<li>
<p><code>AWS_SECRET_ACCESS_KEY</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the AWS modules will implicitly use these credentials when run
via the controller without having to set the <code>aws_access_key_id</code> or
<code>aws_secret_access_key</code> module options.</p>
</div>
</div>
<div class="sect3">
<h4 id="_google"><a class="anchor" href="#_google"></a>21.11.3. Google</h4>
<div class="paragraph">
<p>Google cloud credentials are exposed as the following environment
variables during playbook execution (in the job template, choose the
cloud credential needed for your setup):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GCE_EMAIL</code></p>
</li>
<li>
<p><code>GCE_PROJECT</code></p>
</li>
<li>
<p><code>GCE_CREDENTIALS_FILE_PATH</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the Google modules will implicitly use these credentials when run
via the controller without having to set the <code>service_account_email</code>,
<code>project_id</code>, or <code>pem_file</code> module options.</p>
</div>
</div>
<div class="sect3">
<h4 id="_azure"><a class="anchor" href="#_azure"></a>21.11.4. Azure</h4>
<div class="paragraph">
<p>Azure cloud credentials are exposed as the following environment
variables during playbook execution (in the job template, choose the
cloud credential needed for your setup):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AZURE_SUBSCRIPTION_ID</code></p>
</li>
<li>
<p><code>AZURE_CERT_PATH</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the Azure modules implicitly use these credentials when run via
the controller without having to set the <code>subscription_id</code> or
<code>management_cert_path</code> module options.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmware"><a class="anchor" href="#_vmware"></a>21.11.5. VMware</h4>
<div class="paragraph">
<p>VMware cloud credentials are exposed as the following environment
variables during playbook execution (in the job template, choose the
cloud credential needed for your setup):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VMWARE_USER</code></p>
</li>
<li>
<p><code>VMWARE_PASSWORD</code></p>
</li>
<li>
<p><code>VMWARE_HOST</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The sample playbook below demonstrates usage of these credentials:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>- vsphere_guest:
    vcenter_hostname: "{{ lookup('env', 'VMWARE_HOST') }}"
    username: "{{ lookup('env', 'VMWARE_USER') }}"
    password: "{{ lookup('env', 'VMWARE_PASSWORD') }}"
    guest: newvm001
    from_template: yes
    template_src: linuxTemplate
    cluster: MainCluster
    resource_pool: "/Resources"
    vm_extra_config:
      folder: MyFolder</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_provisioning_callbacks"><a class="anchor" href="#ug_provisioning_callbacks"></a>21.12. Provisioning Callbacks</h3>
<div class="paragraph">
<p>Provisioning callbacks are a feature of Automation Controller that allow
a host to initiate a playbook run against itself, rather than waiting
for a user to launch a job to manage the host from the Automation
Controller console. Please note that provisioning callbacks are <em>only</em>
used to run playbooks on the calling host. Provisioning callbacks are
meant for cloud b.adoc[]ing (i.e. new instances with a need for client to
server communication for configuration (such as transmitting an
authorization key)), not to run a job against another host. This
provides for automatically configuring a system after it has been
provisioned by another system (such as AWS auto-scaling, or a OS
provisioning system like kickstart or preseed) or for launching a job
programmatically without invoking the Automation Controller API
directly. The Job Template launched only runs against the host
requesting the provisioning.</p>
</div>
<div class="paragraph">
<p>Frequently this would be accessed via a f.adoc[]boot type script, or from
cron.</p>
</div>
<div class="paragraph">
<p>To enable callbacks, check the <em>Provisioning Callbacks</em> checkbox in the
Job Template. This displays the <strong>Provisioning Callback URL</strong> for this job
template.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you intend to use Automation Controller&#8217;s provisioning callback
feature with a dynamic inventory, Update on Launch should be set for the
inventory group used in the Job Template.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/provisioning-callbacks-config.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Callbacks also require a Host Config Key, to ensure that foreign hosts
with the URL cannot request configuration. Please provide a custom value
for Host Config Key. The host key may be reused across multiple hosts to
apply this job template against multiple hosts. Should you wish to
control what hosts are able to request configuration, the key may be
changed at any time.</p>
</div>
<div class="paragraph">
<p>To callback manually via REST, look at the callback URL in the UI, which
is of the form:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>https://&lt;CONTROLLER_SERVER_NAME&gt;/api/v2/job_templates/7/callback/</pre>
</div>
</div>
<div class="paragraph">
<p>The '7' in this sample URL is the job template ID in Automation
Controller.</p>
</div>
<div class="paragraph">
<p>The request from the host must be a POST. Here is an example using curl
(all on a single line):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -k -f -i -H 'Content-Type:application/json' -XPOST -d '{"host_config_key": "redhat"}' \
                  https://&lt;CONTROLLER_SERVER_NAME&gt;/api/v2/job_templates/7/callback/</pre>
</div>
</div>
<div class="paragraph">
<p>The requesting host must be defined in your inventory for the callback
to succeed. If Automation Controller fails to locate the host either by
name or IP address in one of your defined inventories, the request is
denied. When running a Job Template in this way, the host initiating the
playbook run against itself must be in the inventory. If the host is
missing from the inventory, the Job Template will fail with a "No Hosts
Matched" type error message.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If your host is not in inventory and <code>Update on Launch</code> is set for the
inventory group, Automation Controller attempts to update cloud based
inventory source before running the callback.</p>
</div>
<div class="paragraph">
<p>Successful requests result in an entry on the Jobs tab, where the
results and history can be viewed.</p>
</div>
<div class="paragraph">
<p>While the callback can be accessed via REST, the suggested method of
using the callback is to use one of the example scripts that ships with
Automation Controller - <code>/usr/share/awx/request_tower_configuration.sh</code>
(Linux/UNIX) or <code>/usr/share/awx/request_tower_configuration.ps1</code>
(Windows). Usage is described in the source code of the file by passing
the <code>-h</code> flag, as shown below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./request_tower_configuration.sh -h
Usage: ./request_tower_configuration.sh &lt;options&gt;

Request server configuration from Ansible Tower.

OPTIONS:
 -h      Show this message
 -s      Controller server (e.g. https://ac.example.com) (required)
 -k      Allow insecure SSL connections and transfers
 -c      Host config key (required)
 -t      Job template ID (required)
 -e      Extra variables</pre>
</div>
</div>
<div class="paragraph">
<p>This script has some intelligence, it knows how to retry commands and is
therefore a more robust way to use callbacks than a simple curl request.
As written, the script retries once per minute for up to ten minutes.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Please note that this is an example script. You should edit this script
if you need more dynamic behavior when detecting failure scenarios, as
any non-200 error code may not be a transient error requiring retry.</p>
</div>
<div class="paragraph">
<p>Most likely you will use callbacks with dynamic inventory in Automation
Controller, such as pulling cloud inventory from one of the supported
cloud providers. In these cases, along with setting <em>Update On Launch</em>,
be sure to configure an inventory cache timeout for the inventory
source, to avoid hammering of your Cloud&#8217;s API endpoints. Since the
<code>request_tower_configuration.sh</code> script polls once per minute for up to
ten minutes, a suggested cache invalidation time for inventory
(configured on the inventory source itself) would be one or two minutes.</p>
</div>
<div class="paragraph">
<p>While we recommend against running the <code>request_tower_configuration.sh</code>
script from a cron job, a suggested cron interval would be perhaps every
30 minutes. Repeated configuration can be easily handled by scheduling
in Automation Controller, so the primary use of callbacks by most users
is to enable a base image that is bootstrapped into the latest
configuration upon coming online. To do so, running at f.adoc[] boot is a
better practice. F.adoc[] boot scripts are just simple init scripts that
typically self-delete, so you would set up an init script that called a
copy of the <code>request_tower_configuration.sh</code> script and make that into
an autoscaling image.</p>
</div>
<div class="sect3">
<h4 id="_passing_extra_variables_to_provisioning_callbacks"><a class="anchor" href="#_passing_extra_variables_to_provisioning_callbacks"></a>21.12.1. Passing Extra Variables to Provisioning Callbacks</h4>
<div class="paragraph">
<p>Just as you can pass <code>extra_vars</code> in a regular Job Template, you can
also pass them to provisioning callbacks. To pass <code>extra_vars</code>, the data
sent must be part of the body of the POST request as application/json
(as the content type). Use the following JSON format as an example when
adding your own <code>extra_vars</code> to be passed:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>'{"extra_vars": {"variable1":"value1","variable2":"value2",...}}'</pre>
</div>
</div>
<div class="paragraph">
<p>You can also pass extra variables to the Job Template call using <code>curl</code>,
such as is shown in the following example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>root@localhost:~$ curl -f -H 'Content-Type: application/json' -XPOST \
                 -d '{"host_config_key": "redhat", "extra_vars": "{\"foo\": \"bar\"}"}' \
                 https://&lt;CONTROLLER_SERVER_NAME&gt;/api/v2/job_templates/7/callback</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, refer to
<code>Launching Jobs with Curl&lt;administration:launch_jobs_curl&gt;</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_jobtemplates_extravars"><a class="anchor" href="#ug_jobtemplates_extravars"></a>21.13. Extra Variables</h3>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p><code>extra_vars</code> passed to the job launch API are only honored if one of the
following is true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They correspond to variables in an enabled survey</p>
</li>
<li>
<p><code>ask_variables_on_launch</code> is set to True</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you pass survey variables, they are passed as extra variables
(<code>extra_vars</code>) within the controller. This can be tricky, as passing
extra variables to a job template (as you would do with a survey) can
override other variables being passed from the inventory and project.</p>
</div>
<div class="paragraph">
<p>For example, say that you have a defined variable for an inventory for
<code>debug = true</code>. It is entirely possible that this variable,
<code>debug = true</code>, can be overridden in a job template survey.</p>
</div>
<div class="paragraph">
<p>To ensure that the variables you need to pass are not overridden, ensure
they are included by redefining them in the survey. Keep in mind that
extra variables can be defined at the inventory, group, and host levels.</p>
</div>
<div class="paragraph">
<p>If specifying the <code>ALLOW_JINJA_IN_EXTRA_VARS</code> parameter, refer to the
<code>Controller Tips and Tricks &lt;administration:ag_tips_jinja_extravars&gt;</code>
section of the Automation Controller Administration Guide to configure
it in the Jobs Settings screen of the controller UI.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>The Job Template extra variables dictionary is merged with the Survey
variables.</p>
</div>
<div class="paragraph">
<p>Here are some simplified examples of extra_vars in YAML and JSON
formats:</p>
</div>
<div class="paragraph">
<p>The configuration in YAML format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>launch_to_orbit: true
satellites:
  - sputnik
  - explorer
  - satcom</pre>
</div>
</div>
<div class="paragraph">
<p>The configuration in JSON format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "launch_to_orbit": true,
  "satellites": ["sputnik", "explorer", "satcom"]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table notes the behavior (hierarchy) of variable
precedence in automation controller as it compares to variable
precedence in Ansible.</p>
</div>
<div class="paragraph">
<p><strong>Automation Controller Variable Precedence Hierarchy (last listed wins)</strong></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Architecture-Tower_Variable_Precedence_Hierarchy.png" alt="image"></span></p>
</div>
<div class="sect3">
<h4 id="_relaunching_job_templates"><a class="anchor" href="#_relaunching_job_templates"></a>21.13.1. Relaunching Job Templates</h4>
<div class="paragraph">
<p>Instead of manually relaunching a job, a relaunch is denoted by setting
<code>launch_type</code> to <code>relaunch</code>. The relaunch behavior deviates from the
launch behavior in that it <strong>does not</strong> inherit <code>extra_vars</code>.</p>
</div>
<div class="paragraph">
<p>Job relaunching does not go through the inherit logic. It uses the same
<code>extra_vars</code> that were calculated for the job being relaunched.</p>
</div>
<div class="paragraph">
<p>For example, say that you launch a Job Template with no <code>extra_vars</code>
which results in the creation of a Job called <strong>j1</strong>. Next, say that you
edit the Job Template and add in some <code>extra_vars</code> (such as adding
<code>"{ "hello": "world" }"</code>).</p>
</div>
<div class="paragraph">
<p>Relaunching <strong>j1</strong> results in the creation of <strong>j2</strong>, but because there is
no inherit logic and <strong>j1</strong> had no <code>extra_vars</code>, <strong>j2</strong> will not have any
<code>extra_vars</code>.</p>
</div>
<div class="paragraph">
<p>To continue upon this example, if you launched the Job Template with the
<code>extra_vars</code> you added after the creation of <strong>j1</strong>, the relaunch job
created (<strong>j3</strong>) will include the <code>extra_vars</code>. And relaunching <strong>j3</strong>
results in the creation of <strong>j4</strong>, which would also include <code>extra_vars</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_job_slice"><a class="anchor" href="#ug_job_slice"></a>22. Job Slicing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>sliced job</code> refers to the concept of a distributed job. Distributed
jobs are used for running a job across a very large number of hosts,
allowing you to run multiple ansible-playbooks, each on a subset of an
inventory, that can be scheduled in parallel across a cluster.</p>
</div>
<div class="paragraph">
<p>By default, Ansible runs jobs from a single control instance. For jobs
that do not require cross-host orchestration, job slicing takes
advantage of automation controller&#8217;s ability to distribute work to
multiple nodes in a cluster. Job slicing works by adding a Job Template
field <code>job_slice_count</code>, which specifies the number of jobs into which
to slice the Ansible run. When this number is greater than 1, automation
controller will generate a workflow from a job template instead of a
job. The inventory will be distributed evenly amongst the slice jobs.
The workflow job is then started, and proceeds as though it were a
normal workflow. When launching a job, the API will return either a job
resource (if <code>job_slice_count = 1</code>) or a workflow job resource. The
corresponding User Interface will redirect to the appropriate screen to
display the status of the run.</p>
</div>
<div class="sect2">
<h3 id="_job_slice_considerations"><a class="anchor" href="#_job_slice_considerations"></a>22.1. Job slice considerations</h3>
<div class="paragraph">
<p>Consider the following when setting up job slices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A sliced job creates a workflow job, and then that creates jobs.</p>
</li>
<li>
<p>A job slice consists of a job template, an inventory, and a slice
count.</p>
</li>
<li>
<p>When executed, a sliced job splits each inventory into a number of
"slice size" chunks. It then queues jobs of ansible-playbook runs on
each chunk of the appropriate inventory. The inventory fed into
ansible-playbook is a pared-down version of the original inventory that
only contains the hosts in that particular slice. The completed sliced
job that displays on the Jobs list are labeled accordingly, with the
number of sliced jobs that have run:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sliced-job-shown-jobs-list-view.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>These sliced jobs follow normal scheduling behavior (number of forks,
queuing due to capacity, assignation to instance groups based on
inventory mapping).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Job slicing is intended to scale job executions horizontally. Enabling
job slicing on a job template divides an inventory to be acted upon in
the number of slices configured at launch time and then starts a job for
each slice.</p>
</div>
<div class="paragraph">
<p>It is expected that the number of slices will be equal to or less than
the number of controller nodes. Setting an extremely high number of job
slices (e.g., thousands), while allowed, can cause performance
degradation as the job scheduler is not designed to schedule
simultaneously thousands of workflow nodes, which are what the sliced
jobs become.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sliced job templates with prompts and/or extra variables behave the
same as standard job templates, applying all variables and limits to the
entire set of slice jobs in the resulting workflow job. However, when
passing a limit to a Sliced Job, if the limit causes slices to have no
hosts assigned, those slices will fail, causing the overall job to fail.</p>
</li>
<li>
<p>A job slice job status of a distributed job is calculated in the same
manner as workflow jobs; failure if there are any unhandled failures in
its sub-jobs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Warning</p>
</div>
<div class="paragraph">
<p>Any job that intends to orchestrate across hosts (rather than just
applying changes to individual hosts) should not be configured as a
slice job. Any job that does, may fail, and automation controller will
not attempt to discover or account for playbooks that fail when run as
slice jobs.</p>
</div>
</div>
<div class="sect2">
<h3 id="ug_job_slice_execution"><a class="anchor" href="#ug_job_slice_execution"></a>22.2. Job slice execution behavior</h3>
<div class="paragraph">
<p>When jobs are sliced, they can run on any node and some may not run at
the same time (insufficient capacity in the system, for example). When
slice jobs are running, job details display the workflow and job
slice(s) currently running, as well as a link to view their details
individually.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sliced-job-shown-jobs-output-view.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>By default, job templates are not normally configured to execute
simultaneously (<code>allow_simultaneous</code> must be checked in the API or
<strong>Enable Concurrent Jobs</strong> in the UI). Slicing overrides this behavior and
implies <code>allow_simultaneous</code> even if that setting is unchecked. See
<a href="#ug_JobTemplates">Job Templates</a> for information on how to specify this, as well as the
number of job slices on your job template configuration.</p>
</div>
<div class="paragraph">
<p>The <a href="#ug_JobTemplates">Job Templates</a> section provides additional detail on performing
the following operations in the User Interface:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Launch workflow jobs with a job template that has a slice number
greater than one</p>
</li>
<li>
<p>Cancel the whole workflow or individual jobs after launching a slice
job template</p>
</li>
<li>
<p>Relaunch the whole workflow or individual jobs after slice jobs finish
running</p>
</li>
<li>
<p>View the details about the workflow and slice jobs after a launching a
job template</p>
</li>
<li>
<p>Search slice jobs specifically after you create them (see subsequent
section, <a href="#ug_job_slice_search">Search job slices</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="ug_job_slice_search"><a class="anchor" href="#ug_job_slice_search"></a>22.3. Search job slices</h3>
<div class="paragraph">
<p>To make it easier to find slice jobs, use the Search functionality to
apply a search filter to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>job lists to show only slice jobs</p>
</li>
<li>
<p>job lists to show only parent workflow jobs of job slices</p>
</li>
<li>
<p>job templates lists to only show job templates that produce slice jobs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To show only slice jobs in job lists, as with most cases, you can filter
either on the type (jobs here) or <code>unified_jobs</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/api/v2/jobs/?job_slice_count__gt=1</pre>
</div>
</div>
<div class="paragraph">
<p>To show only parent workflow jobs of job slices:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/api/v2/workflow_jobs/?job_template__isnull=false</pre>
</div>
</div>
<div class="paragraph">
<p>To show only job templates that produce slice jobs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/api/v2/job_templates/?job_slice_count__gt=1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_workflows"><a class="anchor" href="#ug_workflows"></a>23. Workflows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Workflows allow you to configure a sequence of disparate job templates
(or workflow templates) that may or may not share inventory, playbooks,
or permissions. However, workflows have âadminâ and âexecuteâ
permissions, similar to job templates. A workflow accomplishes the task
of tracking the full set of jobs that were part of the release process
as a single unit.</p>
</div>
<div class="paragraph">
<p>Job or workflow templates are linked together using a graph-like
structure called nodes. These nodes can be jobs, project syncs, or
inventory syncs. A template can be part of different workflows or used
multiple times in the same workflow. A copy of the graph structure is
saved to a workflow job when you launch the workflow.</p>
</div>
<div class="paragraph">
<p>The example below shows a workflow that contains all three, as well as a
workflow job template:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-all-scenarios-wf-in-wf.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>As the workflow runs, jobs are spawned from the node&#8217;s linked template.
Nodes linking to a job template which has prompt-driven fields
(<code>job_type</code>, <code>job_tags</code>, <code>skip_tags</code>, <code>limit</code>) can contain those fields,
and will not be prompted on launch. Job templates with promptable
credential and/or inventory, WITHOUT defaults, will not be available for
inclusion in a workflow.</p>
</div>
<div class="sect2">
<h3 id="_workflow_scenarios_and_considerations"><a class="anchor" href="#_workflow_scenarios_and_considerations"></a>23.1. Workflow scenarios and considerations</h3>
<div class="paragraph">
<p>Consider the following scenarios for building workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A root node is set to ALWAYS by default and it not editable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-root-node-always.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>A node can have multiple parents and children may be linked to any of
the states of success, failure, or always. If always, then the state is
neither success or failure. States apply at the node level, not at the
workflow job template level. A workflow job will be marked as successful
unless it is canceled or encounters an error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-sibling-nodes-all-edge-types.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you remove a job or workflow template within the workflow, the
node(s) previously connected to those deleted, automatically get
connected upstream and retains its edge type as in the example below:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-delete-scenario.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>You could have a convergent workflow, where multiple jobs converge
into one. In this scenario, any of the jobs or all of them must complete
before the next one runs, as shown in the example below:</p>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-convergence.png" alt="image"></span></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the example provided, automation controller runs the first two job
templates in parallel. When they both finish and succeed as specified,
the 3rd downstream (<code>convergence node &lt;convergence_node&gt;</code>), will
trigger.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prompts for inventory and surveys will apply to workflow nodes in
workflow job templates.</p>
</li>
<li>
<p>If you launch from the API, running a <code>get</code> command displays a list of
warnings and highlights missing components. The basic workflow for a
workflow job template is illustrated below.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/workflow-diagram.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is possible to launch several workflows simultaneously, and set a
schedule for when to launch them. You can set notifications on
workflows, such as when a job completes, similar to that of job
templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Job slicing is intended to scale job executions horizontally. Enabling
job slicing on a job template divides an inventory to be acted upon in
the number of slices configured at launch time and then starts a job for
each slice.</p>
</div>
<div class="paragraph">
<p>It is expected that the number of slices will be equal to or less than
the number of controller nodes. Setting an extremely high number of job
slices (e.g., thousands), while allowed, can cause performance
degradation as the job scheduler is not designed to schedule
simultaneously thousands of workflow nodes, which are what the sliced
jobs become.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can build a recursive workflow, but if automation controller
detects an error, it will stop at the time the nested workflow attempts
to run.</p>
</li>
<li>
<p>Artifacts gathered in jobs in the sub-workflow will be passed to
downstream nodes.</p>
</li>
<li>
<p>An inventory can be set at the workflow level, or prompt for inventory
on launch.</p>
</li>
<li>
<p>When launched, all job templates in the workflow that have
<code>ask_inventory_on_launch=true</code> will use the workflow level inventory.</p>
</li>
<li>
<p>Job templates that do not prompt for inventory will ignore the
workflow inventory and run against their own inventory.</p>
</li>
<li>
<p>If a workflow prompts for inventory, schedules and other workflow
nodes may provide the inventory.</p>
</li>
<li>
<p>In a workflow convergence scenario, <code>set_stats</code> data will be merged in
an undefined way, so it is recommended that you set unique keys.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_extra_variables"><a class="anchor" href="#_extra_variables"></a>23.2. Extra Variables</h3>
<div class="paragraph">
<p>Also similar to job templates, workflows use surveys to specify
variables to be used in the playbooks in the workflow, called
extra_vars. Survey variables are combined with extra_vars defined on the
workflow job template, and saved to the workflow job extra_vars.
extra_vars in the workflow job are combined with job template variables
when spawning jobs within the workflow.</p>
</div>
<div class="paragraph">
<p>Workflows utilize the same behavior (hierarchy) of variable precedence
as Job Templates with the exception of three additional variables. Refer
to the Variable Precedence Hierarchy in the <a href="#ug_jobtemplates_extravars">Extra Variables</a>
section of the Job Templates chapter of this guide. The three additional
variables include:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Architecture-Tower_Variable_Precedence_Hierarchy-Workflows.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Workflows included in a workflow will follow the same variable
precedence - they will only inherit variables if they are specifically
prompted for, or defined as part of a survey.</p>
</div>
<div class="paragraph">
<p>In addition to the workflow <code>extra_vars</code>, jobs and workflows ran as part
of a workflow can inherit variables in the artifacts dictionary of a
parent job in the workflow (also combining with ancestors further
upstream in its branch). These can be defined by the <code>set_stats</code>
<a href="https://docs.ansible.com/ansible/latest/modules/set_stats_module.html">Ansible
module</a>.</p>
</div>
<div class="paragraph">
<p>If you use the <code>set_stats</code> module in your playbook, you can produce
results that can be consumed downstream by another job, for example,
notify users as to the success or failure of an integration run. In this
example, there are two playbooks that can be combined in a workflow to
exercise artifact passing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>invoke_set_stats.yml</strong>: f.adoc[] playbook in the workflow:</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>---
- hosts: localhost
  tasks:
    - name: "Artifact integration test results to the web"
      local_action: 'shell curl -F "file=@integration_results.txt" https://file.io'
      register: result

    - name: "Artifact URL of test results to Workflows"
      set_stats:
        data:
          integration_results_url:  "{{ (result.stdout|from_json).link }}"</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>use_set_stats.yml</strong>: second playbook in the workflow</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>---
- hosts: localhost
  tasks:
    - name: "Get test results from the web"
      uri:
        url: "{{ integration_results_url }}"
        return_content: true
      register: results

    - name: "Output test results"
      debug:
        msg: "{{ results.content }}"</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>set_stats</code> module processes this workflow as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The contents of an integration results (example:
integration_results.txt below) is f.adoc[] uploaded to the web.</p>
</li>
</ol>
</div>
<div class="literalblock">
<div class="content">
<pre>the tests are passing!</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Through the <strong>invoke_set_stats</strong> playbook, <code>set_stats</code> is then invoked
to artifact the URL of the uploaded integration_results.txt into the
Ansible variable "integration_results_url".</p>
</li>
<li>
<p>The second playbook in the workflow consumes the Ansible extra
variable "integration_results_url". It calls out to the web using the
<code>uri</code> module to get the contents of the file uploaded by the previous
Job Template Job. Then, it simply prints out the contents of the gotten
file.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>For artifacts to work, keep the default setting, <code>per_host = False</code> in
the <code>set_stats</code> module.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workflow_states"><a class="anchor" href="#_workflow_states"></a>23.3. Workflow States</h3>
<div class="paragraph">
<p>The workflow job can have the following states (no Failed state):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Waiting</p>
</li>
<li>
<p>Running</p>
</li>
<li>
<p>Success (finished)</p>
</li>
<li>
<p>Cancel</p>
</li>
<li>
<p>Error</p>
</li>
<li>
<p>Failed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the workflow scheme, canceling a job cancels the branch, while
canceling the workflow job cancels the entire workflow.</p>
</div>
</div>
<div class="sect2">
<h3 id="_role_based_access_controls"><a class="anchor" href="#_role_based_access_controls"></a>23.4. Role-Based Access Controls</h3>
<div class="paragraph">
<p>To edit and delete a workflow job template, you must have the admin
role. To create a workflow job template, you must be an organization
admin or a system admin. However, you can run a workflow job template
that contains job templates you don&#8217;t have permissions for. Similar to
projects, organization admins can create a blank workflow and then grant
an 'admin_role' to a low-level user, after which they can go about
delegating more access and building the graph. You must have execute
access to a job template to add it to a workflow job template.</p>
</div>
<div class="paragraph">
<p>Other tasks such as the ability to make a duplicate copy and re-launch a
workflow can also be performed, depending on what kinds of permissions
are granted to a particular user. Generally, you should have permissions
to all the resources used in a workflow (like job templates) before
relaunching or making a copy.</p>
</div>
<div class="paragraph">
<p>For more information on performing the tasks described in this section,
refer to the <code>Administration Guide &lt;administration:ag_start&gt;</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_wf_templates"><a class="anchor" href="#ug_wf_templates"></a>24. Workflow Job Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>workflow job template</code> links together a sequence of disparate
resources that accomplishes the task of tracking the full set of jobs
that were part of the release process as a single unit. These resources
may include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>job templates</p>
</li>
<li>
<p>workflow templates</p>
</li>
<li>
<p>project syncs</p>
</li>
<li>
<p>inventory source syncs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>Templates</strong> menu opens a list of the workflow and job templates that
are currently available. The default view is collapsed (Compact),
showing the template name, template type, and the statuses of the jobs
that ran using that template, but you can click <strong>Expanded</strong> to view more
information. This list is sorted alphabetically by name, but you can
sort by other criteria, or search by various fields and attributes of a
template. From this screen, you can launch
(<span class="image"><img src="images/launch-button.png" alt="launch"></span>), edit
(<span class="image"><img src="images/edit-button.png" alt="edit"></span>), and copy
(<span class="image"><img src="images/copy-button.png" alt="copy"></span>) a job template.</p>
</div>
<div class="paragraph">
<p>Only workflow templates have the Workflow Visualizer icon
(<span class="image"><img src="images/wf-viz-icon.png" alt="wf-viz-icon"></span>) as a
shortcut for accessing the workflow editor.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-templates-home-with-example-wf-template.png" alt="Wf templates - home with example wf template"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Workflow templates can be used as building blocks for another workflow
template. Many parameters in a workflow template allow you to enable
<strong>Prompt on Launch</strong> that can be modified at the workflow job template
level, and do not affect the values assigned at the individual workflow
template level. For instructions, see the <a href="#ug_wf_editor">Workflow Visualizer</a> section.</p>
</div>
<div class="sect2">
<h3 id="_create_a_workflow_template"><a class="anchor" href="#_create_a_workflow_template"></a>24.1. Create a Workflow Template</h3>
<div class="paragraph">
<p>To create a new workflow job template:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the
<span class="image"><img src="images/add-options-template.png" alt="add options template"></span> button then select <strong>Workflow Template</strong> from the menu list.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-templates-create-new-wf-template.png" alt="Wf templates - create new wf template"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enter the appropriate details into the following fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter a name for the workflow template.</p>
</li>
<li>
<p><strong>Description</strong>: Enter an arbitrary description as appropriate
(optional).</p>
</li>
<li>
<p><strong>Organization</strong>: Optionally enter or search for an organization to
associate the workflow.</p>
</li>
<li>
<p><strong>Inventory</strong>: Optionally enter or search for an inventory to be used
with this workflow template from the inventories available to the
currently logged in user.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, you can provide an inventory when
this workflow template is launched, or when this workflow template is
used within another workflow template.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Limit</strong>: Optionally specify a limit for subset of servers that your
workflow is going to run. This value is a host pattern to further
constrain the list of hosts managed or affected by the playbook.
Multiple patterns can be separated by colons (â:â). As with core
Ansible, âa:bâ means âin group a or bâ, âa:b:&amp;câ means âin a or b but
must be in câ, and âa:!bâ means âin a, and definitely not in bâ.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose a limit.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SCM Branch</strong>: Optionally specify the branch to override all job
template nodes that prompt for a branch.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose an SCM branch.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Labels</strong>: Supply optional labels that describe this workflow template,
such as "dev" or "test". Labels can be used to group and filter workflow
templates and completed jobs in the display.</p>
<div class="ulist">
<ul>
<li>
<p>Labels are created when they are added to the Workflow Template.
Labels are associated to a single Organization using the Project that is
provided in the Workflow Template. Members of the Organization can
create labels on a Workflow Template if they have edit permissions (such
as an admin role).</p>
</li>
<li>
<p>Once the Workflow Template is saved, the labels appear in the
Templates overview.</p>
</li>
<li>
<p>Click on the "x" beside a label to remove it. When a label is
removed, and is no longer associated with a Workflow or Workflow
Template, the label is permanently deleted from the list of Organization
labels.</p>
</li>
<li>
<p>Jobs inherit labels from the Workflow Template at the time of launch.
If a label is deleted from a Workflow Template, it is also deleted from
the Job.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Options</strong>:</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p>Check <strong>Enable Concurrent Jobs</strong> to allow simultaneous runs of this
workflow. Refer to <a href="#ug_job_concurrency">[ug_job_concurrency]</a> for additional information.</p>
</li>
<li>
<p>Check <strong>Enable Webhooks</strong> to turn on the ability to interface with a
predefined SCM system web service that is used to launch a job template.
Currently supported SCM systems are GitHub and GitLab.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div id="ug_wfjt_enable_webhooks" class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If you enable webhooks, other fields display, prompting for additional
information:</p>
</div>
</div>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Webhook Service</strong>: Select which service to listen for webhooks from</p>
</li>
<li>
<p><strong>Webhook Credential</strong>: Optionally, provide a GitHub or GitLab personal
access token (PAT) as a credential to use to send status updates back to
the webhook service. Before you can select it, the credential must
exist. See <a href="#ug_credentials_cred_types">Credential Types</a> to create one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon <strong>Save</strong>, additional fields populate and the Workflow Visualizer
automatically opens.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Webhook URL</strong>: Automatically populated with the URL for the webhook
service to POST requests to.</p>
</li>
<li>
<p><strong>Webhook Key</strong>: Generated shared secret to be used by the webhook
service to sign payloads sent to automation controller. This must be
configured in the settings on the webhook service in order for
automation controller to accept webhooks from this service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For additional information on setting up webhooks, see <a href="#ug_webhooks">[ug_webhooks]</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="openblock">
<div class="content">

</div>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Extra Variables</strong>:</p>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p>Pass extra command line variables to the playbook. This is the "-e"
or "--extra-vars" command line parameter for ansible-playbook that is
documented in the Ansible documentation at
<a href="http://docs.ansible.com/playbooks_variables.html#passing-variables-on-the-command-line">Passing
Variables on the Command Line</a>.</p>
</li>
<li>
<p>Provide key/value pairs using either YAML or JSON. These variables
have a maximum value of precedence and overrides other variables
specified elsewhere. An example value might be:</p>
<div class="quoteblock">
<blockquote>
<div class="literalblock">
<div class="content">
<pre>git_branch: production
release_version: 1.5</pre>
</div>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about extra variables, refer to
<a href="#ug_wf_templates_extravars">Extra Variables</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied,
you will be prompted upon launch to choose command line variables.</p>
</li>
</ul>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you want to be able to specify <code>extra_vars</code> on a schedule, you must
select <strong>Prompt on Launch</strong> for <strong>EXTRA VARIABLES</strong> on the workflow
template, or a enable a survey on the workflow template, then those
answered survey questions become <code>extra_vars</code>.</p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>When you have completed configuring the workflow template, click
<strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Saving the template exits the Workflow Template page and the Workflow
Visualizer opens to allow you to build a workflow. See the
<a href="#ug_wf_editor">Workflow Visualizer</a> section for further instructions. Otherwise, you may
close the Workflow Visualizer to return to the Details tab of the newly
saved template in order to review, edit, add permissions, notifications,
schedules, and surveys, or view completed jobs and build a workflow
template at a later time. Alternatively, you can click <strong>Launch</strong> to
launch the workflow, but you must first save the template prior to
launching, otherwise, the <strong>Launch</strong> button remains grayed-out. Also, note
the <strong>Notifications</strong> tab is present only after the template has been
saved.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-templates-wf-template-saved.png" alt="image"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_permissions_2"><a class="anchor" href="#_work_with_permissions_2"></a>24.2. Work with Permissions</h3>
<div class="paragraph">
<p>Clicking on <strong>Access</strong> allows you to review, grant, edit, and remove
associated permissions for users as well as team members.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-template-completed-permissions-view.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Click the <strong>Add</strong> button to create new permissions for this workflow
template by following the prompts to assign them accordingly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_notifications_4"><a class="anchor" href="#_work_with_notifications_4"></a>24.3. Work with Notifications</h3>
<div class="paragraph">
<p>Clicking on <strong>Notifications</strong> allows you to review any notification
integrations you have setup. The <strong>Notifications</strong> tab is present only
after the template has been saved.</p>
</div>
<div class="paragraph">
<p>Use the toggles to enable or disable the notifications to use with your
particular template. For more detail, see <a href="#ug_notifications_on_off">[ug_notifications_on_off]</a>.</p>
</div>
<div class="paragraph">
<p>If no notifications have been set up, see <a href="#ug_notifications_create">[ug_notifications_create]</a> for
detail.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-template-no-notifications-blank.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Refer to <a href="#ug_notifications_types">[ug_notifications_types]</a> for additional details on configuring
various notification types.</p>
</div>
</div>
<div class="sect2">
<h3 id="_view_completed_jobs_2"><a class="anchor" href="#_view_completed_jobs_2"></a>24.4. View Completed Jobs</h3>
<div class="paragraph">
<p>The <strong>Completed Jobs</strong> tab provides the list of workflow templates that
have ran. Click <strong>Expanded</strong> to view the various details of each job.</p>
</div>
<div class="paragraph">
<p>From this view, you can click the job ID - name of the workflow job and
see its graphical representation. The example below shows the job
details of a workflow job.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-template-jobID-detail-example.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The nodes are marked with labels that help you identify them at a
glance. See the <a href="#legend">legend</a> in the <a href="#ug_wf_editor">Workflow Visualizer</a> section for
more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_schedules_2"><a class="anchor" href="#_work_with_schedules_2"></a>24.5. Work with Schedules</h3>
<div class="paragraph">
<p>Clicking on <strong>Schedules</strong> allows you to review any schedules set up for
this template.</p>
</div>
<div class="sect3">
<h4 id="_schedule_a_workflow_template"><a class="anchor" href="#_schedule_a_workflow_template"></a>24.5.1. Schedule a Workflow Template</h4>
<div class="paragraph">
<p>To schedule a job template run, click the <strong>Schedules</strong> tab.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If schedules are already set up; review, edit, or enable/disable your
schedule preferences.</p>
</li>
<li>
<p>If schedules have not been set up, refer to <a href="#ug_scheduling">[ug_scheduling]</a> for more
information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a workflow template used in a nested workflow has a survey, or the
<strong>Prompt on Launch</strong> selected for the inventory option, the <strong>PROMPT</strong>
button displays next to the <strong>SAVE</strong> and <strong>CANCEL</strong> buttons on the schedule
form. Clicking the <strong>PROMPT</strong> button shows an optional INVENTORY step
where you can provide or remove an inventory or skip this step without
any changes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_wf_surveys"><a class="anchor" href="#ug_wf_surveys"></a>24.6. Surveys</h3>
<div class="paragraph">
<p>Workflows containing job types of Run or Check provide a way to set up
surveys in the Workflow Job Template creation or editing screens.
Surveys set extra variables for the playbook similar to 'Prompt for
Extra Variables' does, but in a user-friendly question and answer way.
Surveys also allow for validation of user input. Click the <strong>Survey</strong> tab
to create a survey.</p>
</div>
<div class="paragraph">
<p>Use cases for surveys are numerous. An example might be if operations
wanted to give developers a "push to stage" button they could run
without advanced Ansible knowledge. When launched, this task could
prompt for answers to questions such as, "What tag should we release?"</p>
</div>
<div class="paragraph">
<p>Many types of questions can be asked, including multiple-choice
questions.</p>
</div>
<div class="sect3">
<h4 id="ug_wf_surveys_create"><a class="anchor" href="#ug_wf_surveys_create"></a>24.6.1. Create a Survey</h4>
<div class="paragraph">
<p>To create a survey:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Survey</strong> tab to bring up the <strong>Add Survey</strong> window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-template-create-survey.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Use the <strong>ON/OFF</strong> toggle button at the top of the screen to quickly
activate or deactivate this survey prompt.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>A survey can consist of any number of questions. For each question,
enter the following information:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: The question to ask the user.</p>
</li>
<li>
<p><strong>Description</strong>: (optional) A description of what&#8217;s being asked of the
user.</p>
</li>
<li>
<p><strong>Answer Variable Name</strong>: The Ansible variable name to store the user&#8217;s
response in. This is the variable to be used by the playbook. Variable
names cannot contain spaces.</p>
</li>
<li>
<p><strong>Answer Type</strong>: Choose from the following question types.</p>
<div class="ulist">
<ul>
<li>
<p><em>Text</em>: A single line of text. You can set the minimum and maximum
length (in characters) for this answer.</p>
</li>
<li>
<p><em>Textarea</em>: A multi-line text field. You can set the minimum and
maximum length (in characters) for this answer.</p>
</li>
<li>
<p><em>Password</em>: Responses are treated as sensitive information, much like
an actual password is treated. You can set the minimum and maximum
length (in characters) for this answer.</p>
</li>
<li>
<p><em>Multiple Choice (single select)</em>: A list of options, of which only
one can be selected at a time. Enter the options, one per line, in the
<strong>Multiple Choice Options</strong> box.</p>
</li>
<li>
<p><em>Multiple Choice (multiple select)</em>: A list of options, any number of
which can be selected at a time. Enter the options, one per line, in the
<strong>Multiple Choice Options</strong> box.</p>
</li>
<li>
<p><em>Integer</em>: An integer number. You can set the minimum and maximum
length (in characters) for this answer.</p>
</li>
<li>
<p><em>Float</em>: A decimal number. You can set the minimum and maximum length
(in characters) for this answer.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Default Answer</strong>: Depending on which type chosen, you can supply the
default answer to the question. This value is pre-filled in the
interface and is used if the answer is not provided by the user.</p>
</li>
<li>
<p><strong>Required</strong>: Whether or not an answer to this question is required from
the user.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Once you have entered the question information, click the <strong>Add</strong> button
to add the question.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A stylized version of the survey is presented in the Preview pane. For
any question, you can click on the <strong>Edit</strong> button to edit the question,
the <strong>Delete</strong> button to delete the question, and click and drag on the
grid icon to rearrange the order of the questions.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Return to the left pane to add additional questions.</p>
</li>
<li>
<p>When done, click <strong>Save</strong> to save the survey.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-template-completed-survey.png" alt="Workflow-template-completed-survey"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_optional_survey_questions_2"><a class="anchor" href="#_optional_survey_questions_2"></a>24.6.2. Optional Survey Questions</h4>
<div class="paragraph">
<p>The <strong>Required</strong> setting on a survey question determines whether the
answer is optional or not for the user interacting with it.</p>
</div>
<div class="paragraph">
<p>Behind the scenes, optional survey variables can be passed to the
playbook in <code>extra_vars</code>, even when they aren&#8217;t filled in.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a non-text variable (input type) is marked as optional, and is not
filled in, no survey <code>extra_var</code> is passed to the playbook.</p>
</li>
<li>
<p>If a text input or text area input is marked as optional, is not
filled in, and has a minimum <code>length &gt; 0</code>, no survey <code>extra_var</code> is
passed to the playbook.</p>
</li>
<li>
<p>If a text input or text area input is marked as optional, is not
filled in, and has a minimum <code>length === 0</code>, that survey <code>extra_var</code> is
passed to the playbook, with the value set to an empty string ( "" ).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ug_wf_editor"><a class="anchor" href="#ug_wf_editor"></a>24.7. Workflow Visualizer</h3>
<div class="paragraph">
<p>The Workflow Visualizer provides a graphical way of linking together job
templates, workflow templates, project syncs, and inventory syncs to
build a workflow template. Before building a workflow template, refer to
the <a href="#ug_workflows">Workflows</a> section for considerations associated with various
scenarios on parent, child, and sibling nodes.</p>
</div>
<div class="sect3">
<h4 id="_build_a_workflow"><a class="anchor" href="#_build_a_workflow"></a>24.7.1. Build a Workflow</h4>
<div class="paragraph">
<p>You can set up any combination of two or more of the following node
types to build a workflow: Template (Job Template or Workflow Job
Template), Project Sync, Inventory Sync, or Approval. Each node is
represented by a rectangle while the relationships and their associated
edge types are represented by a line (or link) that connects them.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the details/edit view of a workflow template, click the
<strong>Visualizer</strong> tab or from the Templates list view, click the
(<span class="image"><img src="images/wf-viz-icon.png" alt="wf-viz-icon"></span>) icon to
launch the Workflow Visualizer.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-new.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the <span class="image"><img src="images/wf-start-button.png" alt="start"></span>
button to display a list of nodes to add to your workflow.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-new-add-template-list.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>On the right pane, select the type of node you want to add from the
drop-down menu:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-add-node-selections.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>If selecting an <strong>Approval</strong> node, see <a href="#ug_wf_approval_nodes">Approval nodes</a> for further
detail.</p>
</div>
<div class="paragraph">
<p>Selecting a node provides the available valid options associated with
it.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If you select a job template that does not have a default inventory when
populating a workflow graph, the inventory of the parent workflow will
be used. Though a credential is not required in a job template, you will
not be able to choose a job template for your workflow if it has a
credential that requires a password, unless the credential is replaced
by a prompted credential.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Once a node is selected, the workflow begins to build, and you must
specify the type of action to be taken for the selected node. This
action is also referred to as <em>edge type</em>.</p>
</li>
<li>
<p>If the node is a root node, the edge type defaults to <strong>Always</strong> and is
non-editable.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For subsequent nodes, you can select one of the following scenarios
(edge type) to apply to each:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Always</strong>: Continue to execute regardless of success or failure.</p>
</li>
<li>
<p><strong>On Success</strong>: Upon successful completion, execute the next template.</p>
</li>
<li>
<p><strong>On Failure</strong>: Upon failure, execute a different template.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div id="convergence_node" class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Select the behavior of the node if it is a convergent node from the
<strong>Convergence</strong> field:</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Any</strong> is the default behavior, allowing <em>any</em> of the nodes to complete
as specified, before triggering the next converging node. As long as the
status of one parent meets one of those run conditions, an ANY child
node will run. In other words, an ANY node requires <strong>all</strong> nodes to
complete, but only one node must complete with the expected outcome.</p>
</li>
<li>
<p>Choose <strong>All</strong> to ensure that <em>all</em> nodes complete as specified, before
converging and triggering the next node. The purpose of ALL nodes is to
make sure that every parent met it&#8217;s expected outcome in order to run
the child node. The workflow checks to make sure every parent behaved as
expected in order to run the child node. Otherwise, it will not run the
child node.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If selected, the graphical view will label the node as <strong>ALL</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-convergent-node-all.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If a node is a root node, or a node that does not have any nodes
converging into it, setting the <strong>Convergence</strong> rule does not apply, as
its behavior is dictated by the action that triggers it.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>If a job template used in the workflow has <strong>Prompt on Launch</strong> selected
for any of its parameters, a <strong>Prompt</strong> button appears, allowing you to
change those values at the node level. Use the wizard to change the
value(s) in each of the tabs and click <strong>Confirm</strong> in the Preview tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-prompt-button-wizard.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Likewise, if a workflow template used in the workflow has <strong>Prompt on
Launch</strong> selected for the inventory option, use the wizard to supply the
inventory at the prompt. If the parent workflow has its own inventory,
it will override any inventory that is supplied here.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-prompt-button-inventory-wizard.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>For job templates with promptable fields that are required, but don&#8217;t
have a default, you must provide those values when creating a node
before the <strong>Select</strong> button becomes enabled. The two cases that disable
the <strong>Select</strong> button until a value is provided via the <strong>Prompt</strong> button:
1) when you select the <strong>Prompt on Launch</strong> checkbox in a job template,
but do not provide a default, or 2) when you create a survey question
that is required but don&#8217;t provide a default answer. However, this is
<strong>NOT</strong> the case with credentials. Credentials that require a password on
launch are <strong>not permitted</strong> when creating a workflow node, since
everything needed to launch the node must be provided when the node is
created. So, if a job template prompts for credentials, automation
controller prevents you from being able to select a credential that
requires a password.</p>
</div>
<div class="paragraph">
<p>You must also click <strong>Select</strong> when the prompt wizard closes in order to
apply the changes at that node. Otherwise, any changes you make will
revert back to the values set in the actual job template.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-wizard-buttons.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Once the node is created, it is labeled with its job type. A template
that is associated with each workflow node will run based on the
selected run scenario as it proceeds. Click the compass
(<span class="image"><img src="images/wf-editor-compass-button.png" alt="compass"></span>)
icon to display the legend for each run scenario and their job types.</p>
</div>
<div id="legend" class="paragraph">
<p><span class="image"><img src="images/wf-editor-key-dropdown-list.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Hovering over a node allows you to add
<span class="image"><img src="images/wf-editor-add-button.png" alt="add node"></span>
another node, view info
<span class="image"><img src="images/wf-editor-info-button.png" alt="info node"></span>
about the node, edit
<span class="image"><img src="images/edit-button.png" alt="edit"></span> the node details,
edit an existing link
<span class="image"><img src="images/wf-editor-edit-link.png" alt="edit link"></span>, or
delete
<span class="image"><img src="images/wf-editor-delete-button.png" alt="delete node"></span> the selected node.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-new-add-template.png" alt="image"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>When done adding/editing a node, click <strong>Select</strong> to save any
modifications and render it on the graphical view. For possible ways to
build your workflow, see <a href="#ug_wf_building_scenarios">Node building scenarios</a>.</p>
</li>
<li>
<p>When done with building your workflow template, click <strong>Save</strong> to save
your entire workflow template and return to the new Workflow Template
details page.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Important</p>
</div>
<div class="paragraph">
<p>Clicking <strong>Close</strong> on this pane will not save your work, but instead,
closes the entire Workflow Visualizer and you will have to start over.</p>
</div>
<div class="sect4">
<h5 id="ug_wf_approval_nodes"><a class="anchor" href="#ug_wf_approval_nodes"></a>Approval nodes</h5>
<div class="paragraph">
<p>Choosing an <strong>Approval</strong> node requires user intervention in order to
advance the workflow. This functions as a means to pause the workflow in
between playbooks so that a user can give approval to continue on to the
next playbook in the workflow, giving the user a specified amount of
time to intervene, but also allows the user to continue as quickly as
possible without having to wait on some other trigger.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-approval-form.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The default for the timeout is none, but you can specify the length of
time before the request expires and automatically gets denied. After
selecting and supplying the information for the approval node, it
displays on the graphical view with a pause
(<span class="image"><img src="images/wf-node-approval-icon.png" alt="pause"></span>) icon
next to it.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-approval-node.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The approver is anyone who can execute the workflow job template
containing the approval nodes, has org admin or above privileges (for
the org associated with that workflow job template), or any user who has
the <em>Approve</em> permission explicitly assigned to them within that
specific workflow job template.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-approval-notifications.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>If pending approval nodes are not approved within the specified time
limit (if an expiration was assigned) or they are denied, then they are
marked as "timed out" or "failed", respectively, and move on to the next
"on fail node" or "always node". If approved, the "on success" path is
taken. If you try to POST in the API to a node that has already been
approved, denied or timed out, an error message notifies you that this
action is redundant, and no further steps will be taken.</p>
</div>
<div class="paragraph">
<p>Below shows the various levels of permissions allowed on approval
workflows:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-approval-rbac.png" alt="image"></span></p>
</div>
</div>
<div class="sect4">
<h5 id="ug_wf_building_scenarios"><a class="anchor" href="#ug_wf_building_scenarios"></a>Node building scenarios</h5>
<div class="paragraph">
<p>You can add a sibling node by clicking the
<span class="image"><img src="images/wf-editor-add-button.png" alt="add node"></span> on
the parent node:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-sibling-node.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>You can insert another node in between nodes by hovering over the line
that connects the two until the
<span class="image"><img src="images/wf-editor-add-button.png" alt="add node"></span>
appears. Clicking on the
<span class="image"><img src="images/wf-editor-add-button.png" alt="add node"></span>
automatically inserts the node between the two nodes.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-insert-node-template.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To add a root node to depict a split scenario, click the
<span class="image"><img src="images/wf-start-button.png" alt="start"></span> button
again:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-new-add-template-split.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>At any node where you want to create a split scenario, hover over the
node from which the split scenario begins and click the
<span class="image"><img src="images/wf-editor-add-button.png" alt="add node"></span>.
This essentially adds multiple nodes from the same parent node, creating
sibling nodes:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-siblings.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>When adding a new node, the <strong>PROMPT</strong> button applies to workflow
templates as well. Workflow templates will prompt for inventory and
surveys.</p>
</div>
<div class="paragraph">
<p>If you want to undo the last inserted node, click on another node
without making a selection from the right pane. Or, click <strong>Cancel</strong> from
the right pane.</p>
</div>
<div class="paragraph">
<p>Below is an example of a workflow that contains all three types of jobs
that is initiated by a job template that if it fails to run, proceed to
the project sync job, and regardless of whether that fails or succeeds,
proceed to the inventory sync job.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-create-new-add-template-example.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Remember to refer to the Key at the top of the window to identify the
meaning of the symbols and colors associated with the graphical
depiction.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>In a workflow with a set of sibling nodes having varying edge types, and
you remove a node that has a follow-on node attached to it, the attached
node automatically joins the set of sibling nodes and retains its edge
type:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-delete-scenario.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The following ways you can modify your nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you want to edit a node, click on the node you want to edit. The
right pane displays the current selections. Make your changes and click
<strong>Select</strong> to apply them to the graphical view.</p>
</li>
<li>
<p>To edit the edge type for an existing link (success/failure/always),
click on the link. The right pane displays the current selection. Make
your changes and click <strong>Save</strong> to apply them to the graphical view.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-wizard-edit-link.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>To add a new link from one node to another, click the link
<span class="image"><img src="images/wf-editor-edit-link.png" alt="edit link"></span> icon
that appears on each node. Doing this highlights the nodes that are
possible to link to. These feasible options are indicated by the dotted
lines. Invalid options are indicated by grayed out boxes (nodes) that
would otherwise produce an invalid link. The example below shows the
<strong>Demo Project</strong> as a possible option for the <strong>e2e-ec20de52-project</strong> to
link to, as indicated by the arrows:</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/wf-node-link-scenario.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>To remove a link, click the link and click the <strong>Unlink</strong> button.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><span class="image"><img src="images/wf-editor-wizard-unlink.png" alt="image"></span></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>This button only appears in the right hand panel if the target or child
node has more than one parent. All nodes must be linked to at least one
other node at all times so you must create a new link before removing an
old one.</p>
</div>
<div class="paragraph">
<p>Click the settings icon
(<span class="image"><img src="images/settings.png" alt="settings"></span>) to zoom, pan,
or reposition the view. Alternatively, you can drag the workflow diagram
to reposition it on the screen or use the scroll on your mouse to zoom.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_launch_a_workflow_template"><a class="anchor" href="#_launch_a_workflow_template"></a>24.8. Launch a Workflow Template</h3>
<div class="paragraph">
<p>Launch a workflow template by any of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access the workflow templates list from the <strong>Templates</strong> menu on the
left navigation bar or while in the Workflow Template Details view,
scroll to the bottom to access the
<span class="image"><img src="images/launch-button.png" alt="launch"></span> button from
the list of templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-templates-wf-template-launch.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>While in the Job Template Details view of the job template you want to
launch, click <strong>Launch</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Along with any extra variables set in the job template and survey,
automation controller automatically adds the same variables as those
added for a job template upon launch. Additionally, automation
controller automatically redirects the web browser to the Jobs Details
page for this job, displaying the progress and the results.</p>
</div>
<div class="paragraph">
<p>Events related to approvals on workflows display in the Activity Stream
(<span class="image"><img src="images/activitystream.png" alt="activity-stream"></span>)
with detailed information about the approval requests, if any.</p>
</div>
</div>
<div class="sect2">
<h3 id="_copy_a_workflow_template"><a class="anchor" href="#_copy_a_workflow_template"></a>24.9. Copy a Workflow Template</h3>
<div class="paragraph">
<p>automation controller allows you the ability to copy a workflow
template. If you choose to copy a workflow template, it <strong>does not</strong> copy
any associated schedule, notifications, or permissions. Schedules and
notifications must be recreated by the user or admin creating the copy
of the workflow template. The user copying the workflow template will be
granted the admin permission, but no permissions are assigned (copied)
to the workflow template.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Access the workflow template that you want to copy from the
<strong>Templates</strong> menu on the left navigation bar or while in the Workflow Job
Template Details view, scroll to the bottom to access it from a list of
templates.</p>
</li>
<li>
<p>Click the <span class="image"><img src="images/copy-button.png" alt="copy"></span>
button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A new template opens with the name of the template from which you copied
and a timestamp.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/wf-list-view-copy-example.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Select the copied template and replace the contents of the <strong>Name</strong> field
with a new name, and provide or modify the entries in the other fields
to complete this template.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click <strong>Save</strong> when done.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>If a resource has a related resource that you don&#8217;t have the right level
of permission to, you cannot copy the resource, such as in the case
where a project uses a credential that a current user only has <em>Read</em>
access. However, for a workflow template, if any of its nodes uses an
unauthorized job template, inventory, or credential, the workflow
template can still be copied. But in the copied workflow template, the
corresponding fields in the workflow template node will be absent.</p>
</div>
</div>
<div class="sect2">
<h3 id="ug_wf_templates_extravars"><a class="anchor" href="#ug_wf_templates_extravars"></a>24.10. Extra Variables</h3>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p><code>extra_vars</code> passed to the job launch API are only honored if one of the
following is true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They correspond to variables in an enabled survey</p>
</li>
<li>
<p><code>ask_variables_on_launch</code> is set to True</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you pass survey variables, they are passed as extra variables
(<code>extra_vars</code>). This can be tricky, as passing extra variables to a
workflow template (as you would do with a survey) can override other
variables being passed from the inventory and project.</p>
</div>
<div class="paragraph">
<p>For example, say that you have a defined variable for an inventory for
<code>debug = true</code>. It is entirely possible that this variable,
<code>debug = true</code>, can be overridden in a workflow template survey.</p>
</div>
<div class="paragraph">
<p>To ensure that the variables you need to pass are not overridden, ensure
they are included by redefining them in the survey. Keep in mind that
extra variables can be defined at the inventory, group, and host levels.</p>
</div>
<div class="paragraph">
<p>The following table notes the behavior (hierarchy) of variable
precedence in automation controller as it compares to variable
precedence in Ansible.</p>
</div>
<div class="paragraph">
<p><strong>Variable Precedence Hierarchy (last listed wins)</strong></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Architecture-Tower_Variable_Precedence_Hierarchy-Workflows.png" alt="image"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_instance_groups"><a class="anchor" href="#ug_instance_groups"></a>25. Instance Groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <code>Instance Group</code> provides the ability to group instances in a
clustered environment. Additionally, policies dictate how instance
groups behave and how jobs are executed. The following view displays the
capacity levels based on policy algorithms:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-groups_list_view.png" alt="Instance Group policy example"></span></p>
</div>
<div class="paragraph">
<p>For more information about the policy or rules associated with instance
groups, see the <a href="#ag_instance_groups">[ag_instance_groups]</a> section of the Automation
Controller Administration Guide.</p>
</div>
<div class="paragraph">
<p>If you want to connect your instance group to a container, refer to
<a href="#ag_container_groups">[ag_container_groups]</a> for further detail.</p>
</div>
<div class="paragraph">
<p>For an in-depth discussion on these concepts, refer to the <em>Feature
Spotlight: Instance Groups and Isolated Nodes</em>
<a href="https://www.ansible.com/blog/ansible-tower-feature-spotlight-instance-groups-and-isolated-nodes">blog</a>.</p>
</div>
<div class="sect2">
<h3 id="_create_an_instance_group"><a class="anchor" href="#_create_an_instance_group"></a>25.1. Create an instance group</h3>
<div class="paragraph">
<p>To create a new instance group:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <strong>Instance Groups</strong> from the left navigation menu to open the
Instance Groups configuration window.</p>
</li>
<li>
<p>Click the <strong>Add</strong> button and select <strong>Create Instance Group</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-group-create-new-ig.png" alt="IG - create new IG"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Enter the appropriate details into the following fields:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>. Names must be unique and must not be named <em>controller</em>.</p>
</li>
<li>
<p><strong>Policy Instance Minimum</strong>. Enter the minimum number of instances to
automatically assign to this group when new instances come online.</p>
</li>
<li>
<p><strong>Policy Instance Percentage</strong>. Use the slider to select a minimum
percentage of instances to automatically assign to this group when new
instances come online.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Policy Instance fields are not required to create a new instance group.
If you do not specify values, then the Policy Instance Minimum and
Policy Instance Percentage default to 0.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the instance group is successfully created, the <strong>Details</strong> tab of
the newly created instance group remains, which allows you to review and
edit your instance group information. This is the same menu that is
opened if the Edit
(<span class="image"><img src="images/edit-button.png" alt="edit-button"></span>) button
is clicked from the <strong>Instance Group</strong> link. You can also edit <strong>Instances</strong>
and review <strong>Jobs</strong> associated with this instance group.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-group-example-ig-successfully-created.png" alt="IG - example IG successfully created"></span></p>
</div>
<div class="sect3">
<h4 id="_associate_instances_to_an_instance_group"><a class="anchor" href="#_associate_instances_to_an_instance_group"></a>25.1.1. Associate instances to an instance group</h4>
<div class="paragraph">
<p>To associate instances to an instance group:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Instances</strong> tab of the Instance Group window and click the
<strong>Add</strong> button.</p>
</li>
<li>
<p>Click the checkbox next to one or more available instances from the
list to select the instance(s) you want to add to the instance group.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-group-assoc-instances.png" alt="IG - select instances"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the following example, the instances added to the instance group
displays along with information about their capacity.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-group-instances-example.png" alt="IG - instances in IG"></span></p>
</div>
<div class="paragraph">
<p>This view also allows you to edit some key attributes associated with
the instances in your instance group:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-group-instances-example-callouts.png" alt="IG - instances in IG callouts"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_view_jobs_associated_with_an_instance_group"><a class="anchor" href="#_view_jobs_associated_with_an_instance_group"></a>25.1.2. View jobs associated with an instance group</h4>
<div class="paragraph">
<p>To view the jobs associated with the instance group, click the <strong>Jobs</strong>
tab of the Instance Group window and then click <strong>Expanded</strong> to expand the
view to show details about each job.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/instance-group-jobs-list.png" alt="IG - instances jobs"></span></p>
</div>
<div class="paragraph">
<p>Each job displays the job status, ID, and name; type of job, time
started and completed, who started the job; and which template,
inventory, project, and credential were used.</p>
</div>
<div class="paragraph">
<p>The instances are run in accordance with instance group policies. Refer
to <code>Instance Group Policies &lt;administration:ag_instance_group_policies&gt;</code>
in the Automation Controller Administration Guide.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ug_jobs"><a class="anchor" href="#ug_jobs"></a>26. Jobs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>job</code> is an instance of automation controller launching an Ansible
playbook against an inventory of hosts.</p>
</div>
<div class="paragraph">
<p>The <strong>Jobs</strong> link displays a list of jobs and their statuses&#8212;&#8203;shown as
completed successfully or failed, or as an active (running) job. The
default view is collapsed (<strong>Compact</strong>) with the job name, status, job
type, and start/finish times, but you can expand to see more
information. You can sort this list by various criteria, and perform a
search to filter the jobs of interest.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-home-with-example-job.png" alt="Jobs - home with example job"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-list-all-expanded.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Actions you can take from this screen include viewing the details and
standard output of a particular job, relaunching
(<span class="image"><img src="images/launch-button.png" alt="launch"></span>) jobs, or
removing selected jobs. The relaunch operation only applies to
relaunches of playbook runs and does not apply to project/inventory
updates, system jobs, workflow jobs, etc.</p>
</div>
<div id="ug_job_results" class="paragraph">
<p>When a job relaunches, you are directed the Jobs Output screen as the
job runs. Clicking on any type of job also takes you to the Job Output
View for that job, where you can filter jobs by various criteria:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-details-view-filters.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Stdout</strong> option is the default display that shows the job
processes and output</p>
</li>
<li>
<p>The <strong>Event</strong> option allows you to filter by the event(s) of interest,
such as errors, host failures, host retries, items skipped, etc. You can
include as many events in the filter as necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-details-view-filters-examples.png" alt="image"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Advanced</strong> option is a refined search that allows you a
combination of including or excluding criteria, searching by key, or by
lookup type. For details about using Search, refer to the <a href="#ug_search">Search</a>
chapter.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_inventory_sync_jobs"><a class="anchor" href="#_inventory_sync_jobs"></a>26.1. Inventory Sync Jobs</h3>
<div class="paragraph">
<p>When an inventory sync is executed, the full results automatically
display in the Output tab. This shows the same information you would see
if you ran it through the Ansible command line, and can be useful for
debugging. The <code>ANSIBLE_DISPLAY_ARGS_TO_STDOUT</code> is set to <code>False</code> by
default for all playbook runs. This matches Ansible&#8217;s default behavior.
This does not display task arguments in task headers in the Job Detail
interface to avoid leaking certain sensitive module parameters to
stdout. If you wish to restore the prior behavior (despite the security
implications), you can set <code>ANSIBLE_DISPLAY_ARGS_TO_STDOUT</code> to <code>True</code>
via the <code>AWX_TASK_ENV</code> configuration setting. For more details, refer to
the <a href="">ANSIBLE_DISPLAY_ARGS_TO_STDOUT</a>.</p>
</div>
<div class="paragraph">
<p>The icons at the top right corner of the Output tab allow you to
relaunch (<span class="image"><img src="images/launch-button.png" alt="launch"></span>),
download (<span class="image"><img src="images/download.png" alt="download"></span>) the
job output, or delete
(<span class="image"><img src="images/delete-button.png" alt="delete"></span>) the job.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-show-job-results-for-inv-sync.png" alt="job details example of inventory sync"></span></p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>An inventory update can be performed while a related job is running. In
cases where you have a big project (around 10 GB), disk space on <code>/tmp</code>
may be an issue.</p>
</div>
<div class="sect3">
<h4 id="_inventory_sync_details"><a class="anchor" href="#_inventory_sync_details"></a>26.1.1. Inventory sync details</h4>
<div class="paragraph">
<p>Access the <strong>Details</strong> tab to provide details about the job execution.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-show-job-details-for-inv-sync.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Notable details of the job executed are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Status</strong>: Can be any of the following:</p>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Pending</strong> - The inventory sync has been created, but not queued or
started yet. Any job, not just inventory source syncs, will stay in
pending until itâs actually ready to be run by the system. Reasons for
inventory source syncs not being ready include dependencies that are
currently running (all dependencies must be completed before the next
step can execute), or there is not enough capacity to run in the
locations it is configured to.</p>
</li>
<li>
<p><strong>Waiting</strong> - The inventory sync is in the queue waiting to be
executed.</p>
</li>
<li>
<p><strong>Running</strong> - The inventory sync is currently in progress.</p>
</li>
<li>
<p><strong>Successful</strong> - The inventory sync job succeeded.</p>
</li>
<li>
<p><strong>Failed</strong> - The inventory sync job failed.</p>
</li>
</ul>
</div>
</blockquote>
</div>
</li>
<li>
<p><strong>Inventory</strong>: The name of the associated inventory group.</p>
</li>
<li>
<p><strong>Source</strong>: The type of cloud inventory.</p>
</li>
<li>
<p><strong>Inventory Source Project</strong>: The project used as the source of this
inventory sync job.</p>
</li>
<li>
<p><strong>Execution Environment</strong>: The execution environment used.</p>
</li>
<li>
<p><strong>Execution node</strong>: The node used to execute the job.</p>
</li>
<li>
<p><strong>Instance Group</strong>: The name of the instance group used with this job
(controller is the default instance group).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By clicking on these items, where appropriate, you can view the
corresponding job templates, projects, and other objects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scm_inventory_jobs"><a class="anchor" href="#_scm_inventory_jobs"></a>26.2. SCM Inventory Jobs</h3>
<div class="paragraph">
<p>When an inventory sourced from an SCM is executed, the full results
automatically display in the Output tab. This shows the same information
you would see if you ran it through the Ansible command line, and can be
useful for debugging. The icons at the top right corner of the Output
tab allow you to relaunch
(<span class="image"><img src="images/launch-button.png" alt="launch"></span>), download
(<span class="image"><img src="images/download.png" alt="download"></span>) the job
output, or delete
(<span class="image"><img src="images/delete-button.png" alt="delete"></span>) the job.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-show-job-results-for-scm-job.png" alt="image"></span></p>
</div>
<div class="sect3">
<h4 id="_scm_inventory_details"><a class="anchor" href="#_scm_inventory_details"></a>26.2.1. SCM inventory details</h4>
<div class="paragraph">
<p>Access the <strong>Details</strong> tab to provide details about the job execution and
its associated project.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-show-job-details-for-scm-job.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Notable details of the job executed are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Status</strong>: Can be any of the following:</p>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Pending</strong> - The SCM job has been created, but not queued or started
yet. Any job, not just SCM jobs, will stay in pending until itâs
actually ready to be run by the system. Reasons for SCM jobs not being
ready include dependencies that are currently running (all dependencies
must be completed before the next step can execute), or there is not
enough capacity to run in the locations it is configured to.</p>
</li>
<li>
<p><strong>Waiting</strong> - The SCM job is in the queue waiting to be executed.</p>
</li>
<li>
<p><strong>Running</strong> - The SCM job is currently in progress.</p>
</li>
<li>
<p><strong>Successful</strong> - The last SCM job succeeded.</p>
</li>
<li>
<p><strong>Failed</strong> - The last SCM job failed.</p>
</li>
</ul>
</div>
</blockquote>
</div>
</li>
<li>
<p><strong>Job Type</strong>: SCM jobs display Source Control Update.</p>
</li>
<li>
<p><strong>Project</strong>: The name of the project.</p>
</li>
<li>
<p><strong>Project Status</strong>: Indicates whether the associated project was
successfully updated.</p>
</li>
<li>
<p><strong>Revision</strong>: Indicates the revision number of the sourced project that
was used in this job.</p>
</li>
<li>
<p><strong>Execution Environment</strong>: Specifies the execution environment used to
run this job.</p>
</li>
<li>
<p><strong>Execution Node</strong>: Indicates the node on which the job ran.</p>
</li>
<li>
<p><strong>Instance Group</strong>: Indicates the instance group on which the job ran,
if specified.</p>
</li>
<li>
<p><strong>Job Tags</strong>: Tags show the various job operations executed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By clicking on these items, where appropriate, you can view the
corresponding job templates, projects, and other objects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_playbook_run_jobs"><a class="anchor" href="#_playbook_run_jobs"></a>26.3. Playbook Run Jobs</h3>
<div class="paragraph">
<p>When a playbook is executed, the full results automatically display in
the Output tab. This shows the same information you would see if you ran
it through the Ansible command line, and can be useful for debugging.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-show-job-results-for-example-job.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The events summary captures a tally of events that were run as part of
this playbook:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the number of times this playbook has ran in the <strong>Plays</strong> field</p>
</li>
<li>
<p>the number of tasks associated with this playbook in the <strong>Tasks</strong> field</p>
</li>
<li>
<p>the number of hosts associated with this playbook in the <strong>Hosts</strong> field</p>
</li>
<li>
<p>the amount of time it took to complete the playbook run in the
<strong>Elapsed</strong> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-events-summary.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The icons next to the events summary allow you to relaunch
(<span class="image"><img src="images/launch-button.png" alt="launch"></span>), download
(<span class="image"><img src="images/download.png" alt="download"></span>) the job
output, or delete
(<span class="image"><img src="images/delete-button.png" alt="delete"></span>) the job.</p>
</div>
<div class="paragraph">
<p>The host status bar runs across the top of the Output view. Hover over a
section of the host status bar and the number of hosts associated with
that particular status displays.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-all-host-events.png" alt="Job - All Host Events"></span></p>
</div>
<div class="paragraph">
<p>The output for a Playbook job is also accessible after launching a job
from the <strong>Jobs</strong> tab of its Job Templates page.</p>
</div>
<div class="paragraph">
<p>Clicking on the various line item tasks in the output, you can view its
host details.</p>
</div>
<div class="sect3">
<h4 id="_search"><a class="anchor" href="#_search"></a>26.3.1. Search</h4>
<div class="paragraph">
<p>Use Search to look up specific events, hostnames, and their statuses. To
filter only certain hosts with a particular status, specify one of the
following valid statuses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OK</strong>: the playbook task returned "Ok".</p>
</li>
<li>
<p><strong>Changed</strong>: the playbook task actually executed. Since Ansible tasks
should be written to be idempotent, tasks may exit successfully without
executing anything on the host. In these cases, the task would return
Ok, but not Changed.</p>
</li>
<li>
<p><strong>Failed</strong>: the task failed. Further playbook execution was stopped for
this host.</p>
</li>
<li>
<p><strong>Unreachable</strong>: the host was unreachable from the network or had
another fatal error associated with it.</p>
</li>
<li>
<p><strong>Skipped</strong>: the playbook task was skipped because no change was
necessary for the host to reach the target state.</p>
</li>
<li>
<p><strong>Rescued</strong>: introduced in Ansible 2.8, this shows the tasks that failed
and then executes a rescue section.</p>
</li>
<li>
<p><strong>Ignored</strong>: introduced in Ansible 2.8, this shows the tasks that failed
and have <code>ignore_errors: yes</code> configured.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These statuses also display at bottom of each Stdout pane, in a group of
"stats" called the Host Summary fields.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-std-out-host-summary-rescued-ignored.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>The example below shows a search with only unreachable hosts.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-std-out-filter-failed.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>For more details about using the Search, refer to the <a href="#ug_search">Search</a>
chapter.</p>
</div>
<div class="paragraph">
<p>The standard output view displays all the events that occur on a
particular job. By default, all rows are expanded so that all the
details are displayed. Use the collapse-all button
(<span class="image"><img src="images/job-details-view-std-out-collapse-all-icon.png" alt="collapse-all"></span>)
to switch to a view that only contains the headers for plays and tasks.
Click the
(<span class="image"><img src="images/job-details-view-std-out-expand-all-icon.png" alt="expand-all"></span>)
button to view all lines of the standard output.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can display all the details of a specific play or
task by clicking on the arrow icons next to them. Click an arrow from
sideways to downward to expand the lines associated with that play or
task. Click the arrow back to the sideways position to collapse and hide
the lines.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-details-view-std-out-expand-collapse-icons.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Things to note when viewing details in the expand/collapse mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each displayed line that is not collapsed has a corresponding line
number and start time.</p>
</li>
<li>
<p>An expand/collapse icon is at the start of any play or task after the
play or task has completed.</p>
</li>
<li>
<p>If querying for a particular play or task, it will appear collapsed at
the end of its completed process.</p>
</li>
<li>
<p>In some cases, an error message will appear, stating that the output
may be too large to display. This occurs when there are more than 4000
events. Use the search and filter for specific events to bypass the
error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click on a line of an event from the <strong>Standard Out</strong> pane and a <strong>Host
Events</strong> dialog displays in a separate window. This window shows the host
that was affected by that particular event.</p>
</div>
<div class="paragraph">
<p>Note</p>
</div>
<div class="paragraph">
<p>Upgrading to the latest versions of Ansible Automation Platform involves
progressively migrating all historical playbook output and events. This
migration process is gradual, and happens automatically in the
background after installation is complete. Installations with very large
amounts of historical job output (tens, or hundreds of GB of output) may
notice missing job output until migration is complete. Most recent data
will show up at the top of the output, followed by older events.
Migrating jobs with a large amount of events may take longer than jobs
with a smaller amount.</p>
</div>
</div>
<div class="sect3">
<h4 id="_host_details"><a class="anchor" href="#_host_details"></a>26.3.2. Host Details</h4>
<div class="paragraph">
<p>The <strong>Host Details</strong> dialog shows information about the host affected by
the selected event and its associated play and task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <strong>Host</strong></p>
</li>
<li>
<p>the <strong>Status</strong></p>
</li>
<li>
<p>the type of run in the <strong>Play</strong> field</p>
</li>
<li>
<p>the type of <strong>Task</strong></p>
</li>
<li>
<p>if applicable, the Ansible <strong>Module</strong> for the task, and any <em>arguments</em>
for that module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/job-details-host-hostevent.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>To view the results in JSON format, click on the <strong>JSON</strong> tab. To view the
output of the task, click the <strong>Standard Out</strong>. To view errors from the
output, click <strong>Standard Error</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_playbook_run_details"><a class="anchor" href="#_playbook_run_details"></a>26.3.3. Playbook run details</h4>
<div class="paragraph">
<p>Access the <strong>Details</strong> tab to provide details about the job execution.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/jobs-show-job-details-for-example-job.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Notable details of the job executed are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Status</strong>: Can be any of the following:</p>
<div class="quoteblock">
<blockquote>
<div class="ulist">
<ul>
<li>
<p><strong>Pending</strong> - The playbook run has been created, but not queued or
started yet. Any job, not just playbook runs, will stay in pending until
it is actually ready to be run by the system. Reasons for playbook runs
not being ready include dependencies that are currently running (all
dependencies must be completed before the next step can execute), or
there is not enough capacity to run in the locations it is configured
to.</p>
</li>
<li>
<p><strong>Waiting</strong> - The playbook run is in the queue waiting to be executed.</p>
</li>
<li>
<p><strong>Running</strong> - The playbook run is currently in progress.</p>
</li>
<li>
<p><strong>Successful</strong> - The last playbook run succeeded.</p>
</li>
<li>
<p><strong>Failed</strong> - The last playbook run failed.</p>
</li>
</ul>
</div>
</blockquote>
</div>
</li>
<li>
<p><strong>Job Template</strong>: The name of the job template from which this job was
launched.</p>
</li>
<li>
<p><strong>Inventory</strong>: The inventory selected to run this job against.</p>
</li>
<li>
<p><strong>Project</strong>: The name of the project associated with the launched job.</p>
</li>
<li>
<p><strong>Project Status</strong>: The status of the project associated with the
launched job.</p>
</li>
<li>
<p><strong>Playbook</strong>: The playbook used to launch this job.</p>
</li>
<li>
<p><strong>Execution Environment</strong>: The name of the execution environment used in
this job.</p>
</li>
<li>
<p><strong>Container Group</strong>: The name of the container group used in this job.</p>
</li>
<li>
<p><strong>Credentials</strong>: The credential(s) used in this job.</p>
</li>
<li>
<p><strong>Extra Variables</strong>: Any extra variables passed when creating the job
template are displayed here.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By clicking on these items, where appropriate, you can view the
corresponding job templates, projects, and other objects.</p>
</div>
<div id="ug_job_concurrency" class="paragraph">
<p>Automation controller Capacity Determination and Job Impact</p>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Job branch overriding

:leveloffset!:
:leveloffset: 0

[[ug_webhooks]]
== Working with Webhooks

A `Webhook` provides the ability to execute specified commands between
apps over the web. automation controller currently provides webhook
integration with GitHub and GitLab. This section describes the procedure
for setting up a webhook through their respective services.

The webhook post-status-back functionality for GitHub and GitLab is
designed for work only under certain CI events. Receiving another kind
of event will result in messages like the one below in the service log:

....
awx.main.models.mixins Webhook event did not have a status API endpoint associated, skipping.
....

=== GitHub webhook setup

Automation controller has the ability to run jobs based on a triggered
webhook event coming in. Job status information (pending, error,
success) can be sent back only for pull request events. If you determine
you do not want automation controller to post job statuses back to the
webhook service, skip steps 1-2, and go directly to
`step 3 &lt;ug_webhooks_setup_github&gt;`.

[arabic]
. Optionally generate a personal access token (PAT) for use with
automation controller.
+
________________________________________________________________________________________________________________________________________________________________________________________________________
[loweralpha]
.. In the profile settings of your GitHub account, click *Settings*.
.. At the very bottom of the settings, click *&lt;&gt; Developer Settings*.
.. In the Developer settings, click *Personal access tokens*.
.. From the Personal access tokens screen, click *Generate new token*.
.. When prompted, enter your GitHub account password to continue.
.. In the *Note* field, enter a brief description about what this PAT
will be used for.
.. In the Scope fields, the automation webhook only needs repo scope
access, with the exception of invites. For information about other
scopes, click the link right above the table to access the docs.

image:webhooks-create-webhook-github-scope.png[image]

[loweralpha, start=8]
.. Click the *Generate Token* button.
.. Once the token is generated, make sure you copy the PAT, as it will
be used in a later step. You will not be able to access this token again
in GitHub.
________________________________________________________________________________________________________________________________________________________________________________________________________
. Use the PAT to optionally create a GitHub credential:
+
_________________________________________________________________________________________________________________________________________________
[loweralpha]
.. Go to your instance, and
`create a new credential for the GitHub PAT &lt;ug_credentials_github&gt;`
using the above generated token.
.. Make note of the name of this credential, as it will be used in the
job template that posts back to GitHub.

image:webhooks-create-credential-github-PAT-token.png[image]

[loweralpha, start=3]
.. Go to the job template with which you want to enable webhooks, and
select the webhook service and credential you created in the previous
step.

image:webhooks-job-template-gh-webhook-credential.png[image]

[verse]
--

--

[loweralpha, start=4]
.. Click *Save*. Now your job template is set up to be able to post back
to GitHub. An example of one may look like this:

image:webhooks-tower-to-github-status.png[image]
_________________________________________________________________________________________________________________________________________________

[[ug_webhooks_setup_github]]
[arabic, start=3]
. Go to a specific GitHub repo you want to configure webhooks and click
*Settings*.

image:webhooks-github-repo-settings.png[image]

[arabic, start=4]
. Under Options, click *Webhooks*.

image:webhooks-github-repo-settings-options.png[image]

[arabic, start=5]
. On the Webhooks page, click *Add webhook*.
. To complete the Add Webhook page, you need to
`enable webhooks in a job template &lt;ug_jt_enable_webhooks&gt;` (or in a
`workflow job template &lt;ug_wfjt_enable_webhooks&gt;`), which will provide
you with the following information:
+
_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
--
[loweralpha]
.. Copy the contents of the *Webhook URL* from the job template, and
paste it in the *Payload URL* field. GitHub uses this address to send
results to.
.. Set the *Content type* to *application/json*.
.. Copy the contents of the *Webhook Key* from the job template above
and paste it in the *Secret* field.
.. Leave *Enable SSL verification* selected.

____________________________________________________________________________
image:webhooks-github-repo-add-webhook.png[image]
____________________________________________________________________________

[verse]
--

--

[loweralpha, start=5]
.. Next, you must select the types of events you want to trigger a
webhook. Any such event will trigger the Job or Workflow. In order to
have job status (pending, error, success) sent back to GitHub, you must
select *Pull requests* in the individual events section.

image:webhooks-github-repo-choose-events.png[image]

[loweralpha, start=6]
.. Leave *Active* checked and click *Add Webhook*.

__________________________________________________________________________________
image:webhooks-github-repo-add-webhook-actve.png[image]
__________________________________________________________________________________

--
_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
. After your webhook is configured, it displays in the list of webhooks
active for your repo, along with the ability to edit or delete it. Click
on a webhook, and it brings you to the Manage webhook screen. Scroll to
the very bottom of the screen to view all the delivery attempts made to
your webhook and whether they succeeded or failed.

image:webhooks-github-repo-webhooks-deliveries.png[image]

For more information, refer to the
https://developer.github.com/webhooks/[GitHub Webhooks developer
documentation].

=== GitLab webhook setup

Automation controller has the ability to run jobs based on a triggered
webhook event coming in. Job status information (pending, error,
success) can be sent back only for merge request events. If you
determine you do not want automation controller to post job statuses
back to the webhook service, skip steps 1-2, and go directly to
`step 3 &lt;ug_webhooks_setup_gitlab&gt;`.

[arabic]
. Optionally, generate a personal access token (PAT). This token gives
automation controller the ability to post statuses back when we run jobs
based on a webhook coming in.
+
__________________________________________________________________________________________________________________________________________________________
[loweralpha]
.. In the profile settings of your GitLab account, click *Settings*.
.. On the sidebar, under User Settings, click *Access Tokens*.
+
___________________________________________________________________________________
image:webhooks-create-webhook-gitlab-settings.png[image]
___________________________________________________________________________________
.. In the *Name* field, enter a brief description about what this PAT
will be used for.
.. Skip the *Expires at* field unless you want to set an expiration date
for your webhook.
.. In the Scopes fields, select the ones applicable to your integration.
For automation controller, API is the only selection necessary.

image:webhooks-create-webhook-gitlab-scope.png[image]

[loweralpha, start=6]
.. Click the *Create personal access token* button.
.. Once the token is generated, make sure you copy the PAT, as it will
be used in a later step. You will not be able to access this token again
in GitLab.
__________________________________________________________________________________________________________________________________________________________
. Use the PAT to optionally create a GitLab credential:
+
_________________________________________________________________________________________________________________________________________________
[loweralpha]
.. Go to your instance, and
`create a new credential for the GitLab PAT &lt;ug_credentials_gitlab&gt;`
using the above generated token.
.. Make note of the name of this credential, as it will be used in the
job template that posts back to GitHub.

image:webhooks-create-credential-gitlab-PAT-token.png[image]

[loweralpha, start=3]
.. Go to the job template with which you want to enable webhooks, and
select the webhook service and credential you created in the previous
step.

image:webhooks-job-template-gl-webhook-credential.png[image]

[verse]
--

--

[loweralpha, start=4]
.. Click *Save*. Now your job template is set up to be able to post back
to GitLab. An example of one may look like this:

image:webhooks-tower-to-gitlab-status.png[image]
_________________________________________________________________________________________________________________________________________________

[[ug_webhooks_setup_gitlab]]
[arabic, start=3]
. Go to a specific GitLab repo you want to configure webhooks and click
*Settings &gt; Integrations*.

image:webhooks-gitlab-repo-settings.png[image]

[arabic, start=4]
. To complete the Integrations page, you need to
`enable webhooks in a job template &lt;ug_jt_enable_webhooks&gt;` (or in a
`workflow job template &lt;ug_wfjt_enable_webhooks&gt;`), which will provide
you with the following information:
+
______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
[loweralpha]
.. Copy the contents of the *Webhook URL* from the job template above,
and paste it in the *URL* field. GitLab uses this address to send
results to.
.. Copy the contents of the *Webhook Key* from the job template above
and paste it in the *Secret Token* field.
.. Next, you must select the types of events you want to trigger a
webhook. Any such event will trigger the Job or Workflow. In order to
have job status (pending, error, success) sent back to GitLab, you must
select *Merge request events* in the Trigger section.
.. Leave *Enable SSL verification* selected.
.. Click *Add webhook*.
______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

image:webhooks-gitlab-repo-add-webhook.png[image]

[arabic, start=5]
. After your webhook is configured, it displays in the list of Project
Webhooks for your repo, along with the ability to test events, edit or
delete the webhook. Testing a webhook event displays the results at the
top of the page whether it succeeded or failed.

For more information, refer to the
https://docs.gitlab.com/ee/user/project/integrations/webhooks.html[GitLab
webhooks integrations documentation].

=== Payload output

The entire payload is exposed as an extra variable. To view the payload
information, go to the Jobs Detail view of the job template that ran
with the webhook enabled. In the *Extra Variables* field of the Details
pane, view the payload output from the `awx_webhook_payload` variable,
as shown in the example below.

image:webhooks-jobs-extra-vars-payload.png[image]

image:webhooks-jobs-extra-vars-payload-expanded.png[image]

:leveloffset: 0
:leveloffset: 0

[[ug_notifications]]
== Notifications

A `Notification Template` is an instance of a `Notification` type
(Email, Slack, Webhook, etc.) with a name, description, and a defined
configuration.

For example:

* A username, password, server, and recipients are needed for an Email
notification template
* The token and a list of channels are needed for a Slack notification
template
* The URL and Headers are needed for a Webhook notification template

A Notification is a manifestation of the notification template; for
example, when a job fails, a notification is sent using the
configuration defined by the notification template.

At a high level, the typical flow for the notification system works as
follows:

* A user creates a notification template to the REST API at the
`/api/v2/notification_templates` endpoint (either through the API or
through the UI).
* A user assigns the notification template to any of the various objects
that support it (all variants of job templates as well as organizations
and projects) and at the appropriate trigger level for which they want
the notification (started, success, or error). For example a user may
wish to assign a particular notification template to trigger when Job
Template 1 fails. In which case, they will associate the notification
template with the job template at
`/api/v2/job_templates/n/notification_templates_error` API endpoint.
* You can set notifications on job start, not just job end. Users and
teams are also able to define their own notifications that can be
attached to arbitrary jobs.

=== Notification Hierarchy

Notification templates assigned at certain levels will inherit templates
defined on parent objects as such:

* Job Templates will use notification templates defined on it as well as
inheriting notification templates from the Project used by the Job
Template and from the Organization that it is listed under (via the
Project).
* Project Updates will use notification templates defined on the project
and will inherit notification templates from the Organization associated
with it
* Inventory Updates will use notification templates defined on the
Organization that it is listed under
* Ad-hoc commands will use notification templates defined on the
Organization that the inventory is associated with

=== Workflow

When a job succeeds or fails, the error or success handler will pull a
list of relevant notification templates using the procedure defined
above. It will then create a Notification object for each one containing
relevant details about the job and then sends it to the destination
(email addresses, slack channel(s), sms numbers, etc). These
Notification objects are available as related resources on job types
(jobs, inventory updates, project updates), and also at
`/api/v2/notifications`. You may also see what notifications have been
sent from a notification templates by examining its related resources.

If a notification fails, it will not impact the job associated to it or
cause it to fail. The status of the notification can be viewed at its
detail endpoint (`/api/v2/notifications/&lt;n&gt;`).

[[ug_notifications_create]]
=== Create a Notification Template

To create a Notification Template:

[arabic]
. Click *Notifications* from the left navigation bar.
. Click the *Add* button.

image:notifications-template-add-new.png[image]

[arabic, start=3]
. Enter the name of the notification and a description in their
respective fields, and specify the organization (required) it belongs
to.
. Choose a type of notification from the *Type* drop-down menu. Refer to
the subsequent sections for additional information.
. Once all required information is complete, click *Save* to add the
notification.

[[ug_notifications_types]]
=== Notification Types

triple: notifications; types; Email triple: notifications; types;
Grafana triple: notifications; types; IRC triple: notifications; types;
Mattermost triple: notifications; types; pagerduty triple:
notifications; types; Rocket.Chat triple: notifications; types; Slack
triple: notifications; types; Twilio triple: notifications; types;
Webhook

Notification types supported with automation controller:

Each of these have their own configuration and behavioral semantics and
testing them may need to be approached in different ways. Additionally,
you can customize each type of notification down to a specific detail,
or a set of criteria to trigger a notification. See
xref:ug_custom_notifications[] for more detail on configuring custom
notifications. The following sections will give as much detail as
possible on each type of notification.

==== Email

The email notification type supports a wide variety of SMTP servers and
has support for TLS/SSL connections.

You must provide the following details to setup an email notification:

* Host
* Recipient list
* Sender email
* Port
* Timeout (in seconds): allows you to specify up to 120 seconds, the
length of time automation controller may attempt connecting to the email
server before giving up.

image:notification-template-email.png[image]

==== Grafana

Grafana is a fairly straightforward integration. First, create an API
Key in the
http://docs.grafana.org/tutorials/api_org_token_howto/[Grafana system]
(this is the token that is given to automation controller).

You must provide the following details to setup a Grafana notification:

* Grafana URL: The URL of the Grafana API service, generally
`http://yourcompany.grafana.com`.
* Grafana API Key: The user must first create an API Key in the Grafana
system (this is the token that is given to automation controller).

The other options of note are:

* ID of the Dashboard: When you created an API Key for the Grafana
account, you can set up a dashboard with its own unique ID.
* ID of the Panel: If you added panels and graphs to your Grafana
interface, you can specify its ID here.
* Tags for the Annotation: Enter keywords that help identify the type(s)
of events(s) of the notification you are configuring.
* Disable SSL Verification: SSL verification is on by default, but you
can choose to turn off verification the authenticity of the target's
certificate. Environments that use internal or private CA's should
select this option to disable verification.

image:notification-template-grafana.png[image]

==== IRC

The IRC notification takes the form of an IRC bot that will connect,
deliver its messages to channel(s) or individual user(s), and then
disconnect. The notification bot also supports SSL authentication. The
bot does not currently support Nickserv identification. If a channel or
user does not exist or is not on-line then the Notification will not
fail; the failure scenario is reserved specifically for connectivity.

Connectivity information is straightforward:

* IRC Server Password (optional): IRC servers can require a password to
connect. If the server does not require one, leave blank
* IRC Server Port: The IRC server Port
* IRC Server Address: The host name or address of the IRC server
* IRC Nick: The bot's nickname once it connects to the server
* Destination Channels or Users: A list of users and/or channels to
which to send the notification.
* SSL Connection (optional): Should the bot use SSL when connecting

image:notification-template-irc.png[image]

==== Mattermost

The Mattermost notification type provides a simple interface to
Mattermost's messaging and collaboration workspace. The parameters that
can be specified are:

* Target URL (required): The full URL that will be POSTed to
* Username
* Channel
* Icon URL: specifies the icon to display for this notification
* Disable SSL Verification: Turns off verification of the authenticity
of the target's certificate. Environments that use internal or private
CA's should select this option to disable verification.

image:notification-template-mattermost.png[image]

==== PagerDuty

PagerDuty is a fairly straightforward integration. First, create an API
Key in the
https://support.pagerduty.com/docs/generating-api-keys[PagerDuty system]
(this is the token that is given to automation controller) and then
create a "Service" which provides an "Integration Key" that will also be
given to automation controller. The other required options are:

* API Token: The user must first create an API Key in the PagerDuty
system (this is the token that is given to automation controller).
* PagerDuty Subdomain: When you sign up for the PagerDuty account, you
receive a unique subdomain to communicate with. For instance, if you
signed up as "testuser", the web dashboard will be at
`testuser.pagerduty.com` and you will give the API `testuser` as the
subdomain (not the full domain).
* API Service/Integration Key
* Client Identifier: This will be sent along with the alert content to
the pagerduty service to help identify the service that is using the api
key/service. This is helpful if multiple integrations are using the same
API key and service.

image:notification-template-pagerduty.png[image]

==== Rocket.Chat

The Rocket.Chat notification type provides an interface to Rocket.Chat's
collaboration and communication platform. The parameters that can be
specified are:

* Target URL (required): The full URL that will be POSTed to
* Username
* Icon URL: specifies the icon to display for this notification
* Disable SSL Verification: Turns off verification of the authenticity
of the target's certificate. Environments that use internal or private
CA's should select this option to disable verification.

image:notification-template-rocketchat.png[image]

==== Slack

Slack, a collaborative team communication and messaging tool, is pretty
easy to configure.

You must supply the following to setup Slack notifications:

* A Slack app (refer to the
https://api.slack.com/authentication/basics[Basic App Setup] page of the
Slack documentation for information on how to create one)
* A token (refer to https://api.slack.com/bot-users[Enabling
Interactions with Bots] and specific details on bot tokens on the
https://api.slack.com/authentication/token-types#bot[Token Types]
documentation page)

Once you have a bot/app set up, you must navigate to "Your Apps", click
on the newly-created app and then go to *Add features and
functionality*, which allows you to configure incoming webhooks, bots,
and permissions; as well as *Install your app to your workspace*.

You must also invite the notification bot to join the channel(s) in
question in Slack. Note that private messages are not supported.

image:notification-template-slack.png[image]

==== Twilio

Twilio service is an Voice and SMS automation service. Once you are
signed in, you must create a phone number from which the message will be
sent. You can then define a "Messaging Service" under Programmable SMS
and associate the number you created before with it.

Note that you may need to verify this number or some other information
before you are allowed to use it to send to any numbers. The Messaging
Service does not need a status callback URL nor does it need the ability
to Process inbound messages.

Under your individual (or sub) account settings, you will have API
credentials. Twilio uses two credentials to determine which account an
API request is coming from. The âAccount SIDâ, which acts as a username,
and the âAuth Tokenâ which acts as a password.

To setup Twilio, provide the following details:

* Account Token
* Source Phone Number (this is the number associated with the messaging
service above and must be given in the form of "+15556667777")
* Destination SMS number (this will be the list of numbers to receive
the SMS and should be the 10-digit phone number)
* Account SID

image:notification-template-twilio.png[image]

==== Webhook

The webhook notification type provides a simple interface to sending
POSTs to a predefined web service. automation controller will POST to
this address using application/json content type with the data payload
containing all relevant details in json format. Some web service APIs
expect HTTP requests to be in a certain format with certain fields. You
can configure more of the webhook notification in the following ways:

* configure the HTTP method (using *POST* or *PUT*)
* body of the outgoing request
* configure authentication (using basic auth)

The parameters for configuring webhooks are:

* Username
* Basic Auth Password
* Target URL (required): The full URL to which the webhook notification
will be PUT or POSTed.
* Disable SSL Verification: SSL verification is on by default, but you
can choose to turn off verification of the authenticity of the targetâs
certificate. Environments that use internal or private CAâs should
select this option to disable verification.
* HTTP Headers (required): Headers in JSON form where the keys and
values are strings. For example,
`{"Authentication": "988881adc9fc3655077dc2d4d757d480b5ea0e11", "MessageType": "Test"}`
* HTTP Method (required). Select the method for your webhook:
** POST: Creates a new resource. Also acts as a catch-all for operations
that do not fit into the other categories. It is likely you need to POST
unless you know your webhook service expects a PUT.
** PUT: Updates a specific resource (by an identifier) or a collection
of resources. PUT can also be used to create a specific resource if the
resource identifier is known beforehand.

image:notification-template-webhook.png[image]

===== Webhook payloads

Automation controller sends by default the following data at the webhook
endpoint:

....
job id
name
url
created_by
started
finished
status
traceback
inventory
project
playbook
credential
limit
extra_vars
hosts
http method
....

An example of a `started` notifications via webhook message as it is
returned by automation controller:

....
{"id": 38, "name": "Demo Job Template", "url": "https://host/#/jobs/playbook/38", "created_by": "bianca", "started":
"2020-07-28T19:57:07.888193+00:00", "finished": null, "status": "running", "traceback": "", "inventory": "Demo Inventory",
"project": "Demo Project", "playbook": "hello_world.yml", "credential": "Demo Credential", "limit": "", "extra_vars": "{}",
"hosts": {}}POST / HTTP/1.1
....

Automation controller returns by default the following data at the
webhook endpoint for a `success`/`fail` status:

....
job id
name
url
created_by
started
finished
status
traceback
inventory
project
playbook
credential
limit
extra_vars
hosts
....

An example of a `success`/`fail` notifications via webhook message as it
is returned by automation controller:

....
{"id": 46, "name": "AWX-Collection-tests-awx_job_wait-long_running-XVFBGRSAvUUIrYKn", "url": "https://host/#/jobs/playbook/46",
"created_by": "bianca", "started": "2020-07-28T20:43:36.966686+00:00", "finished": "2020-07-28T20:43:44.936072+00:00", "status": "failed",
"traceback": "", "inventory": "Demo Inventory", "project": "AWX-Collection-tests-awx_job_wait-long_running-JJSlglnwtsRJyQmw", "playbook":
"fail.yml", "credential": null, "limit": "", "extra_vars": "{\"sleep_interval\": 300}", "hosts": {"localhost": {"failed": true, "changed": 0,
"dark": 0, "failures": 1, "ok": 1, "processed": 1, "skipped": 0, "rescued": 0, "ignored": 0}}}
....

[[ug_custom_notifications]]
=== Create custom notifications

You can `customize the text content &lt;ir_notifications_reference&gt;` of
each of the xref:ug_notifications_types[] by enabling the *Customize
Messages* portion at the bottom of the notifications form using the
toggle button.

image:notification-template-customize.png[image]

You can provide a custom message for various job events:

* Start
* Success
* Error
* Workflow approved
* Workflow denied
* Workflow running
* Workflow timed out

The message forms vary depending on the type of notification you are
configuring. For example, messages for email and PagerDuty notifications
have the appearance of a typical email form with a subject and body, in
which case, automation controller displays the fields as *Message* and
*Message Body*. Other notification types only expect a *Message* for
each type of event:

image:notification-template-customize-simple.png[image]

The *Message* fields are pre-populated with a template containing a
top-level variable, `job` coupled with an attribute, such as `id` or
`name`, for example. Templates are enclosed in curly braces and may draw
from a fixed set of fields provided by automation controller, as shown
in the pre-populated *Messages* fields.

image:notification-template-customize-simple-syntax.png[image]

This pre-populated field suggests commonly displayed messages to a
recipient who is notified of an event. You can, however, customize these
messages with different criteria by adding your own attribute(s) for the
job as needed. Custom notification messages are rendered using Jinja -
the same templating engine used by Ansible playbooks.

Messages and message bodies have different types of content:

* messages will always just be strings (one-liners only; new lines are
not allowed)
* message bodies will be either a dictionary or block of text:
+
__________________________________________________________________________________________________________________________________________________________________________________________________________
** the message body for _Webhooks_ and _PagerDuty_ uses dictionary
definitions. The default message body for these is `{{ job_metadata }}`,
you can either leave that as is or provide your own dictionary
** the message body for email uses a block of text or a multi-line
string. The default message body is:

[source,sourceCode,html]
----
{{ job_friendly_name }} #{{ job.id }} had status {{ job.status }}, view details at {{ url }} {{ job_metadata }}
----

You can tweak this text (leaving `{{ job_metadata }}` in, or drop
`{{ job_metadata }}` altogether). Since the body is a block of text, it
can really be any string you want.

`{{ job_metadata }}` gets rendered as a dictionary containing fields
that describe the job being executed. In all cases, `{{ job_metadata }}`
will include the following fields:

** `id`
** `name`
** `url`
** `created_by`
** `started`
** `finished`
** `status`
** `traceback`

Note

At the present time, you cannot query individual fields within
`{{ job_metadata }}`. When using `{{ job_metadata }}` in a notification
template, all data will be returned.

The resulting dictionary will look something like this:

....
{"id": 18,
 "name": "Project - Space Procedures",
 "url": "https://host/#/jobs/project/18",
 "created_by": "admin",
 "started": "2019-10-26T00:20:45.139356+00:00",
 "finished": "2019-10-26T00:20:55.769713+00:00",
 "status": "successful",
 "traceback": ""
}
....

If `{{ job_metadata }}` is rendered in a job, it will include the
following additional fields:

** `inventory`
** `project`
** `playbook`
** `credential`
** `limit`
** `extra_vars`
** `hosts`

[verse]
--

--

The resulting dictionary will look something like:

....
{"id": 12,
 "name": "JobTemplate - Launch Rockets",
 "url": "https://host/#/jobs/playbook/12",
 "created_by": "admin",
 "started": "2019-10-26T00:02:07.943774+00:00",
 "finished": null,
 "status": "running",
 "traceback": "",
 "inventory": "Inventory - Fleet",
 "project": "Project - Space Procedures",
 "playbook": "launch.yml",
 "credential": "Credential - Mission Control",
 "limit": "",
 "extra_vars": "{}",
 "hosts": {}
}
....

If `{{ job_metadata }}` is rendered in a workflow job, it will include
the following additional field:

** `body` (this will enumerate all the nodes in the workflow job and
includes a description of the job associated with each node)

[verse]
--

--

The resulting dictionary will look something like this:

....
{"id": 14,
 "name": "Workflow Job Template - Launch Mars Mission",
 "url": "https://host/#/workflows/14",
 "created_by": "admin",
 "started": "2019-10-26T00:11:04.554468+00:00",
 "finished": "2019-10-26T00:11:24.249899+00:00",
 "status": "successful",
 "traceback": "",
 "body": "Workflow job summary:

         node #1 spawns job #15, \"Assemble Fleet JT\", which finished with status successful.
         node #2 spawns job #16, \"Mission Start approval node\", which finished with status successful.\n
         node #3 spawns job #17, \"Deploy Fleet\", which finished with status successful."
}
....
__________________________________________________________________________________________________________________________________________________________________________________________________________

For more detail, refer to
https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html#using-variables-with-jinja2[Using
variables with Jinja2].

Automation controller requires valid syntax in order to retrieve the
correct data to display the messages. For a list of supported attributes
and the proper syntax construction, refer to the
`ir_notifications_reference` section of this guide.

If you create a notification template that uses invalid syntax or
references unusable fields, an error message displays indicating the
nature of the error. If you delete a notificationâs custom message, the
default message is shown in its place.

Note

If you save the notifications template without editing the custom
message (or edit and revert back to the default values), the *Details*
screen assumes the defaults and will not display the custom message
tables. If you edit and save any of the values, the entire table
displays in the *Details* screen.

image:notifications-with-without-messages.png[image]

[[ug_notifications_on_off]]
=== Enable and Disable Notifications

You can select which notifications to notify you when a specific job
starts, in addition to notifying you on success or failure at the end of
the job run. Some behaviors to keep in mind:

* if a workflow template (WFJT) has notification on start enabled, and a
job template (JT) within that workflow also has notification on start
enabled, you will receive notifications for both
* you can enable notifications to run on many JTs within a WFJT
* you can enable notifications to run on a sliced job template (SJT)
start and each slice will generate a notification
* when you enable a notification to run on job start, and that
notification gets deleted, the JT continues to run, but will result in
an error message

You can enable notifications on job start, job success, and job failure,
or any combination thereof, from the *Notifications* tab of the
following resources:

* Job Template
* Workflow Template
* Projects (shown in the example below)
* Inventory Source
* Organizations

image:projects-notifications-example-list.png[image]

For workflow templates that have approval nodes, in addition to _Start_,
_Success_, and _Failure_, you can enable or disable certain
approval-related events:

image:wf-template-completed-notifications-view.png[image]

Refer to xref:ug_wf_approval_nodes[] for additional detail on working with
these types of nodes.

=== Configure the `host` hostname for notifications

In the `System Settings &lt;configure_tower_system&gt;`, you can replace the
default value in the *Base URL of the service* field with your preferred
hostname to change the notification hostname.

image:configure-tower-system-misc-baseurl.png[image]

Refreshing your license also changes the notification hostname. New
installations of automation controller should not have to set the
hostname for notifications.

==== Reset the `TOWER_URL_BASE`

The primary way that automation controller determines how the base URL
(`TOWER_URL_BASE`) is defined is by looking at an incoming request and
setting the server address based on that incoming request.

Automation controller takes settings values from the database first. If
no settings values are found, it falls back to using the values from the
settings files. If a user posts a license by navigating to the
automation controller host's IP adddress, the posted license is written
to the settings entry in the database.

To change the `TOWER_URL_BASE` if the wrong address has been picked up,
navigate to *Miscellaneous System settings* from the Settings menu using
the DNS entry you wish to appear in notifications, and re-add your
license.

=== Notifications API

Use the `started`, `success`, or `error` endpoints:

....
/api/v2/organizations/N/notification_templates_started/
/api/v2/organizations/N/notification_templates_success/
/api/v2/organizations/N/notification_templates_error/
....

Additionally, the `../../../N/notification_templates_started` endpoints
have *GET* and *POST* actions for:

* Organizations
* Projects
* Inventory Sources
* Job Templates
* System Job Templates
* Workflow Job Templates

:leveloffset: 0
:leveloffset: 0

[[ir_notifications_reference]]
== Supported Attributes for Custom Notifications

This section describes the list of supported job attributes and the
proper syntax for constructing the message text for notifications. The
supported job attributes are:

* `allow_simultaneous` - (boolean) indicates if multiple jobs can run
simultaneously from the JT associated with this job
* `controller_node` - (string) the instance that managed the isolated
execution environment
* `created` - (datetime) timestamp when this job was created
* `custom_virtualenv` - (string) custom virtual environment used to
execute job
* `description` - (string) optional description of the job
* `diff_mode` - (boolean) if enabled, textual changes made to any
templated files on the host are shown in the standard output
* `elapsed` - (decimal) elapsed time in seconds that the job ran
* `execution_node` - (string) node the job executed on
* `failed` - (boolean) true if job failed
* `finished` - (datetime) date and time the job finished execution
* `force_handlers` - (boolean) when handlers are forced, they will run
when notified even if a task fails on that host (note that some
conditions - e.g. unreachable hosts - can still prevent handlers from
running)
* `forks` - (int) number of forks requested for job
* `id` - (int) database id for this job
* `job_explanation` - (string) status field to indicate the state of the
job if it wasn't able to run and capture stdout
* `job_slice_count` - (integer) if run as part of a sliced job, the
total number of slices (if 1, job is not part of a sliced job)
* `job_slice_number` - (integer) if run as part of a sliced job, the ID
of the inventory slice operated on (if not part of a sliced job,
attribute is not used)
* `job_tags` - (string) only tasks with specified tags will execute
* `job_type` - (choice) run, check, or scan
* `launch_type` - (choice) manual, relaunch, callback, scheduled,
dependency, workflow, sync, or scm
* `limit` - (string) playbook execution limited to this set of hosts, if
specified
* `modified` - (datetime) timestamp when this job was last modified
* `name` - (string) name of this job
* `playbook` - (string) playbook executed
* `scm_revision` - (string) scm revision from the project used for this
job, if available
* `skip_tags` - (string) playbook execution skips over this set of
tag(s), if specified
* `start_at_task` - (string) playbook execution begins at the task
matching this name, if specified
* `started` - (datetime) date and time the job was queued for starting
* `status` - (choice) new, pending, waiting, running, successful,
failed, error, canceled
* `timeout` - (int) amount of time (in seconds) to run before the task
is canceled
* `type` - (choice) data type for this job
* `url` - (string) URL for this job
* `use_fact_cache` - (boolean) if enabled for job, the controller acts
as an Ansible Fact Cache Plugin, persisting facts at the end of a
playbook run to the database and caching facts for use by Ansible
* `verbosity` - (choice) 0 through 5 (corresponding to Normal through
WinRM Debug)
* `host_status_counts` (count of hosts uniquely assigned to each
status)::
  ** `skipped` (integer)
  ** `ok` (integer)
  ** `changed` (integer)
  ** `failures` (integer)
  ** `dark` (integer)
  ** `processed` (integer)
  ** `rescued` (integer)
  ** `ignored` (integer)
  ** `failed` (boolean)
* `summary_fields`:::
  ** `inventory`;;
    *** `id` - (integer) database ID for inventory
    *** `name` - (string) name of the inventory
    *** `description` - (string) optional description of the inventory
    *** `has_active_failures` - (boolean) (deprecated) flag indicating
    whether any hosts in this inventory have failed
    *** `total_hosts` - (deprecated) (int) total number of hosts in this
    inventory.
    *** `hosts_with_active_failures` - (deprecated) (int) number of
    hosts in this inventory with active failures
    *** `total_groups` - (deprecated) (int) total number of groups in
    this inventory
    *** `groups_with_active_failures` - (deprecated) (int) number of
    hosts in this inventory with active failures
    *** `has_inventory_sources` - (deprecated) (boolean) flag indicating
    whether this inventory has external inventory sources
    *** `total_inventory_sources` - (int) total number of external
    inventory sources configured within this inventory
    *** `inventory_sources_with_failures` - (int) number of external
    inventory sources in this inventory with failures
    *** `organization_id` - (id) organization containing this inventory
    *** `kind` - (choice) (empty string) (indicating hosts have direct
    link with inventory) or 'smart'
  ** `project`;;
    *** `id` - (int) database ID for project
    *** `name` - (string) name of the project
    *** `description` - (string) optional description of the project
    *** `status` - (choices) one of new, pending, waiting, running,
    successful, failed, error, canceled, never updated, ok, or missing
    *** `scm_type (choice)` - one of (empty string), git, hg, svn,
    insights
  ** `job_template`;;
    *** `id` - (int) database ID for job template
    *** `name` - (string) name of job template
    *** `description` - (string) optional description for the job
    template
  ** `unified_job_template`;;
    *** `id` - (int) database ID for unified job template
    *** `name` - (string) name of unified job template
    *** `description` - (string) optional description for the unified
    job template
    *** `unified_job_type` - (choice) unified job type (job,
    workflow_job, project_update, etc.)
  ** `instance_group`;;
    *** `id` - (int) database ID for instance group
    *** `name` - (string) name of instance group
  ** `created_by`;;
    *** `id` - (int) database ID of user that launched the operation
    *** `username` - (string) username that launched the operation
    *** `first_name` - (string) first name
    *** `last_name` - (string) last name
  ** `labels`;;
    *** `count` - (int) number of labels
    *** `results` - list of dictionaries representing labels (e.g.
    \{"id": 5, "name": "database jobs"})

Information about a job can be referenced in a custom notification
message using grouped curly braces `{{ }}`. Specific job attributes are
accessed using dotted notation, for example
`{{ job.summary_fields.inventory.name }}`. Any characters used in front
or around the braces, or plain text, can be added for clarification,
such as '#' for job ID and single-quotes to denote some descriptor.
Custom messages can include a number of variables throughout the
message:

....
{{ job_friendly_name }} {{ job.id }} ran on {{ job.execution_node }} in {{ job.elapsed }} seconds.
....

In addition to the job attributes, there are some other variables that
can be added to the template:

* `approval_node_name` - (string) the approval node name
* `approval_status` - (choice) one of approved, denied, and timed_out
* `url` - (string) URL of the job for which the notification is emitted
(this applies to start, success, fail, and approval notifications)
* `workflow_url` - (string) URL to the relevant approval node. This
allows the notification recipient to go to the relevant workflow job
page to see what's going on (i.e.,
`This node can be viewed at: {{ workflow_url }}`). In cases of
approval-related notifications, both `url` and `workflow_url` are the
same.
* `job_friendly_name` - (string) the friendly name of the job
* `job_metadata` - (string) job metadata as a JSON string, for example:
+
....
{'url': 'https://towerhost/$/jobs/playbook/13',
 'traceback': '',
 'status': 'running',
 'started': '2019-08-07T21:46:38.362630+00:00',
 'project': 'Stub project',
 'playbook': 'ping.yml',
 'name': 'Stub Job Template',
 'limit': '',
 'inventory': 'Stub Inventory',
 'id': 42,
 'hosts': {},
 'friendly_name': 'Job',
 'finished': False,
 'credential': 'Stub credential',
 'created_by': 'admin'}
....

:leveloffset: 0
:leveloffset: 0

== Schedules

You can access all your configured schedules by clicking *Schedules*
from the left navigation bar. The schedules list may be sorted by any of
the attributes from each column using the directional arrows. You can
also search by name, date, or the name of the month in which a schedule
runs.

Each schedule has a corresponding *Actions* column that has options to
enable/disable that schedule using the *ON/OFF* toggle next to the
schedule name and to allow editing
(image:edit-button.png[edit]) of that
schedule.

image:schedules-sample-list.png[image]

If you are setting up a template, a project, or an inventory source,
clicking on the *Schedules* tab allows you to configure schedules for
these resources. Once schedules are created, they are listed by:

* *Name*: Clicking the schedule name opens its details
* *Type*: Identifies whether the schedule is associated with a source
control update or a system-managed job schedule
* *Next Run*: The next scheduled run of this task

image:generic-schedules-example-list.png[image]

=== Add a new schedule

Schedules can only be created from a template, project, or inventory
source, and not directly on the main *Schedules* screen itself. To
create a new schedule:

[arabic]
. Click the *Schedules* tab of the resource you are configuring
(template, project, or inventory source).
. Click the *Add* button, which opens the *Create Schedule* window.

image:generic-create-schedule.png[image]

[arabic, start=3]
. Enter the appropriate details into the following fields:

* *Name* (required)
* *Start Date* (required)
* *Start Time* (required)
* *Local Time Zone* - The entered Start Time should be in this timezone
* *Repeat Frequency* - Appropriate scheduling options display depending
on the frequency you select

The *Schedule Details* displays when you established a schedule,
allowing you to review the schedule settings and a list of the scheduled
occurrences in the selected Local Time Zone.

image:generic-create-schedule-details.png[image]

Caution

Jobs are scheduled in UTC. Repeating jobs that run at a specific time of
day may move relative to a local timezone when Daylight Savings Time
shifts occur. The system resolves the local time zone based time to UTC
when the schedule is saved. To ensure your schedules are correctly set,
you should set your schedules in UTC time.

[arabic, start=4]
. Once done, click *Save*.

You can use the *ON/OFF* toggle button to stop an active schedule or
activate a stopped schedule.

image:generic-schedules-list-configured.png[image]

:leveloffset: 0
:leveloffset: 0

[[insights]]
== Setting up Insights Remediations

Automation controller supports integration with Red Hat Insights. Once a
host is registered with Insights, it will be continually scanned for
vulnerabilities and known configuration conflicts. Each of the found
problems may have an associated fix in the form of an Ansible playbook.
Insights users create a maintenance plan to group the fixes and,
ultimately, create a playbook to mitigate the problems. Automation
controller tracks the maintenance plan playbooks via an Insights
project. Authentication to Insights via Basic Auth is backed by a
special Insights Credential, which must first be established in
automation controller. To ultimately run an Insights Maintenance Plan,
you need an Insights project, and an Insights inventory.

=== Create Insights Credential

To create a new credential for use with Insights:

[arabic]
. Click *Credentials* from the left navigation bar to access the
Credentials page.
. Click the *Add* button located in the upper right corner of the
Credentials screen.
. Enter the name of the credential to be used in the *Name* field.
. Optionally enter a description for this credential in the
*Description* field.
. In the *Organization* field, optionally enter the name of the
organization with which the credential is associated, or click the
image:search-button.png[search] button and
select it from the pop-up window.
. In the *Credential Type* field, enter *Insights* or select it from the
drop-down list.

image:credential-types-popup-window-insights.png[image]

[arabic, start=7]
. Enter a valid Insights credential in the *Username* and *Password*
fields. The Insights credential is the user's link:[Red Hat Customer
Portal] account username and password.
+

image:insights-create-with-demo-credentials.png[Credentials
- create with demo insights credentials]

[arabic, start=8]
. Click *Save* when done.

=== Create an Insights Project

To create a new Insights project:

[arabic]
. Click *Projects* from the left navigation bar to access the Projects
page.
. Click the *Add* button located in the upper right corner of the
Projects screen.
. Enter the appropriate details into the required fields, at minimum.
Note the following fields requiring specific Insights-related entries:

* *Name*: Enter the name for your Insights project.
* *Organization*: Enter the name of the organization associated with
this project, or click the
image:search-button.png[search] button and
select it from the pop-up window.
* *SCM Type*: Select *Red Hat Insights*.
* Upon selecting the SCM type, the *Source Details* field expands.

[arabic, start=4]
. The *Credential* field is pre-populated with the Insights credential
you previously created. If not, enter the credential, or click the
image:search-button.png[search] button and
select it from the pop-up window.
. Click to select the update option(s) for this project from the
*Options* field, and provide any additional values, if applicable. For
information about each option, click the tooltip
image:tooltips-icon.png[tooltip] next to the
options.

image:insights-create-project-insights-form.png[Insights
- create demo insights project form]

[arabic, start=6]
. Click *Save* when done.

All SCM/Project syncs occur automatically the first time you save a new
project. However, if you want them to be updated to what is current in
Insights, manually update the SCM-based project by clicking the
image:update-button.png[update] button under
the project's available Actions.

This process syncs your Insights project with your Insights account
solution. Notice that the status dot beside the name of the project
updates once the sync has run.

image:insights-create-project-insights-succeed.png[Insights
- demo insights project success]

=== Create Insights Inventory

The Insights playbook contains a [.title-ref]#hosts:# line where the
value is the hostname that Insights itself knows about, which may be
different than the hostname that Tower knows about. To use an Insights
playbook, you will need an Insights inventory.

To create a new inventory for use with Insights, see
xref:ug_source_insights[].

=== Remediate Insights Inventory

Remediation of an Insights inventory allows Tower to run Insights
playbooks with a single click. This is done by creating a Job Template
to run the Insights remediation.

[arabic]
. Click *Job Templates* from the left navigation bar to access the Job
Templates page.
. Create a new Job Template, with the appropriate details into the
required fields, at minimum. Note the following fields requiring
specific Insights-related entries:

* *Name*: Enter the name of your Maintenance Plan.
* *Job Type*: If not already populated, select *Run* from the drop-down
menu list.
* *Inventory*: Select the Insights Inventory you previously created.
* *Project*: Select the Insights project you previously created.
* *Playbook*: Select a playbook associated with the Maintenance Plan you
want to run from the drop-down menu list.
* *Credential*: Enter the credential to use for this project or click
the image:search-button.png[search] button
and select it from the pop-up window. The credential does not have to be
an Insights credential.
* *Verbosity*: Keep the default setting, or select the desired verbosity
from the drop-down menu list.

image:insights-create-new-job-template-maintenance-plan-filled.png[Insights
- maintenance plan template filled]

[arabic, start=3]
. Click *Save* when done.
. Click the image:launch-button.png[launch]
icon to launch the job template.

Once complete, the job results display in the Job Details page.

:leveloffset: 0
:leveloffset: 0

== Best Practices

=== Use Source Control

While automation controller supports playbooks stored directly on the
server, best practice is to store your playbooks, roles, and any
associated details in source control. This way you have an audit trail
describing when and why you changed the rules that are automating your
infrastructure. Plus, it allows for easy sharing of playbooks with other
parts of your infrastructure or team.

=== Ansible file and directory structure

Please review the
https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html[Ansible
Tips and Tricks] from the Ansible documentation. If creating a common
set of roles to use across projects, these should be accessed via source
control submodules, or a common location such as `/opt`. Projects should
not expect to import roles or content from other projects.

Note

Playbooks should not use the `vars_prompt` feature, as automation
controller does not interactively allow for `vars_prompt` questions. If
you must use `vars_prompt`, refer to and make use of the xref:ug_surveys[]
functionality.

Note

Playbooks should not use the `pause` feature of Ansible without a
timeout, as automation controller does not allow for interactively
cancelling a pause. If you must use `pause`, ensure that you set a
timeout.

Jobs run use the playbook directory as the current working directory,
although jobs should be coded to use the `playbook_dir` variable rather
than relying on this.

=== Use Dynamic Inventory Sources

If you have an external source of truth for your infrastructure, whether
it is a cloud provider or a local CMDB, it is best to define an
inventory sync process and use the support for dynamic inventory
(including cloud inventory sources). This ensures your inventory is
always up to date.

Note

Edits and additions to Inventory host variables persist beyond an
inventory sync as long as `--overwrite_vars` is *not* set.

=== Variable Management for Inventory

Keeping variable data along with the hosts and groups definitions (see
the inventory editor) is encouraged, rather than using `group_vars/` and
`host_vars/`. If you use dynamic inventory sources, the controller can
sync such variables with the database as long as the *Overwrite
Variables* option is not set.

=== Autoscaling

Using the "callback" feature to allow newly booting instances to request
configuration is very useful for auto-scaling scenarios or provisioning
integration.

=== Larger Host Counts

Consider setting "forks" on a job template to larger values to increase
parallelism of execution runs. For more information on tuning Ansible,
see http://www.ansible.com/blog/ansible-performance-tuning[the Ansible
blog].

=== Continuous integration / Continuous Deployment

For a Continuous Integration system, such as Jenkins, to spawn a job, it
should make a curl request to a job template. The credentials to the job
template should not require prompting for any particular passwords.
Refer to the link:[CLI documentation] for configuration and usage
instructions.

[[ug_ldap_auth_perf_tips]]
=== LDAP authentication performance tips

When an LDAP user authenticates, by default, all user-related attributes
will be updated in the database on each log in. In some environments,
this operation can be skipped due to performance issues. To avoid it,
you can disable the option [.title-ref]#AUTH_LDAP_ALWAYS_UPDATE_USER#.
Refer to the link:[Knowledge Base Article 5823061] for its configuration
and usage instructions. Please note that new users will still be created
and get their attributes pushed to the database on their f.adoc[] login.

Warning

With this option set to False, no changes to LDAP user's attributes will
be updated. Attributes will only be updated the f.adoc[] time the user is
created.

:leveloffset: 0
:leveloffset: 0

[[ug_security]]
== Security

The following sections will help you gain an understanding of how
automation controller handles and lets you control file system security.

All playbooks are executed via the `awx` file system user. For running
jobs, automation controller offers job isolation via the use of Linux
containers. This projection ensures jobs can only access playbooks,
roles, and data from the Project directory for that job template.

For credential security, users may choose to upload locked SSH keys and
set the unlock password to "ask". You can also choose to have the system
prompt them for SSH credentials or sudo passwords rather than having the
system store them in the database.

=== Playbook Access and Information Sharing

Automation controller's use of automation execution environments and
Linux containers prevents playbooks from reading files outside of their
project directory.

By default, the only data exposed to the ansible-playbook process inside
the container is the current project being used.

You can customize this in the Job Settings and expose additional
directories from the host into the container. Refer the next section,
xref:ug_isolation[] for more information.

[[ug_isolation]]
==== Isolation functionality and variables

Automation controller uses container technology to isolate jobs from
each other. By default, only the current project is exposed to the
container running a job template.

You may find that you need to customize your playbook runs to expose
additional directories. To fine tune your usage of job isolation, there
are certain variables that can be set.

By default, automation controller will use the system's `tmp` directory
(`/tmp` by default) as its staging area. This can be changed in the *Job
Execution Path* field of the Jobs settings screen, or in the REST API at
`/api/v2/settings/jobs`:

`AWX_ISOLATION_BASE_PATH = "/opt/tmp"`

If there are any additional directories that should specifically be
exposed from the host to the container that playbooks run in, you can
specify those in the *Paths to Expose to Isolated Jobs* field of the
Jobs setting scren, or in the REST API at `/api/v2/settings/jobs`:

`AWX_ISOLATION_SHOW_PATHS = ['/list/of/', '/paths']

________________________________________________________________________________________________________________________________________________________
Note

The primary file you may want to add to `AWX_ISOLATION_SHOW_PATHS` is
`/var/lib/awx/.ssh`, if your playbooks need to use keys or settings
defined there.
________________________________________________________________________________________________________________________________________________________

The above fields can be found in the Jobs Settings window:

image:configure-tower-jobs-isolated-jobs-fields.png[image]

[[rbac-ug]]
=== Role-Based Access Controls

Role-Based Access Controls (RBAC) are built into automation controller
and allow administrators to delegate access to server inventories,
organizations, and more. Administrators can also centralize the
management of various credentials, allowing end users to leverage a
needed secret without ever exposing that secret to the end user. RBAC
controls allow the controller to help you increase security and
streamline management.

RBACs are easiest to think of in terms of Roles which define precisely
who or what can see, change, or delete an "object" for which a specific
capability is being set. RBAC is the practice of granting roles to users
or teams.

There are a few main concepts that you should become familiar with
regarding automation controller's RBAC design--roles, resources, and
users. Users can be members of a role, which gives them certain access
to any resources associated with that role, or any resources associated
with "descendant" roles.

A role is essentially a collection of capabilities. Users are granted
access to these capabilities and the controller's resources through the
roles to which they are assigned or through roles inherited through the
role hierarchy.

Roles associate a group of capabilities with a group of users. All
capabilities are derived from membership within a role. Users receive
capabilities only through the roles to which they are assigned or
through roles they inherit through the role hierarchy. All members of a
role have all capabilities granted to that role. Within an organization,
roles are relatively stable, while users and capabilities are both
numerous and may change rapidly. Users can have many roles.

==== Role Hierarchy and Access Inheritance

Imagine that you have an organization named "SomeCompany" and want to
allow two people, "Josie" and "Carter", access to manage all the
settings associated with that organization. You should make both people
members of the organization's `admin_role`.

image:user-role-relationship.png[user-role-relationship]

Often, you will have many Roles in a system and you will want some roles
to include all of the capabilities of other roles. For example, you may
want a System Administrator to have access to everything that an
Organization Administrator has access to, who has everything that a
Project Administrator has access to, and so on.

This concept is referred to as the 'Role Hierarchy':

* Parent roles get all capabilities bestowed on any child roles
* Members of roles automatically get all capabilities for the role they
are a member of, as well as any child roles.

The Role Hierarchy is represented by allowing Roles to have "Parent
Roles". Any capability that a Role has is implicitly granted to any
parent roles (or parents of those parents, and so on).

image:rbac-role-hierarchy.png[rbac-role-hierarchy]

Often, you will have many Roles in a system and you will want some roles
to include all of the capabilities of other roles. For example, you may
want a System Administrator to have access to everything that an
Organization Administrator has access to, who has everything that a
Project Administrator has access to, and so on. We refer to this concept
as the 'Role Hierarchy' and it is represented by allowing Roles to have
"Parent Roles". Any capability that a Role has is implicitly granted to
any parent roles (or parents of those parents, and so on). Of course
Roles can have more than one parent, and capabilities are implicitly
granted to all parents.

image:rbac-heirarchy-morecomplex.png[rbac-heirarchy-morecomplex]

RBAC controls also give you the capability to explicitly permit User and
Teams of Users to run playbooks against certain sets of hosts. Users and
teams are restricted to just the sets of playbooks and hosts to which
they are granted capabilities. And, with automation controller, you can
create or import as many Users and Teams as you require--create users
and teams manually or import them from LDAP or Active Directory.

RBACs are easiest to think of in terms of who or what can see, change,
or delete an "object" for which a specific capability is being
determined.

==== Applying RBAC

The following sections cover how to apply automation controller's RBAC
system in your environment.

===== Editing Users

When editing a user, a automation controller system administrator may
specify the user as being either a _System Administrator_ (also referred
to as the Superuser) or a _System Auditor_.

* System administrators implicitly inherit all capabilities for all
objects (read/write/execute) within the automation controller
environment.
* System Auditors implicitly inherit the read-only capability for all
objects within the automation controller environment.

===== Editing Organizations

When editing an organization, system administrators may specify the
following roles:

* One or more users as organization administrators
* One or more users as organization auditors
* And one or more users (or teams) as organization members

Users/teams that are members of an organization can view their
organization administrator.

Users who are organization administrators implicitly inherit all
capabilities for all objects within that automation controller
organization.

Users who are organization auditors implicitly inherit the read-only
capability for all objects within that automation controller
organization.

===== Editing Projects in an Organization

When editing a project in an organization for which they are the
administrator, system administrators and organization administrators may
specify:

* One or more users/teams that are project administrators
* One or more users/teams that are project members
* And one or more users/teams that may update the project from SCM, from
among the users/teams that are members of that organization.

Users who are members of a project can view their project
administrators.

Project administrators implicitly inherit the capability to update the
project from SCM.

Administrators can also specify one or more users/teams (from those that
are members of that project) that can use that project in a job
template.

===== Creating Inventories and Credentials within an Organization

All access that is granted to use, read, or write credentials is now
handled through roles. You no longer set the âteamâ or âuserâ for a
credential. Instead, you use automation controller's RBAC system to
grant ownership, auditor, or usage roles.

System administrators and organization administrators may create
inventories and credentials within organizations under their
administrative capabilities.

Whether editing an inventory or a credential, System administrators and
organization administrators may specify one or more users/teams (from
those that are members of that organization) to be granted the usage
capability for that inventory or credential.

System administrators and organization administrators may specify one or
more users/teams (from those that are members of that organization) that
have the capabilities to update (dynamic or manually) an inventory.
Administrators can also execute ad hoc commands for an inventory.

===== Editing Job Templates

System administrators, organization administrators, and project
administrators, within a project under their administrative
capabilities, may create and modify new job templates for that project.

When editing a job template, administrators (automation controller,
organization, and project) can select among the inventory and
credentials in the organization for which they have usage capabilities
or they may leave those fields blank so that they will be selected at
runtime.

Additionally, they may specify one or more users/teams (from those that
are members of that project) that have execution capabilities for that
job template. The execution capability is valid regardless of any
explicit capabilities the user/team may have been granted against the
inventory or credential specified in the job template.

===== User View

A user can:

* See any organization or project for which they are a member
* Create their own credential objects which only belong to them
* See and execute any job template for which they have been granted
execution capabilities

If a job template a user has been granted execution capabilities on does
not specify an inventory or credential, the user will be prompted at
run-time to select among the inventory and credentials in the
organization they own or have been granted usage capabilities.

Users that are job template administrators can make changes to job
templates; however, to change to the inventory, project, playbook, or
credentials used in the job template, the user must also have the "Use"
role for the project and inventory currently being used or being set.

[[rbac-ug-roles]]
==== Roles

As stated earlier in this documentation, all access that is granted to
use, read, or write credentials is now handled through roles, and roles
are defined for a resource.

===== Built-in roles

The following table lists the RBAC system roles and a brief description
of the how that role is defined with regard to privileges in automation
controller.

[width="100%",cols="45%,55%",options="header",]
|=======================================================================
|System Role |What it can do
|System Administrator - System wide singleton |Manages all aspects of
the system

|System Auditor - System wide singleton |Views all aspects of the system

|Ad Hoc Role - Inventory |Runs ad hoc commands on an Inventory

|Admin Role - Organizations, Teams, Inventory, Projects, Job Templates
|Manages all aspects of a defined Organization, Team, Inventory,
Project, or Job Template

|Auditor Role - All |Views all aspects of a defined Organization,
Project, Inventory, or Job Template

|Execute Role - Job Templates |Runs assigned Job Template

|Member Role - Organization, Team |Manages all of the settings
associated with that Organization or Team

|Read Role - Organizations, Teams, Inventory, Projects, Job Templates
|Views all aspects of a defined Organization, Team, Inventory, Project,
or Job Template

|Update Role - Project |Updates the Project from the configured source
control management system

|Update Role - Inventory |Updates the Inventory using the cloud source
update system

|Owner Role - Credential |Owns and manages all aspects of this
Credential

|Use Role - Credential, Inventory, Project |Uses the Credential,
Inventory, or Project in a Job Template
|=======================================================================

A Singleton Role is a special role that grants system-wide permissions.
automation controller currently provides two built-in Singleton Roles
but the ability to create or customize a Singleton Role is not supported
at this time.

===== Common Team Roles - "Personas"

Automation controller support personnel typically works on ensuring that
the controller is available and manages it a way to balance
supportability and ease-of-use for users. Often, automation controller
support will assign âOrganization Owner/Adminâ to users in order to
allow them to create a new Organization and add members from their team
the respective access needed. This minimizes supporting individuals and
focuses more on maintaining uptime of the service and assisting users
who are using automation controller.

Below are some common roles managed by the automation controller
Organization:

[width="100%",cols="16%,16%,68%",]
|=======================================================================
a|
[verse]
--
System Role
(for Organizations)
--

a|
[verse]
--
Common User
Roles
--

a|
[verse]
--
Description
--

a|
[verse]
--
Owner
--

a|
[verse]
--
Team Lead -
Technical Lead
--

a|
[verse]
--
This user has the ability to control access for other users in their organization.
They can add/remove and grant users specific access to projects, inventories, and job templates.
This user also has the ability to create/remove/modify any aspect of an organizationâs projects,
templates, inventories, teams, and credentials.
--

a|
[verse]
--
Auditor
--

a|
[verse]
--
Security Engineer -
Project Manager
--

a|
[verse]
--
This account can view all aspects of the organization in read-only mode.
This may be good for a user who checks in and maintains compliance.
This might also be a good role for a service account who manages or
ships job data from automation controller to some other data collector.
--

a|
[verse]
--
Member -
Team
--

a|
[verse]
--
All other users
--

a|
[verse]
--
These users by default as an organization member do not receive any access to any aspect
of the organization. In order to grant them access the respective organization owner needs
to add them to their respective team and grant them Admin, Execute, Use, Update, Ad-hoc
permissions to each component of the organizationâs projects, inventories, and job templates.
--

a|
[verse]
--
Member -
Team âOwnerâ
--

a|
[verse]
--
Power users -
Lead Developer
--

a|
[verse]
--
Organization Owners can provide âadminâ through the team interface, over any component
of their organization including projects, inventories, and job templates. These users are able
to modify and utilize the respective component given access.
--

a|
[verse]
--
Member -
Team âExecuteâ
--

a|
[verse]
--
Developers -
Engineers
--

a|
[verse]
--
This will be the most common and allows the organization member the ability to execute
job templates and read permission to the specific components. This is permission applies to templates.
--

a|
[verse]
--
Member -
Team âUseâ
--

a|
[verse]
--
Developers -
Engineers
--

a|
[verse]
--
This permission applies to an organizationâs credentials, inventories, and projects.
This permission allows the ability for a user to the respective component within their job template.
--

a|
[verse]
--
Member -
Team âUpdateâ
--

a|
[verse]
--
Developers -
Engineers
--

a|
[verse]
--
This permission applies to projects. Allows the user to be able to run an SCM update on a project.
--

|=======================================================================

=== Function of roles: editing and creating

A new organization âresource rolesâ functionality was introduced in
automation controller 3.3 that are specific to a certain resource type -
such as workflows. Being a member of such a role usually provides two
types of permissions, in the case of workflows, where a user is given a
"workflow admin role" for the organization "Default":

* this user can create new workflows in the organization "Default"
* user can edit all workflows in the "Default" organization

One exception is job templates, where having the role is irrelevant of
creation permission (more details on its own section).

==== Independence of resource roles and organization membership roles

Resource-specific organization roles are independent of the organization
roles of admin and member. Having the "workflow admin role" for the
"Default" organization will not allow a user to view all users in the
organization, but having a "member" role in the "Default" organization
will. The two types of roles are delegated independently of each other.

===== Necessary permissions to edit job templates

Users can edit fields not impacting job runs (non-sensitive fields) with
a Job Template admin role alone. However, to edit fields that impact job
runs in a job template, a user needs the following:

* *admin* role to the job template
* *use* role to related project
* *use* role to related inventory

An "organization job template admin" role was introduced, but having
this role isn't sufficient by itself to edit a job template within the
organization if the user does not have use role to the project /
inventory a job template uses.

In order to delegate _full_ job template control (within an
organization) to a user or team, you will need grant the team or user
all 3 organization-level roles:

* job template admin
* project admin
* inventory admin

This will ensure that the user (or all users who are members of the team
with these roles) have full access to modify job templates in the
organization. If a job template uses an inventory or project from
another organization, the user with these organization roles may still
not have permission to modify that job template. For clarity of managing
permissions, it is best-practice to not mix projects / inventories from
different organizations.

===== RBAC permissions

Each role should have a content object, for instance, the org admin role
has a content object of the org. To delegate a role, you need admin
permission to the content object, with some exceptions that would result
in you being able to reset a user's password.

*Parent* is the organization.

*Allow* is what this new permission will explicitly allow.

*Scope* is the parent resource that this new role will be created on.
Example: `Organization.project_create_role`.

An assumption is being made that the creator of the resource should be
given the admin role for that resource. If there are any instances where
resource creation does not also imply resource administration, they will
be explicitly called out.

Here are the rules associated with each admin type:

*Project Admin*

* Allow: Create, read, update, delete any project
* Scope: Organization
* User Interface: _Project Add Screen - Organizations_

*Inventory Admin*

* Parent: Org admin
* Allow: Create, read, update, delete any inventory
* Scope: Organization
* User Interface: _Inventory Add Screen - Organizations_

Note

As it is with the *Use* role, if you give a user Project Admin and
Inventory Admin, it allows them to create Job Templates (not workflows)
for your organization.

*Credential Admin*

* Parent: Org admin
* Allow: Create, read, update, delete shared credentials
* Scope: Organization
* User Interface: _Credential Add Screen - Organizations_

*Notification Admin*

* Parent: Org admin
* Allow: Assignment of notifications
* Scope: Organization

*Workflow Admin*

* Parent: Org admin
* Allow: Create a workflow
* Scope: Organization

*Org Execute*

* Parent: Org admin
* Allow: Executing JTs and WFJTs
* Scope: Organization

The following is a sample scenario showing an organization with its
roles and which resource(s) each have access to:

image:rbac-multiple-resources-scenario.png[image]

:leveloffset: 0</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-10-24 21:42:19 UTC
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>